{"version":3,"file":"demo.js","mappings":"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","sources":["webpack:///video-ad-sdk/webpack/universalModuleDefinition","webpack:///video-ad-sdk/./node_modules/lodash.debounce/index.js","webpack:///video-ad-sdk/./node_modules/sane-domparser-error/index.js","webpack:///video-ad-sdk/webpack/bootstrap","webpack:///video-ad-sdk/webpack/runtime/compat get default export","webpack:///video-ad-sdk/webpack/runtime/define property getters","webpack:///video-ad-sdk/webpack/runtime/global","webpack:///video-ad-sdk/webpack/runtime/hasOwnProperty shorthand","webpack:///video-ad-sdk/webpack/runtime/make namespace object","webpack:///video-ad-sdk/./src/tracker/errorCode.ts","webpack:///video-ad-sdk/./src/types/xml.ts","webpack:///video-ad-sdk/./src/tracker/linearEvents.ts","webpack:///video-ad-sdk/./src/tracker/nonLinearEvents.ts","webpack:///video-ad-sdk/./src/xml/helpers/xmlToJson.ts","webpack:///video-ad-sdk/./src/tracker/trackLinearEvent.ts","webpack:///video-ad-sdk/./src/tracker/trackNonLinearEvent.ts","webpack:///video-ad-sdk/./src/adContainer/VideoAdContainer.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/unique.ts","webpack:///video-ad-sdk/./src/xml/helpers/xmlSelectors.ts","webpack:///video-ad-sdk/./src/xml/index.ts","webpack:///video-ad-sdk/./src/vastSelectors/helpers/parseTime.ts","webpack:///video-ad-sdk/./src/vastSelectors/helpers/parseOffset.ts","webpack:///video-ad-sdk/./src/vastSelectors/helpers/getLinearCreative.ts","webpack:///video-ad-sdk/./src/vastSelectors/getLinearTrackingEvents.ts","webpack:///video-ad-sdk/./src/vastSelectors/getIcons.ts","webpack:///video-ad-sdk/./src/vastSelectors/index.ts","webpack:///video-ad-sdk/./src/tracker/helpers/pixelTracker.ts","webpack:///video-ad-sdk/./src/tracker/helpers/parseMacro.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackError.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackIconView.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackIconClick.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackProgress.ts","webpack:///video-ad-sdk/./src/tracker/helpers/createVastEventTracker.ts","webpack:///video-ad-sdk/./src/vastSelectors/getNonLinearTrackingEvents.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/loadScript.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/getContentDocument.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/supportsSrcdoc.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createIframe.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/getOrigin.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createAdContainer.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createAdVideoElement.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createSlot.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/adUnitError.ts","webpack:///video-ad-sdk/./src/adUnit/VideoAdUnit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/guessMimeType.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/canPlay.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/sortMediaByBestFit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/findBestMedia.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/once.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/progress/getProgressEvents.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/safeCallback.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onFullscreenChange.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onPlayPause.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onRewind.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onSkip.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onError.ts","webpack:///video-ad-sdk/./src/adUnit/adUnitEvents.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onTimeUpdate.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onVolumeChange.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onImpression.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/progress/toFixedDigits.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/progress/formatProgress.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onProgress.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onClickThrough.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/index.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/setupMetricHandlers.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/helpers/MutationObserver.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/onElementResize.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/helpers/IntersectionObserver.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/onElementVisibilityChange.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/Emitter/index.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/getResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/retrieveIcons.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/waitFor.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/fetch/fetchHtml.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createStaticResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createHtmlResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createIframeResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/loadResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/canBeRendered.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/renderIcon.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/updateIcon.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/renderIcons.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/canBeShown.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/addIcons.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/viewmode.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/preventManualProgress.ts","webpack:///video-ad-sdk/./src/adUnit/VastAdUnit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/updateMedia.ts","webpack:///video-ad-sdk/./src/adUnit/VpaidAdUnit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/isSupported.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/loadCreative.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/api.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/waitFor.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/callAndWait.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/handshake.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/initAd.ts","webpack:///video-ad-sdk/./src/adUnit/createVideoAdUnit.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/vastError.ts","webpack:///video-ad-sdk/./src/runner/helpers/startVideoAd.ts","webpack:///video-ad-sdk/./src/runner/run.ts","webpack:///video-ad-sdk/./src/adContainer/createVideoAdContainer.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/fetch.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/adUtils.ts","webpack:///video-ad-sdk/./src/vastRequest/requestAd.ts","webpack:///video-ad-sdk/./src/xml/helpers/xml2js.ts","webpack:///video-ad-sdk/./src/vastRequest/requestNextAd.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/getNextAd.ts","webpack:///video-ad-sdk/./src/runner/runWaterfall.ts","webpack:///video-ad-sdk/./src/utils/isIOS.ts","webpack:///video-ad-sdk/./demo/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, function() {\nreturn ","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","'use strict';\n\nvar innerXML = function (node) {\n    var s = new XMLSerializer();\n    return Array.prototype.map.call(node.childNodes, function (node) {\n        return s.serializeToString(node);\n    }).join('');\n};\n\nvar getParseError = function (doc) {\n    // Firefox\n    if (doc.documentElement.tagName === 'parsererror' &&\n        doc.documentElement.namespaceURI === 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {\n        return doc.documentElement;\n    }\n\n    // Chrome, Safari\n    if ((doc.documentElement.tagName === 'xml' || doc.documentElement.tagName === 'html') &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0];\n    }\n\n    // PhantomJS\n    if (doc.documentElement.tagName === 'html' &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'body' &&\n        doc.documentElement.childNodes[0].childNodes &&\n        doc.documentElement.childNodes[0].childNodes.length &&\n        doc.documentElement.childNodes[0].childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0].childNodes[0];\n    }\n\n    return undefined;\n};\n\nvar errorMessagePatterns = [\n    // Chrome, Safari, PhantomJS\n    new RegExp('^<h3[^>]*>This page contains the following errors:<\\/h3><div[^>]*>(.+?)\\n?<\\/div>'),\n    // Firefox\n    new RegExp('^(.+)\\n')\n];\n\nvar extractParseError = function (errorNode) {\n    var content = innerXML(errorNode);\n    var i, match;\n\n    for(i = 0; i < errorMessagePatterns.length; i++) {\n        match = errorMessagePatterns[i].exec(content);\n\n        if (match) {\n            return match[1];\n        }\n    }\n    return undefined;\n};\n\nvar failOnParseError = function (doc) {\n    var errorMessage;\n\n    if (doc === null) {\n        throw new Error('Parse error');\n    }\n\n    var parseError = getParseError(doc);\n    if (parseError !== undefined) {\n        errorMessage = extractParseError(parseError) || 'Parse error';\n        throw new Error(errorMessage);\n    }\n};\n\nexports.failOnParseError = function (doc) {\n    failOnParseError(doc);\n\n    return doc;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export var ErrorCode;\n(function (ErrorCode) {\n    ErrorCode[ErrorCode[\"VAST_XML_PARSING_ERROR\"] = 100] = \"VAST_XML_PARSING_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_SCHEMA_VALIDATION_ERROR\"] = 101] = \"VAST_SCHEMA_VALIDATION_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_UNSUPPORTED_VERSION\"] = 102] = \"VAST_UNSUPPORTED_VERSION\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_AD_TYPE\"] = 200] = \"VAST_UNEXPECTED_AD_TYPE\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_LINEARITY\"] = 201] = \"VAST_UNEXPECTED_LINEARITY\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_DURATION_ERROR\"] = 202] = \"VAST_UNEXPECTED_DURATION_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_MEDIA_FILE\"] = 203] = \"VAST_UNEXPECTED_MEDIA_FILE\";\n    ErrorCode[ErrorCode[\"VAST_WRAPPER_ERROR\"] = 300] = \"VAST_WRAPPER_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_LOAD_TIMEOUT\"] = 301] = \"VAST_LOAD_TIMEOUT\";\n    ErrorCode[ErrorCode[\"VAST_TOO_MANY_REDIRECTS\"] = 302] = \"VAST_TOO_MANY_REDIRECTS\";\n    ErrorCode[ErrorCode[\"VAST_NO_ADS_AFTER_WRAPPER\"] = 303] = \"VAST_NO_ADS_AFTER_WRAPPER\";\n    ErrorCode[ErrorCode[\"VIDEO_PLAY_ERROR\"] = 400] = \"VIDEO_PLAY_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_MEDIA_FILE_NOT_FOUND\"] = 401] = \"VAST_MEDIA_FILE_NOT_FOUND\";\n    ErrorCode[ErrorCode[\"VAST_MEDIA_LOAD_TIMEOUT\"] = 402] = \"VAST_MEDIA_LOAD_TIMEOUT\";\n    ErrorCode[ErrorCode[\"VAST_LINEAR_ASSET_MISMATCH\"] = 403] = \"VAST_LINEAR_ASSET_MISMATCH\";\n    ErrorCode[ErrorCode[\"VAST_PROBLEM_DISPLAYING_MEDIA_FILE\"] = 405] = \"VAST_PROBLEM_DISPLAYING_MEDIA_FILE\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_PLAYING_FAILED\"] = 500] = \"VAST_NONLINEAR_PLAYING_FAILED\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_DIMENSIONS_ERROR\"] = 501] = \"VAST_NONLINEAR_DIMENSIONS_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_LOADING_FAILED\"] = 502] = \"VAST_NONLINEAR_LOADING_FAILED\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_ASSET_MISMATCH\"] = 503] = \"VAST_NONLINEAR_ASSET_MISMATCH\";\n    ErrorCode[ErrorCode[\"UNKNOWN_ERROR\"] = 900] = \"UNKNOWN_ERROR\";\n    ErrorCode[ErrorCode[\"VPAID_ERROR\"] = 901] = \"VPAID_ERROR\";\n})(ErrorCode || (ErrorCode = {}));\nexport var isVastErrorCode = function (code) {\n    return Object.values(ErrorCode).includes(code);\n};\n","/**\n * XML node type\n */\nexport var NodeType;\n(function (NodeType) {\n    NodeType[\"CDATA\"] = \"cdata\";\n    NodeType[\"DOCUMENT\"] = \"document\";\n    NodeType[\"ELEMENT\"] = \"element\";\n    NodeType[\"TEXT\"] = \"text\";\n})(NodeType || (NodeType = {}));\n","/**\n * Interface for classes that may emit linear VAST events.\n *\n * @interface LinearEvents\n */\n/**\n * Fires when the the creative was played to the end at normal speed so that 100% of the creative was played.\n *\n * @event LinearEvents#complete\n */\nexport var complete = 'complete';\n/**\n * Fires when a user clicks the ad.\n *\n * @event LinearEvents#clickThrough\n */\nexport var clickThrough = 'clickThrough';\n/**\n * Fires when there was an error with the linear creative.\n *\n * @event LinearEvents#error\n */\nexport var error = 'error';\n/**\n * Fires when the creative played continuously for at least 25% of the total duration at normal speed.\n *\n * @event LinearEvents#firstQuartile\n */\nexport var firstQuartile = 'firstQuartile';\n/**\n * Fires when there was an impression of the linear creative.\n *\n * @event LinearEvents#impression\n */\nexport var impression = 'impression';\n/**\n * Fires when more than 50% of the creative is visible.\n *\n * @event LinearEvents#viewable\n */\nexport var viewable = 'viewable';\n/**\n * Fires when less than 50% of the creative is visible.\n *\n * @event LinearEvents#notViewable\n */\nexport var notViewable = 'notViewable';\n/**\n * Fires when there is no way to determine visibility of the creative.\n *\n * @event LinearEvents#viewUndetermined\n */\nexport var viewUndetermined = 'viewUndetermined';\n/**\n * Fires when the creative played continuously for at least 50% of the total duration at normal speed.\n *\n * @event LinearEvents#midpoint\n */\nexport var midpoint = 'midpoint';\n/**\n * Fires when the user activated the mute control and muted the creative.\n *\n * @event LinearEvents#mute\n */\nexport var mute = 'mute';\n/**\n * Optional metric that can capture all other user interactions under one metric such a s hover-overs, or custom clicks. It should NOT replace clickthrough events or other existing events like mute, unmute, pause, etc.\n *\n * @event LinearEvents#otherAdInteraction\n */\nexport var otherAdInteraction = 'otherAdInteraction';\n/**\n * Fires when the user clicked the pause control and stopped the creative.\n *\n * @event LinearEvents#pause\n */\nexport var pause = 'pause';\n/**\n * Fires when the user activated a control to reduce player to a smaller size. This event replaces the exitFullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerCollapse\n */\nexport var playerCollapse = 'playerCollapse';\n/**\n * Fires when the user activated a control to reduce player to a smaller size.\n *\n * @event LinearEvents#exitFullscreen\n */\nexport var exitFullscreen = 'exitFullscreen';\n/**\n * Fires when the user activated a control to extend the player to a larger size. This event replaces the fullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerExpand\n */\nexport var playerExpand = 'playerExpand';\n/**\n * Fires when the user activated a control to extend the player to a larger size. Only for VAST 3.\n *\n * @event LinearEvents#fullscreen\n */\nexport var fullscreen = 'fullscreen';\n/**\n * Fires when the creative played for a duration at normal speed that is equal to or greater than the value provided in an additional offset attribute for the <Tracking> element under Linear ads. Values can be time in the format HH:MM:SS or HH:MM:SS.mmm or a percentage value in the format n%.\n *\n * @event LinearEvents#progress\n */\nexport var progress = 'progress';\n/**\n * Fires when the user activated the resume control after the creative had been stopped or paused.\n *\n * @event LinearEvents#resume\n */\nexport var resume = 'resume';\n/**\n * Fires when the user activated the rewind control to access a previous point in the creative timeline.\n *\n * @event LinearEvents#rewind\n */\nexport var rewind = 'rewind';\n/**\n * Fires when the user activated a skip control to skip the creative.\n *\n * @event LinearEvents#skip\n */\nexport var skip = 'skip';\n/**\n * This event is used to indicate that an individual creative within the ad was loaded and playback began. As with creativeView, this event is another way of tracking creative playback.\n *\n * @event LinearEvents#start\n */\nexport var start = 'start';\n/**\n * Fires when the creative played continuously for at least 75% of the duration at normal speed.\n *\n * @event LinearEvents#thirdQuartile\n */\nexport var thirdQuartile = 'thirdQuartile';\n/**\n * Amount of video viewed at normal speed in seconds or other appropriate time-based units. If a rewind event occurs during play, time spent viewing may be calculated on total amount of video viewed at normal speed, which may include additional amounts of video viewed after rewinding. The offset attribute for the <Tracking> element under Linear ads may be used to track when time spent viewing meets the threshold. Otherwise, a macro may be provided so that the player may return a time value. VAST does not provide a standard macro for this value, so the involved parties must establish these parameters if this metric is to be used.\n *\n * @event LinearEvents#timeSpentViewing\n */\nexport var timeSpentViewing = 'timeSpentViewing';\n/**\n * Fires when the user activated the mute control and unmuted the creative.\n *\n * @event LinearEvents#unmute\n */\nexport var unmute = 'unmute';\n/**\n * Fires when the user clicked the creative icon.\n *\n * @event LinearEvents#iconClick\n */\nexport var iconClick = 'iconClick';\n/**\n * Fires when the user viewed the creative icon.\n *\n * @event LinearEvents#iconView\n */\nexport var iconView = 'iconView';\n/**\n * The viewer has chosen to close the linear ad unit. This is currently inuse by some of the largest mobile SDKs to mark the dismissal of the end card companion that follows the video, as well as a close of the video itself, if applicable\n *\n * @event LinearEvents#closeLinear\n */\nexport var closeLinear = 'closeLinear';\n/**\n * Not to be confused with an impression, this event indicates that an individual creative portion of the ad was viewed.\n *\n * @event LinearEvents#creativeView\n */\nexport var creativeView = 'creativeView';\nvar linearEvents = {\n    clickThrough: clickThrough,\n    closeLinear: closeLinear,\n    complete: complete,\n    creativeView: creativeView,\n    error: error,\n    exitFullscreen: exitFullscreen,\n    firstQuartile: firstQuartile,\n    fullscreen: fullscreen,\n    iconClick: iconClick,\n    iconView: iconView,\n    impression: impression,\n    midpoint: midpoint,\n    mute: mute,\n    notViewable: notViewable,\n    otherAdInteraction: otherAdInteraction,\n    pause: pause,\n    playerCollapse: playerCollapse,\n    playerExpand: playerExpand,\n    progress: progress,\n    resume: resume,\n    rewind: rewind,\n    skip: skip,\n    start: start,\n    thirdQuartile: thirdQuartile,\n    timeSpentViewing: timeSpentViewing,\n    unmute: unmute,\n    viewable: viewable,\n    viewUndetermined: viewUndetermined\n};\nexport default linearEvents;\n","/**\n * Interface for classes that may emit non linear VAST events.\n *\n * @interface NonLinearEvents\n */\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the players viewable area or takes-over the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#acceptInvitation\n */\nexport var acceptInvitation = 'acceptInvitation';\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the players viewable area or takes-over the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#adCollapse\n */\nexport var adCollapse = 'adCollapse';\n/**\n * Fires when the user clicked or otherwise activated a control for removing the ad.\n *\n * @event NonLinearEvents#close\n */\nexport var close = 'close';\nvar nonLinearEvents = {\n    acceptInvitation: acceptInvitation,\n    adCollapse: adCollapse,\n    close: close\n};\nexport default nonLinearEvents;\n","import { NodeType } from '../../types';\nvar getNodeType = function (node) {\n    switch (node.nodeType) {\n        case 1:\n            return NodeType.ELEMENT;\n        case 3:\n        case 4:\n            return NodeType.TEXT;\n        case 9:\n            return NodeType.DOCUMENT;\n        default:\n            throw new Error('Unsupported element type');\n    }\n};\nvar getNodeAttributes = function (node) {\n    return node.attributes.length === 0\n        ? undefined\n        : Object.fromEntries(Array.from(node.attributes).map(function (attribute) {\n            var _a;\n            return [\n                attribute.nodeName,\n                (_a = attribute.nodeValue) !== null && _a !== void 0 ? _a : undefined\n            ];\n        }));\n};\nvar getNodeText = function (node) { var _a; return (_a = node.nodeValue) === null || _a === void 0 ? void 0 : _a.replace('<![CDATA[', '').replace(']]>', '').trim(); };\nvar getNodeChildren = function (node) {\n    var _a, _b;\n    if (!node.hasChildNodes()) {\n        return;\n    }\n    var childNodes = Array.from(node.childNodes).filter(function (childNode) {\n        return [1, 3, 4].includes(childNode.nodeType);\n    });\n    var elements = [];\n    for (var _i = 0, childNodes_1 = childNodes; _i < childNodes_1.length; _i++) {\n        var childNode = childNodes_1[_i];\n        var childElement = xmlToJson(childNode);\n        if (!(childNode instanceof Text) || ((_b = (_a = childElement.text) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0) > 0) {\n            elements.push(childElement);\n        }\n    }\n    return elements;\n};\nvar xmlToJson = function (node) {\n    var type = getNodeType(node);\n    var element = {\n        type: type\n    };\n    if (node instanceof Element) {\n        var attributes = getNodeAttributes(node);\n        if (attributes) {\n            element.attributes = attributes;\n        }\n        element.name = node.nodeName.toLowerCase();\n    }\n    else if (node instanceof Text || node instanceof CDATASection) {\n        element.text = getNodeText(node);\n    }\n    var children = getNodeChildren(node);\n    if (children) {\n        element.elements = children;\n    }\n    return element;\n};\nexport default xmlToJson;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar _a;\nimport { getClickTracking, getCustomClick, getImpression, getViewable, getNotViewable, getViewUndetermined, getLinearTrackingEvents } from '../vastSelectors';\nimport pixelTracker from './helpers/pixelTracker';\nimport trackError from './helpers/trackError';\nimport trackIconView from './helpers/trackIconView';\nimport trackIconClick from './helpers/trackIconClick';\nimport trackProgress from './helpers/trackProgress';\nimport createVastEventTracker from './helpers/createVastEventTracker';\nimport { clickThrough, closeLinear, complete, error, exitFullscreen, firstQuartile, fullscreen, iconClick, iconView, impression, viewable, notViewable, viewUndetermined, midpoint, mute, pause, playerCollapse, playerExpand, progress, resume, rewind, skip, start, thirdQuartile, unmute, creativeView } from './linearEvents';\nvar eventSelector = function () {\n    var selectors = [];\n    for (var _i = 0; _i < arguments.length; _i++) {\n        selectors[_i] = arguments[_i];\n    }\n    return function (ad) {\n        var trackingURIs = [];\n        if (selectors.length > 0) {\n            selectors.forEach(function (getElements) {\n                var elements = getElements(ad);\n                /* istanbul ignore else */\n                if (Array.isArray(elements) && elements.length > 0) {\n                    trackingURIs.push.apply(trackingURIs, elements.map(function (uri) { return ({ uri: uri }); }));\n                }\n            });\n        }\n        return trackingURIs;\n    };\n};\nvar linearTrackingEventSelector = function (event) { return function (ad) {\n    return getLinearTrackingEvents(ad, event);\n}; };\nvar linearTrackers = (_a = {},\n    _a[clickThrough] = createVastEventTracker(eventSelector(getClickTracking, getCustomClick)),\n    _a[closeLinear] = createVastEventTracker(linearTrackingEventSelector(closeLinear)),\n    _a[complete] = createVastEventTracker(linearTrackingEventSelector(complete)),\n    _a[creativeView] = createVastEventTracker(linearTrackingEventSelector(creativeView)),\n    _a[error] = trackError,\n    _a[exitFullscreen] = createVastEventTracker(linearTrackingEventSelector(exitFullscreen)),\n    _a[firstQuartile] = createVastEventTracker(linearTrackingEventSelector(firstQuartile)),\n    _a[fullscreen] = createVastEventTracker(linearTrackingEventSelector(fullscreen)),\n    _a[iconClick] = trackIconClick,\n    _a[iconView] = trackIconView,\n    _a[impression] = createVastEventTracker(eventSelector(getImpression)),\n    _a[midpoint] = createVastEventTracker(linearTrackingEventSelector(midpoint)),\n    _a[mute] = createVastEventTracker(linearTrackingEventSelector(mute)),\n    _a[notViewable] = createVastEventTracker(eventSelector(getNotViewable)),\n    _a[pause] = createVastEventTracker(linearTrackingEventSelector(pause)),\n    _a[playerCollapse] = createVastEventTracker(linearTrackingEventSelector(playerCollapse)),\n    _a[playerExpand] = createVastEventTracker(linearTrackingEventSelector(playerExpand)),\n    _a[progress] = trackProgress,\n    _a[resume] = createVastEventTracker(linearTrackingEventSelector(resume)),\n    _a[rewind] = createVastEventTracker(linearTrackingEventSelector(rewind)),\n    _a[skip] = createVastEventTracker(linearTrackingEventSelector(skip)),\n    _a[start] = createVastEventTracker(linearTrackingEventSelector(start)),\n    _a[thirdQuartile] = createVastEventTracker(linearTrackingEventSelector(thirdQuartile)),\n    _a[unmute] = createVastEventTracker(linearTrackingEventSelector(unmute)),\n    _a[viewable] = createVastEventTracker(eventSelector(getViewable)),\n    _a[viewUndetermined] = createVastEventTracker(eventSelector(getViewUndetermined)),\n    _a);\n/**\n * Tracks the passed linear event.\n *\n * @param event name of the linear event we need to track. @see LinearEvents\n * @param vastChain the ad VAST Chain.\n * @param options Options Map. The allowed properties are:\n */\nvar trackLinearEvent = function (event, vastChain, _a) {\n    var data = _a.data, errorCode = _a.errorCode, _b = _a.tracker, tracker = _b === void 0 ? pixelTracker : _b, _c = _a.logger, logger = _c === void 0 ? console : _c;\n    var linearTracker = linearTrackers[event];\n    if (linearTracker) {\n        linearTracker(vastChain, {\n            data: __assign(__assign({}, data), { errorCode: errorCode }),\n            errorCode: errorCode,\n            tracker: tracker\n        });\n    }\n    else {\n        logger.error(\"Event '\".concat(event, \"' cannot be tracked\"));\n    }\n};\nexport default trackLinearEvent;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar _a;\nimport { getNonLinearTrackingEvents } from '../vastSelectors';\nimport createVastEventTracker from './helpers/createVastEventTracker';\nimport pixelTracker from './helpers/pixelTracker';\nimport { acceptInvitation, adCollapse, close } from './nonLinearEvents';\nvar trackingEventSelector = function (event) { return function (ad) {\n    return getNonLinearTrackingEvents(ad, event);\n}; };\nvar linearTrackers = (_a = {},\n    _a[acceptInvitation] = createVastEventTracker(trackingEventSelector(acceptInvitation)),\n    _a[adCollapse] = createVastEventTracker(trackingEventSelector(adCollapse)),\n    _a[close] = createVastEventTracker(trackingEventSelector(close)),\n    _a);\n/**\n * Tracks the passed non linear event.\n *\n * @param event name of the linear event we need to track. @see LinearEvents\n * @param vastChain the ad VAST Chain.\n * @param options Options Map.\n */\nvar trackNonLinearEvent = function (event, vastChain, _a) {\n    var data = _a.data, _b = _a.tracker, tracker = _b === void 0 ? pixelTracker : _b, _c = _a.logger, logger = _c === void 0 ? console : _c;\n    var linearTracker = linearTrackers[event];\n    if (linearTracker) {\n        linearTracker(vastChain, {\n            data: __assign({}, data),\n            tracker: tracker\n        });\n    }\n    else {\n        logger.error(\"Event '\".concat(event, \"' cannot be tracked\"));\n    }\n};\nexport default trackNonLinearEvent;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar _a;\nimport loadScript from './helpers/loadScript';\nimport createAdVideoElement from './helpers/createAdVideoElement';\nimport createAdContainer from './helpers/createAdContainer';\nimport createIframe from './helpers/createIframe';\nimport createSlot from './helpers/createSlot';\nimport getContentDocument from './helpers/getContentDocument';\nimport unique from './helpers/unique';\nvar nextId = unique('videoAdContainer');\nvar hidden = Symbol('hidden');\n/**\n * This class provides everything necessary to contain and create a video ad within a given placeholder Element.\n */\nvar VideoAdContainer = /** @class */ (function () {\n    /**\n     * Creates a VideoAdContainer.\n     *\n     * @param placeholder DIV that will contain the ad.\n     * @param videoElement optional videoElement that will be used to play the ad.\n     */\n    function VideoAdContainer(placeholder, videoElement) {\n        this[_a] = {\n            destroyed: false,\n            id: nextId(),\n            iframe: undefined,\n            readyPromise: undefined\n        };\n        if (!(placeholder instanceof Element)) {\n            throw new TypeError('placeholder is not an Element');\n        }\n        this.element = createAdContainer();\n        this.isOriginalVideoElement = Boolean(videoElement);\n        if (videoElement) {\n            this.videoElement = videoElement;\n        }\n        else {\n            this.videoElement = createAdVideoElement();\n            this.element.appendChild(this.videoElement);\n        }\n        placeholder.appendChild(this.element);\n    }\n    /**\n     * Adds the passed script to the ad container.\n     *\n     * @param src script source uri.\n     * @param options Options map.\n     */\n    VideoAdContainer.prototype.addScript = function (src, options) {\n        var _b;\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            var iframe, placeholder;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        if (this.isDestroyed()) {\n                            throw new Error('VideoAdContainer has been destroyed');\n                        }\n                        iframe = this[hidden].iframe;\n                        if (!!iframe) return [3 /*break*/, 2];\n                        return [4 /*yield*/, createIframe(this.element, this[hidden].id)];\n                    case 1:\n                        iframe = _c.sent();\n                        this[hidden].iframe = iframe;\n                        this.executionContext = iframe.contentWindow;\n                        _c.label = 2;\n                    case 2:\n                        placeholder = (_b = getContentDocument(iframe)) === null || _b === void 0 ? void 0 : _b.body;\n                        return [2 /*return*/, loadScript(src, __assign({ placeholder: placeholder }, options))];\n                }\n            });\n        });\n    };\n    /**\n     * Adds the slot to the ad container.\n     *\n     * @param width - Slot width.\n     * @param height - Slot height.\n     */\n    VideoAdContainer.prototype.addSlot = function (width, height) {\n        if (this.isDestroyed()) {\n            throw new Error('VideoAdContainer has been destroyed');\n        }\n        if (!this.slotElement) {\n            this.slotElement = createSlot(this.element, width, height);\n        }\n    };\n    /**\n     * Destroys the VideoAdContainer.\n     */\n    VideoAdContainer.prototype.destroy = function () {\n        var _this = this;\n        // NOTE: calling destroy immediately terminates the iframe and cancels\n        //       tracking requests from vpaid script, so destroying should\n        //       immediately hides and remove the iframe from dom after timeout\n        var removePromise = new Promise(function (resolve) {\n            setTimeout(function () {\n                var _b;\n                (_b = _this.element.parentNode) === null || _b === void 0 ? void 0 : _b.removeChild(_this.element);\n                resolve();\n            }, 1000);\n        });\n        this.element.style.zIndex = '-9999';\n        this[hidden].destroyed = true;\n        return removePromise;\n    };\n    /**\n     * Checks if the container is destroyed.\n     *\n     * @returns true if the container is destroyed and false otherwise.\n     */\n    VideoAdContainer.prototype.isDestroyed = function () {\n        return this[hidden].destroyed;\n    };\n    return VideoAdContainer;\n}());\n_a = hidden;\nexport default VideoAdContainer;\n","/**\n * unique will create a unique string every time is called, sequentially and namespaced\n *\n * @ignore\n * @param namespace\n */\nvar unique = function (namespace) {\n    var count = -1;\n    return function () { return namespace + '_' + ++count; };\n};\nexport default unique;\n","var getChildren = function (element) { var _a; return (_a = element.elements) !== null && _a !== void 0 ? _a : []; };\nvar findChildByName = function (element, childName) {\n    return getChildren(element).find(function (_a) {\n        var _b = _a.name, name = _b === void 0 ? '' : _b;\n        return name.toUpperCase() === childName.toUpperCase();\n    });\n};\nvar filterChildrenByName = function (element, childrenName) {\n    return getChildren(element).filter(function (_a) {\n        var _b = _a.name, name = _b === void 0 ? '' : _b;\n        return name.toUpperCase() === childrenName.toUpperCase();\n    });\n};\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @param element Parsed xml element object.\n * @param childName Child element name\n * @returns The first child element with the passed name or undefined if not found.\n */\nexport var get = findChildByName;\n/**\n * Get all the children elements of the passed parsed xml element filtered by the passed child name if passed.\n *\n * @param element Parsed xml element object.\n * @param childName Child element name.\n * @returns Array of child elements or an empty array.\n */\nexport var getAll = function (element, childName) {\n    if (typeof childName === 'string') {\n        return filterChildrenByName(element, childName);\n    }\n    return getChildren(element);\n};\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @returns The first child element or undefined if there are non.\n */\nexport var getFirstChild = function (element) {\n    return getChildren(element)[0];\n};\n/**\n * Get the text value of the passed parsed xml element.\n *\n * @returns Text of the element\n */\nexport var getText = function (element) {\n    var firstChild = element && getFirstChild(element);\n    return firstChild && firstChild.text;\n};\n/**\n * Get all the attributes of the passed parsed xml element.\n *\n * @returns Object with the element attributes.\n */\nexport var getAttributes = function (element) { var _a; return (_a = element.attributes) !== null && _a !== void 0 ? _a : {}; };\n/**\n * Get the attribute with the passed name of the passed parsed xml element.\n *\n * @returns Attribute value or undefined.\n */\nexport var getAttribute = function (element, attributeName) { return getAttributes(element)[attributeName]; };\n","import xml2js from './helpers/xml2js';\nimport { get, getAll, getFirstChild, getText, getAttributes, getAttribute } from './helpers/xmlSelectors';\nvar parser = new DOMParser();\n/**\n * Parses the passed xml text.\n *\n * @throws if there is an error parsing the xml.\n * @param xmlText XML text to be parsed.\n * @returns Returns the parsed xml document as a js object.\n */\nexport var parseXml = function (xmlText) { return xml2js(parser, xmlText); };\nexport { get, getAll, getFirstChild, getText, getAttributes, getAttribute };\n","var parseHoursToMs = function (hourStr) {\n    return parseInt(hourStr, 10) * 60 * 60 * 1000;\n};\nvar parseMinToMs = function (minStr) {\n    return parseInt(minStr, 10) * 60 * 1000;\n};\nvar parseSecToMs = function (secStr) { return parseInt(secStr, 10) * 1000; };\nvar parseTime = function (durationStr) {\n    if (typeof durationStr === 'string') {\n        var durationRegex = /(\\d\\d):(\\d\\d):(\\d\\d)(\\.(\\d\\d\\d))?/;\n        var match = durationStr.match(durationRegex);\n        if (match) {\n            var durationInMs = parseHoursToMs(match[1]) +\n                parseMinToMs(match[2]) +\n                parseSecToMs(match[3]) +\n                (match[5] ? parseInt(match[5], 10) : 0);\n            if (!isNaN(durationInMs)) {\n                return durationInMs;\n            }\n        }\n    }\n};\nexport default parseTime;\n","import parseTime from './parseTime';\nvar isPercentage = function (offset) {\n    var percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n    return percentageRegex.test(offset);\n};\nvar parseOffset = function (offset) {\n    if (isPercentage(offset)) {\n        return offset;\n    }\n    return parseTime(offset);\n};\nexport default parseOffset;\n","import { get, getAll, getFirstChild } from '../../xml';\nvar hasLinear = function (creative) {\n    return get(creative, 'linear');\n};\nvar getLinearCreative = function (ad) {\n    var adTypeElement = getFirstChild(ad);\n    var creativesElement = adTypeElement && get(adTypeElement, 'creatives');\n    return creativesElement && getAll(creativesElement).find(hasLinear);\n};\nexport default getLinearCreative;\n","import { get, getAll, getText, getAttributes } from '../xml';\nimport parseOffset from './helpers/parseOffset';\nimport getLinearCreative from './helpers/getLinearCreative';\nvar getTrackingEvent = function (trackingEventElement) {\n    var _a = getAttributes(trackingEventElement), event = _a.event, offset = _a.offset;\n    var uri = getText(trackingEventElement);\n    return {\n        event: event,\n        offset: offset && parseOffset(offset),\n        uri: uri\n    };\n};\n/**\n * Gets the Linear tracking events from the Vast Ad\n *\n * @param ad VAST ad object.\n * @param eventName If provided it will filter-out the array events against it.\n * @returns Array of Tracking event definitions\n */\nvar getLinearTrackingEvents = function (ad, eventName) {\n    var creativeElement = ad && getLinearCreative(ad);\n    var linearElement = creativeElement && get(creativeElement, 'Linear');\n    var trackingEventsElement = linearElement && get(linearElement, 'TrackingEvents');\n    var trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n    if (trackingEventElements && trackingEventElements.length > 0) {\n        var trackingEvents = trackingEventElements.map(getTrackingEvent);\n        if (!eventName) {\n            return trackingEvents;\n        }\n        var filteredEvents = trackingEvents.filter(function (_a) {\n            var event = _a.event;\n            return event === eventName;\n        });\n        if (filteredEvents.length > 0) {\n            return filteredEvents;\n        }\n    }\n};\nexport default getLinearTrackingEvents;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { get, getAll, getText, getAttributes } from '../xml';\nimport getLinearCreative from './helpers/getLinearCreative';\nimport parseTime from './helpers/parseTime';\nvar formatSize = function (size) {\n    var match = \"\".concat(size).match(/\\d+/g);\n    return parseInt((match === null || match === void 0 ? void 0 : match[0]) || '', 10);\n};\nvar formatPosition = function (position) {\n    var isNumberString = /\\d+/.test(position);\n    if (isNumberString) {\n        return formatSize(position);\n    }\n    return position;\n};\nvar getIconAttributes = function (iconElement) {\n    var _a = getAttributes(iconElement), duration = _a.duration, height = _a.height, offset = _a.offset, program = _a.program, pxratio = _a.pxratio, width = _a.width, _b = _a.xPosition, xPosition = _b === void 0 ? 'right' : _b, _c = _a.yPosition, yPosition = _c === void 0 ? 'top' : _c;\n    return {\n        duration: (duration && parseTime(duration)) || undefined,\n        height: (height && formatSize(height)) || undefined,\n        offset: (offset && parseTime(offset)) || undefined,\n        program: program,\n        pxratio: (pxratio && parseInt(pxratio, 10)) || undefined,\n        width: (width && formatSize(width)) || undefined,\n        xPosition: xPosition && formatPosition(xPosition),\n        yPosition: yPosition && formatPosition(yPosition)\n    };\n};\nvar getIconResource = function (iconElement) {\n    var staticResourceElement = get(iconElement, 'StaticResource');\n    var htmlResourceElement = get(iconElement, 'HTMLResource');\n    var iFrameResourceElement = get(iconElement, 'IFrameResource');\n    if (staticResourceElement) {\n        return { staticResource: getText(staticResourceElement) };\n    }\n    if (htmlResourceElement) {\n        return { htmlResource: getText(htmlResourceElement) };\n    }\n    if (iFrameResourceElement) {\n        return { iFrameResource: getText(iFrameResourceElement) };\n    }\n    return {\n        staticResource: getText(iconElement)\n    };\n};\nvar getIconViewTracking = function (iconElement) {\n    var iconTrackingElements = getAll(iconElement, 'IconViewTracking')\n        .map(function (iconViewTrackingElement) { return getText(iconViewTrackingElement); })\n        .filter(Boolean);\n    if (iconTrackingElements.length === 0) {\n        return {};\n    }\n    return {\n        iconViewTracking: iconTrackingElements\n    };\n};\nvar getIconClicks = function (iconElement) {\n    var iconClicksElement = get(iconElement, 'IconClicks');\n    var iconClickThroughElement = iconClicksElement && get(iconClicksElement, 'IconClickThrough');\n    var iconClickTrackingElements = iconClicksElement &&\n        getAll(iconClicksElement, 'IconClickTracking')\n            .map(function (iconClickTrackingElement) { return getText(iconClickTrackingElement); })\n            .filter(Boolean);\n    return {\n        iconClickThrough: iconClickThroughElement && getText(iconClickThroughElement),\n        iconClickTracking: iconClickTrackingElements && iconClickTrackingElements.length > 0\n            ? iconClickTrackingElements\n            : undefined\n    };\n};\n/**\n * Gets the Vast Icon definitions from the Vast Ad.\n *\n * @param ad VAST ad object.\n * @returns Array of VAST icon definitions\n */\nvar getIcons = function (ad) {\n    var linearCreativeElement = ad && getLinearCreative(ad);\n    var linearElement = linearCreativeElement && get(linearCreativeElement, 'linear');\n    var iconsElement = linearElement && get(linearElement, 'Icons');\n    var iconElements = iconsElement && getAll(iconsElement, 'Icon');\n    if (iconElements && iconElements.length > 0) {\n        return iconElements.map(function (iconElement) { return (__assign(__assign(__assign(__assign({}, getIconAttributes(iconElement)), getIconResource(iconElement)), getIconViewTracking(iconElement)), getIconClicks(iconElement))); });\n    }\n};\nexport default getIcons;\n","import { get, getAll, getFirstChild, getText, getAttributes, getAttribute } from '../xml';\nimport parseOffset from './helpers/parseOffset';\nimport getLinearCreative from './helpers/getLinearCreative';\nimport getLinearTrackingEvents from './getLinearTrackingEvents';\nimport getNonLinearTrackingEvents from './getNonLinearTrackingEvents';\nimport getIcons from './getIcons';\nvar getBooleanValue = function (val) {\n    if (typeof val === 'string') {\n        return val === 'true';\n    }\n    return Boolean(val);\n};\nvar compareBySequence = function (itemA, itemB) {\n    var itemASequenceString = getAttribute(itemA, 'sequence');\n    var itemBSequenceString = getAttribute(itemB, 'sequence');\n    var itemASequence = itemASequenceString && parseInt(itemASequenceString, 10);\n    var itemBSequence = itemBSequenceString && parseInt(itemBSequenceString, 10);\n    if (typeof itemASequence !== 'string' || typeof itemBSequence !== 'string') {\n        return 0;\n    }\n    if (itemASequence < itemBSequence) {\n        return -1;\n    }\n    if (itemASequence > itemBSequence) {\n        return 1;\n    }\n    return 0;\n};\n/**\n * Selects the ads of the passed VAST.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns Array of ads or empty array.\n */\nexport var getAds = function (parsedVast) {\n    var vastElement = parsedVast && get(parsedVast, 'VAST');\n    var ads = vastElement && getAll(vastElement, 'Ad');\n    if (ads && ads.length > 0) {\n        return ads;\n    }\n    return [];\n};\n/**\n * Gets the Error URI of the passed parsed VAST xml.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns array of the Vast Error URI\n */\nexport var getVastErrorURI = function (parsedVast) {\n    var vastElement = parsedVast && get(parsedVast, 'VAST');\n    var errors = vastElement && getAll(vastElement, 'Error');\n    if (errors && errors.length > 0) {\n        return errors.map(function (error) { var _a; return (_a = getText(error)) !== null && _a !== void 0 ? _a : ''; }).filter(Boolean);\n    }\n};\n/**\n * Gets the sequence of the pod ad.\n *\n * @param ad Parsed ad definition object.\n * @returns The pod ad sequence number.\n */\nexport var getPodAdSequence = function (ad) {\n    var sequenceString = getAttribute(ad, 'sequence');\n    var sequence = sequenceString && parseInt(sequenceString, 10);\n    if (typeof sequence === 'number' && !isNaN(sequence)) {\n        return sequence;\n    }\n};\n/**\n * Checks if the passed ad definition is a pod ad.\n *\n * @param ad Parsed ad definition object.\n * @returns Returns true if there the ad is a pod ad and false otherwise.\n */\nexport var isPodAd = function (ad) { return Boolean(getPodAdSequence(ad)); };\n/**\n * Checks if the passed array of ads have an ad pod.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns Returns true if there is an ad pod in the array and false otherwise.\n */\nexport var hasAdPod = function (parsedVast) {\n    var ads = getAds(parsedVast);\n    return Array.isArray(ads) && ads.filter(isPodAd).length > 1;\n};\n/**\n * Returns true if the passed vastChain has an ad pod or false otherwise.\n *\n * @param vastChain Array of VAST responses. See `load` or `requestAd` for more info.\n * @returns True if the vastChain contains an ad pod and false otherwise.\n */\nexport var isAdPod = function (vastChain) {\n    if (vastChain === void 0) { vastChain = []; }\n    return vastChain.map(function (_a) {\n        var parsedXML = _a.parsedXML;\n        return parsedXML;\n    }).some(hasAdPod);\n};\n/**\n * Selects the first ad of the passed VAST. If the passed VAST response contains an ad pod it will return the first ad in the ad pod sequence.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns First ad of the VAST xml.\n */\nexport var getFirstAd = function (parsedVast) {\n    var ads = getAds(parsedVast);\n    if (Array.isArray(ads) && ads.length > 0) {\n        if (hasAdPod(parsedVast)) {\n            return ads.filter(isPodAd).sort(compareBySequence)[0];\n        }\n        return ads[0];\n    }\n};\n/**\n * Checks if the passed ad is a Wrapper.\n *\n * @param ad VAST ad object.\n * @returns `true` if the ad contains a wrapper and `false` otherwise.\n */\nexport var isWrapper = function (ad) {\n    return Boolean(get(ad || {}, 'Wrapper'));\n};\n/**\n * Checks if the passed ad is an Inline.\n *\n * @param ad VAST ad object.\n * @returns Returns `true` if the ad contains an Inline or `false` otherwise.\n */\nexport var isInline = function (ad) {\n    return Boolean(get(ad || {}, 'Inline'));\n};\n/**\n * Returns the VASTAdTagURI from the wrapper ad.\n *\n * @param ad VAST ad object.\n * @returns Returns the VASTAdTagURI from the wrapper ad.\n */\nexport var getVASTAdTagURI = function (ad) {\n    var wrapperElement = get(ad, 'Wrapper');\n    var vastAdTagURIElement = wrapperElement && get(wrapperElement, 'VastAdTagUri');\n    return vastAdTagURIElement && getText(vastAdTagURIElement);\n};\n/**\n * Returns the options from the wrapper ad.\n *\n * @param ad VAST ad object.\n * @returns Returns the options from the wrapper ad.\n */\nexport var getWrapperOptions = function (ad) {\n    var wrapperElement = get(ad, 'Wrapper');\n    var options = {};\n    if (wrapperElement) {\n        var _a = getAttributes(wrapperElement), allowMultipleAds = _a.allowMultipleAds, fallbackOnNoAd = _a.fallbackOnNoAd, followAdditionalWrappers = _a.followAdditionalWrappers;\n        if (allowMultipleAds) {\n            options.allowMultipleAds = getBooleanValue(allowMultipleAds);\n        }\n        if (fallbackOnNoAd) {\n            options.fallbackOnNoAd = getBooleanValue(fallbackOnNoAd);\n        }\n        if (followAdditionalWrappers) {\n            options.followAdditionalWrappers = getBooleanValue(followAdditionalWrappers);\n        }\n    }\n    return options;\n};\n/**\n * Gets the Error URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad Error URI.\n */\nexport var getAdErrorURI = function (ad) {\n    var adTypeElement = ad && getFirstChild(ad);\n    var errors = adTypeElement && getAll(adTypeElement, 'Error');\n    if (errors && errors.length > 0) {\n        return errors.map(function (error) { var _a; return (_a = getText(error)) !== null && _a !== void 0 ? _a : ''; }).filter(Boolean);\n    }\n};\n/**\n * Gets array of the Impression URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad Impression URI.\n */\nexport var getImpression = function (ad) {\n    var adTypeElement = ad && getFirstChild(ad);\n    var impressions = adTypeElement && getAll(adTypeElement, 'Impression');\n    if (impressions && impressions.length > 0) {\n        return impressions\n            .map(function (impression) { var _a; return (_a = getText(impression)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets array of the Viewable URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad Viewable URI.\n */\nexport var getViewable = function (ad) {\n    var adTypeElement = ad && getFirstChild(ad);\n    var viewableImpression = adTypeElement && get(adTypeElement, 'ViewableImpression');\n    var viewableElements = viewableImpression && getAll(viewableImpression, 'Viewable');\n    if (viewableElements && viewableElements.length > 0) {\n        return viewableElements\n            .map(function (element) { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets array of the NotViewable URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad NotViewable URI.\n */\nexport var getNotViewable = function (ad) {\n    var adTypeElement = ad && getFirstChild(ad);\n    var viewableImpression = adTypeElement && get(adTypeElement, 'ViewableImpression');\n    var notViewableElements = viewableImpression && getAll(viewableImpression, 'NotViewable');\n    if (notViewableElements && notViewableElements.length > 0) {\n        return notViewableElements\n            .map(function (element) { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets array of the ViewUndetermined URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad ViewUndetermined URI.\n */\nexport var getViewUndetermined = function (ad) {\n    var adTypeElement = ad && getFirstChild(ad);\n    var viewableImpression = adTypeElement && get(adTypeElement, 'ViewableImpression');\n    var viewUndeterminedElements = viewableImpression && getAll(viewableImpression, 'ViewUndetermined');\n    if (viewUndeterminedElements && viewUndeterminedElements.length > 0) {\n        return viewUndeterminedElements\n            .map(function (element) { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets the ad's MediaFiles.\n *\n * @param ad VAST ad object.\n * @returns array of media files\n */\nexport var getMediaFiles = function (ad) {\n    var creativeElement = ad && getLinearCreative(ad);\n    var universalAdIdElement = creativeElement && get(creativeElement, 'UniversalAdId');\n    var universalAdId = universalAdIdElement && getText(universalAdIdElement);\n    var linearElement = creativeElement && get(creativeElement, 'Linear');\n    var mediaFilesElement = linearElement && get(linearElement, 'MediaFiles');\n    var mediaFileElements = mediaFilesElement && getAll(mediaFilesElement, 'MediaFile');\n    if (mediaFileElements && mediaFileElements.length > 0) {\n        return mediaFileElements.map(function (mediaFileElement) {\n            var src = getText(mediaFileElement);\n            var _a = getAttributes(mediaFileElement), apiFramework = _a.apiFramework, bitrate = _a.bitrate, codec = _a.codec, delivery = _a.delivery, height = _a.height, id = _a.id, maintainAspectRatio = _a.maintainAspectRatio, maxBitrate = _a.maxBitrate, minBitrate = _a.minBitrate, scalable = _a.scalable, type = _a.type, width = _a.width;\n            return {\n                apiFramework: apiFramework,\n                bitrate: bitrate,\n                codec: codec,\n                delivery: delivery,\n                height: height,\n                id: id,\n                maintainAspectRatio: maintainAspectRatio,\n                maxBitrate: maxBitrate,\n                minBitrate: minBitrate,\n                scalable: scalable,\n                src: src,\n                type: type,\n                universalAdId: universalAdId,\n                width: width\n            };\n        });\n    }\n};\n/**\n * Gets the ad's InteractiveFiles. That were added with the `InteractiveCreativeFile` tag.\n *\n * @param ad VAST ad object.\n * @returns array of media files.\n */\nexport var getInteractiveCreativeFiles = function (ad) {\n    var creativeElement = ad && getLinearCreative(ad);\n    var linearElement = creativeElement && get(creativeElement, 'Linear');\n    var mediaFilesElement = linearElement && get(linearElement, 'MediaFiles');\n    var interactiveElements = mediaFilesElement && getAll(mediaFilesElement, 'InteractiveCreativeFile');\n    if (interactiveElements && interactiveElements.length > 0) {\n        return interactiveElements.map(function (interactiveElement) {\n            var _a = getAttributes(interactiveElement), apiFramework = _a.apiFramework, type = _a.type;\n            var src = getText(interactiveElement);\n            return {\n                apiFramework: apiFramework,\n                src: src,\n                type: type\n            };\n        });\n    }\n};\n/**\n * Gets all the ad's InteractiveFiles.\n *\n * @param ad VAST ad object.\n * @returns array of media files\n */\nexport var getInteractiveFiles = function (ad) {\n    var interactiveFiles = getInteractiveCreativeFiles(ad);\n    if (interactiveFiles) {\n        return interactiveFiles;\n    }\n    var mediaFiles = getMediaFiles(ad);\n    if (mediaFiles) {\n        interactiveFiles = mediaFiles\n            .filter(function (_a) {\n            var _b = _a.apiFramework, apiFramework = _b === void 0 ? '' : _b;\n            return (apiFramework === null || apiFramework === void 0 ? void 0 : apiFramework.toLowerCase()) === 'vpaid';\n        })\n            .map(function (_a) {\n            var apiFramework = _a.apiFramework, src = _a.src, type = _a.type;\n            return ({\n                apiFramework: apiFramework,\n                src: src,\n                type: type\n            });\n        });\n        if (interactiveFiles.length > 0) {\n            return interactiveFiles;\n        }\n    }\n};\nvar getVideoClicksElement = function (ad) {\n    var creativeElement = ad && getLinearCreative(ad);\n    var linearElement = creativeElement && get(creativeElement, 'Linear');\n    return linearElement && get(linearElement, 'VideoClicks');\n};\n/**\n * Gets the click through {@link VastMacro}.\n *\n * @param ad VAST ad object.\n * @returns clickthrough macro\n */\nexport var getClickThrough = function (ad) {\n    var videoClicksElement = getVideoClicksElement(ad);\n    var clickThroughElement = videoClicksElement && get(videoClicksElement, 'ClickThrough');\n    return clickThroughElement && getText(clickThroughElement);\n};\n/**\n * Gets the click through {@link VastMacro}.\n *\n * @param ad VAST ad object.\n * @returns click tracking macro\n */\nexport var getClickTracking = function (ad) {\n    var videoClicksElement = ad && getVideoClicksElement(ad);\n    var clickTrackingElements = videoClicksElement && getAll(videoClicksElement, 'ClickTracking');\n    if (clickTrackingElements && clickTrackingElements.length > 0) {\n        return clickTrackingElements\n            .map(function (element) { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets the custom click {@link VastMacro}.\n *\n * @param ad VAST ad object.\n * @returns click tracking macro\n */\nexport var getCustomClick = function (ad) {\n    var videoClicksElement = getVideoClicksElement(ad);\n    var customClickElements = videoClicksElement && getAll(videoClicksElement, 'CustomClick');\n    if (customClickElements && customClickElements.length > 0) {\n        return customClickElements\n            .map(function (element) { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets the skipoffset.\n *\n * @param ad VAST ad object.\n * @returns the time offset in milliseconds or a string with the percentage\n */\nexport var getSkipOffset = function (ad) {\n    var creativeElement = ad && getLinearCreative(ad);\n    var linearElement = creativeElement && get(creativeElement, 'Linear');\n    var skipoffset = linearElement && getAttribute(linearElement, 'skipoffset');\n    return skipoffset && parseOffset(skipoffset);\n};\nvar getLinearContent = function (xml) {\n    var linearRegex = /<Linear([\\s\\S]*)<\\/Linear/gm;\n    var result = linearRegex.exec(xml);\n    return result === null || result === void 0 ? void 0 : result[1];\n};\nvar getAdParametersContent = function (xml) {\n    var paramsRegex = /<AdParameters[\\s\\w=\"]*>([\\s\\S]*)<\\/AdParameters>/gm;\n    var result = paramsRegex.exec(xml);\n    return (result === null || result === void 0 ? void 0 : result[1].replace(/[\\n\\s]*<!\\[CDATA\\[[\\n\\s]*/, '').replace(/[\\n\\s]*\\]\\]>[\\n\\s]*$/, '').replace(/\\]\\]\\]\\]><!\\[CDATA\\[>/, ']]>').trim());\n};\nvar getXmlEncodedValue = function (xml) {\n    var xmlEncodedRegex = /<AdParameters[\\s]*xmlEncoded=\"(.*?)\">/gim;\n    var result = xmlEncodedRegex.exec(xml);\n    return (result === null || result === void 0 ? void 0 : result[1]) === 'true';\n};\n/**\n * Gets the creative data.\n *\n * @param xml VAST XML text.\n * @returns with `AdParameters` as they come in the XML and a flag `xmlEncoded` to indicate if the ad parameters are xml encoded.\n */\nexport var getCreativeData = function (xml) {\n    var linearContent = getLinearContent(xml);\n    var AdParameters = linearContent && getAdParametersContent(linearContent);\n    var xmlEncoded = linearContent ? getXmlEncodedValue(linearContent) : false;\n    return {\n        AdParameters: AdParameters,\n        xmlEncoded: xmlEncoded\n    };\n};\nexport { getIcons, getLinearTrackingEvents, getNonLinearTrackingEvents };\n","import parseMacro from './parseMacro';\n/**\n * Creates a tracking image with the passed URL macro.\n *\n * @param urlMacro URL Macro that need to be tracked.\n * @param data Data Object with the macros's variables.\n * @returns Image element whose source is the parsed URL Macro.\n */\nvar pixelTracker = function (urlMacro, data) {\n    var img = new Image();\n    img.src = parseMacro(urlMacro, data);\n    return img;\n};\nexport default pixelTracker;\n","var toUpperKeys = function (map) {\n    var upperKeysMap = {};\n    Object.keys(map).forEach(function (key) {\n        upperKeysMap[key.toUpperCase()] = map[key];\n    });\n    return upperKeysMap;\n};\n/**\n * Parses the passed macro with the passed data and returns the resulting parsed Macro.\n * If no CACHEBUSTING property is passed in the data it will generate a random one on its own.\n * If no TIMESTAMP property is passed in the data it will generate a one on its own.\n *\n * @param macro The string macro to be parsed.\n * @param data The data used by the macro.\n * @returns The parsed macro.\n */\nvar parseMacro = function (macro, data) {\n    if (data === void 0) { data = {}; }\n    var parsedMacro = macro;\n    var macroData = toUpperKeys(data);\n    if (!macroData.CACHEBUSTING) {\n        macroData.CACHEBUSTING = Math.round(Math.random() * 1.0e10);\n    }\n    if (!macroData.TIMESTAMP) {\n        macroData.TIMESTAMP = new Date().toISOString();\n    }\n    Object.keys(macroData).forEach(function (key) {\n        var value = encodeURIComponent(macroData[key]);\n        parsedMacro = parsedMacro.replace(\n        // eslint-disable-next-line security/detect-non-literal-regexp\n        new RegExp('\\\\[' + key + '\\\\]', 'gm'), value);\n    });\n    return parsedMacro;\n};\nexport default parseMacro;\n","import { getAdErrorURI, getVastErrorURI } from '../../vastSelectors';\nimport pixelTracker from './pixelTracker';\n/**\n * Tracks an error.\n *\n * @param vastChain the ad VAST Chain.\n * @param options Options Map\n */\nvar trackError = function (vastChain, _a) {\n    var errorCode = _a.errorCode, _b = _a.tracker, tracker = _b === void 0 ? pixelTracker : _b;\n    vastChain.forEach(function (_a) {\n        var ad = _a.ad, parsedXML = _a.parsedXML;\n        var errorURIs = (ad && getAdErrorURI(ad)) || getVastErrorURI(parsedXML);\n        if (errorURIs) {\n            errorURIs.map(function (uri) { return uri && tracker(uri, { errorCode: errorCode }); });\n        }\n    });\n};\nexport default trackError;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport pixelTracker from './pixelTracker';\nvar trackIconView = function (_vastChain, _a) {\n    var _b = _a.data, data = _b === void 0 ? {} : _b, _c = _a.tracker, tracker = _c === void 0 ? pixelTracker : _c;\n    var iconViewTracking = data.iconViewTracking;\n    if (Array.isArray(iconViewTracking)) {\n        for (var _i = 0, iconViewTracking_1 = iconViewTracking; _i < iconViewTracking_1.length; _i++) {\n            var trackUrl = iconViewTracking_1[_i];\n            tracker(trackUrl, __assign({}, data));\n        }\n    }\n};\nexport default trackIconView;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport pixelTracker from './pixelTracker';\nvar trackIconClick = function (_vastChain, _a) {\n    var _b = _a.data, data = _b === void 0 ? {} : _b, _c = _a.tracker, tracker = _c === void 0 ? pixelTracker : _c;\n    var iconClickTracking = data.iconClickTracking;\n    if (Array.isArray(iconClickTracking)) {\n        for (var _i = 0, iconClickTracking_1 = iconClickTracking; _i < iconClickTracking_1.length; _i++) {\n            var trackUrl = iconClickTracking_1[_i];\n            tracker(trackUrl, __assign({}, data));\n        }\n    }\n};\nexport default trackIconClick;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport pixelTracker from './pixelTracker';\nvar trackProgress = function (_vastChain, _a) {\n    var _b = _a.data, data = _b === void 0 ? {} : _b, _c = _a.tracker, tracker = _c === void 0 ? pixelTracker : _c;\n    var progressUri = data.progressUri;\n    if (progressUri) {\n        tracker(progressUri, __assign({}, data));\n    }\n};\nexport default trackProgress;\n","import pixelTracker from './pixelTracker';\nvar createVastEventTracker = function (trackingEventSelector) {\n    return function (vastChain, _a) {\n        var _b = _a.data, data = _b === void 0 ? {} : _b, _c = _a.tracker, tracker = _c === void 0 ? pixelTracker : _c;\n        vastChain.forEach(function (_a) {\n            var ad = _a.ad;\n            var value = ad && trackingEventSelector(ad);\n            if (!value) {\n                return;\n            }\n            if (value && typeof value === 'string') {\n                tracker(value, data);\n                return;\n            }\n            if (Array.isArray(value)) {\n                value.map(function (_a) {\n                    var uri = _a.uri;\n                    return uri && tracker(uri, data);\n                });\n            }\n        });\n    };\n};\nexport default createVastEventTracker;\n","import { get, getAll, getText, getAttributes } from '../xml';\nimport getLinearCreative from './helpers/getLinearCreative';\n/**\n * Gets the Non Linear tracking events from the Vast Ad\n *\n * @param ad VAST ad object.\n * @param eventName If provided it will filter-out the array events against it.\n * @returns Array of Tracking event definitions\n */\nvar getNonLinearTrackingEvents = function (ad, eventName) {\n    var creativeElement = ad && getLinearCreative(ad);\n    var nonLinearAdsElement = creativeElement && get(creativeElement, 'NonLinearAds');\n    var trackingEventsElement = nonLinearAdsElement && get(nonLinearAdsElement, 'TrackingEvents');\n    var trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n    if (trackingEventElements && trackingEventElements.length > 0) {\n        var trackingEvents = trackingEventElements.map(function (trackingEventElement) {\n            var event = getAttributes(trackingEventElement).event;\n            var uri = getText(trackingEventElement);\n            return {\n                event: event,\n                uri: uri\n            };\n        });\n        if (!eventName) {\n            return trackingEvents;\n        }\n        var filteredEvents = trackingEvents.filter(function (_a) {\n            var event = _a.event;\n            return event === eventName;\n        });\n        if (filteredEvents.length > 0) {\n            return filteredEvents;\n        }\n    }\n};\nexport default getNonLinearTrackingEvents;\n","/**\n * Loads the script source.\n *\n * @ignore\n * @param src The script source.\n * @param options The allowed options\n */\nvar loadScript = function (src, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.async, async = _c === void 0 ? false : _c, _d = _b.defer, defer = _d === void 0 ? false : _d, type = _b.type, placeholder = _b.placeholder;\n    if (!src) {\n        throw new TypeError('Missing required \"src\" parameter');\n    }\n    return new Promise(function (resolve, reject) {\n        var script = document.createElement('script');\n        var scriptPlaceholder = placeholder;\n        script.type = type !== null && type !== void 0 ? type : 'text/javascript';\n        script.async = async;\n        script.defer = defer;\n        script.onerror = function () {\n            return reject(new URIError(\"The script \".concat(src, \" is not accessible.\")));\n        };\n        script.onload = function () { return resolve(script); };\n        if (!scriptPlaceholder) {\n            scriptPlaceholder = (document.currentScript\n                ? /* istanbul ignore next */\n                    document.currentScript.parentNode\n                : document.head);\n        }\n        script.src = src;\n        scriptPlaceholder === null || scriptPlaceholder === void 0 ? void 0 : scriptPlaceholder.appendChild(script);\n    });\n};\nexport default loadScript;\n","var getContentDocument = function (iframeElement) {\n    return iframeElement.contentDocument ||\n        /* istanbul ignore next */\n        (iframeElement.contentWindow && iframeElement.contentWindow.document);\n};\nexport default getContentDocument;\n","var supported = 'srcdoc' in document.createElement('iframe');\nvar supportsSrcdoc = function () { return supported; };\nexport default supportsSrcdoc;\n","import getContentDocument from './getContentDocument';\nimport getOrigin from './getOrigin';\nimport supportsSrcdoc from './supportsSrcdoc';\nvar iframeContent = function (id, targetOrigin) { return \"<!DOCTYPE html>\\n<html>\\n  <head><meta charset='UTF-8'></head>\\n  <body style='margin:0;padding:0'>\\n  <script type='text/javascript'>window.parent.postMessage('\".concat(id, \"_ready', '\").concat(targetOrigin, \"');</script>\\n  </body>\\n</html>\"); };\nvar createBaseIframe = function () {\n    var iframe = document.createElement('iframe');\n    iframe.setAttribute('sandbox', 'allow-forms allow-popups allow-scripts allow-same-origin');\n    iframe.setAttribute('loading', 'eager');\n    iframe.style.margin = '0';\n    iframe.style.padding = '0';\n    iframe.style.border = 'none';\n    iframe.style.width = '0';\n    iframe.style.height = '0';\n    iframe.style.position = 'absolute';\n    return iframe;\n};\nvar createIframe = function (placeholder, id) {\n    return new Promise(function (resolve, reject) {\n        var content = iframeContent(id, getOrigin());\n        var iframe = createBaseIframe();\n        // NOTE: favor about:blank instead of srcdoc because some browsers\n        try {\n            iframe.src = 'about:blank';\n            placeholder.appendChild(iframe);\n            var contentDocument = getContentDocument(iframe);\n            if (!contentDocument) {\n                throw new TypeError('iframe content document is not a Document');\n            }\n            contentDocument.write(content);\n        }\n        catch (error) {\n            placeholder.removeChild(iframe);\n            if (supportsSrcdoc()) {\n                iframe = createBaseIframe();\n                iframe.src = 'about:srcdoc';\n                iframe.srcdoc = content;\n                placeholder.appendChild(iframe);\n            }\n            else {\n                reject(error);\n            }\n        }\n        var handleMessage = function (_a) {\n            var data = _a.data;\n            /* istanbul ignore else */\n            if (data === \"\".concat(id, \"_ready\")) {\n                window.removeEventListener('message', handleMessage);\n                resolve(iframe);\n            }\n        };\n        window.addEventListener('message', handleMessage, false);\n    });\n};\nexport default createIframe;\n","var getOrigin = function () {\n    var location = window.location;\n    /* istanbul ignore else */\n    if (location.origin) {\n        return location.origin;\n    }\n    else {\n        return (location.protocol +\n            '//' +\n            location.hostname +\n            (location.port ? ':' + location.port : ''));\n    }\n};\nexport default getOrigin;\n","var createAdContainer = function () {\n    var adContainer = document.createElement('div');\n    adContainer.classList.add('mol-video-ad-container');\n    adContainer.style.width = '100%';\n    adContainer.style.height = '100%';\n    return adContainer;\n};\nexport default createAdContainer;\n","var createAdVideoElement = function (contentDocument) {\n    if (contentDocument === void 0) { contentDocument = document; }\n    var video = contentDocument.createElement('video');\n    video.style.width = '100%';\n    video.style.height = '100%';\n    return video;\n};\nexport default createAdVideoElement;\n","var createSlot = function (placeholder, width, height) {\n    var slot = document.createElement('DIV');\n    Object.assign(slot.style, {\n        border: '0px',\n        cursor: 'pointer',\n        height: \"\".concat(height, \"px\"),\n        left: '0px',\n        margin: '0px',\n        padding: '0px',\n        position: 'absolute',\n        top: '0px',\n        width: \"\".concat(width, \"px\")\n    });\n    placeholder.appendChild(slot);\n    return slot;\n};\nexport default createSlot;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\n/**\n * Ad unit error\n */\nvar AdUnitError = /** @class */ (function (_super) {\n    __extends(AdUnitError, _super);\n    function AdUnitError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = 'AdUnitError';\n        Object.setPrototypeOf(_this, AdUnitError.prototype);\n        return _this;\n    }\n    return AdUnitError;\n}(Error));\nexport default AdUnitError;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar _a, _b;\nimport { linearEvents } from '../tracker';\nimport { getViewable } from '../vastSelectors';\nimport { finish } from './adUnitEvents';\nimport { onElementVisibilityChange, onElementResize } from './helpers/dom/elementObservers';\nimport preventManualProgress from './helpers/dom/preventManualProgress';\nimport Emitter from './helpers/Emitter';\nimport retrieveIcons from './helpers/icons/retrieveIcons';\nimport addIcons from './helpers/icons/addIcons';\nimport viewmode from './helpers/vpaid/viewmode';\nimport safeCallback from './helpers/safeCallback';\nvar start = linearEvents.start, viewable = linearEvents.viewable, notViewable = linearEvents.notViewable, viewUndetermined = linearEvents.viewUndetermined, iconClick = linearEvents.iconClick, iconView = linearEvents.iconView;\nvar _private = Symbol('_private');\nexport var _protected = Symbol('_protected');\n/**\n * This class provides shared logic among all the ad units.\n */\nvar VideoAdUnit = /** @class */ (function (_super) {\n    __extends(VideoAdUnit, _super);\n    /**\n     * Creates a {@link VideoAdUnit}.\n     *\n     * @param vastChain The {@link VastChain} with all the {@link VastResponse}\n     * @param videoAdContainer container instance to place the ad\n     * @param options Options Map. The allowed properties are:\n     */\n    function VideoAdUnit(vastChain, videoAdContainer, _c) {\n        var _d = _c === void 0 ? {} : _c, _e = _d.viewability, viewability = _e === void 0 ? false : _e, _f = _d.responsive, responsive = _f === void 0 ? false : _f, _g = _d.logger, logger = _g === void 0 ? console : _g, _h = _d.pauseOnAdClick, pauseOnAdClick = _h === void 0 ? true : _h;\n        var _this = _super.call(this, logger) || this;\n        _this[_a] = {\n            addIcons: function () {\n                if (!_this.icons) {\n                    return;\n                }\n                var _c = addIcons(_this.icons, {\n                    logger: _this.logger,\n                    onIconClick: function (icon) {\n                        return _this.emit(iconClick, {\n                            adUnit: _this,\n                            data: icon,\n                            type: iconClick\n                        });\n                    },\n                    onIconView: function (icon) {\n                        return _this.emit(iconView, {\n                            adUnit: _this,\n                            data: icon,\n                            type: iconView\n                        });\n                    },\n                    videoAdContainer: _this.videoAdContainer\n                }), drawIcons = _c.drawIcons, hasPendingIconRedraws = _c.hasPendingIconRedraws, removeIcons = _c.removeIcons;\n                _this[_protected].drawIcons = drawIcons;\n                _this[_protected].removeIcons = removeIcons;\n                _this[_protected].hasPendingIconRedraws = hasPendingIconRedraws;\n                _this[_protected].onFinishCallbacks.push(removeIcons);\n            },\n            setupViewableImpression: function () {\n                var timeoutId;\n                var unsubscribe = onElementVisibilityChange(_this.videoAdContainer.element, function (visible) {\n                    if (_this.isFinished() || _this[_protected].viewable) {\n                        return;\n                    }\n                    if (typeof visible !== 'boolean') {\n                        _this[_private].handleViewableImpression(viewUndetermined);\n                        return;\n                    }\n                    if (visible) {\n                        timeoutId = window.setTimeout(_this[_private].handleViewableImpression, 2000, viewable);\n                    }\n                    else {\n                        clearTimeout(timeoutId);\n                    }\n                }, { viewabilityOffset: 0.5 });\n                _this[_protected].onFinishCallbacks.push(function () {\n                    unsubscribe();\n                    clearTimeout(timeoutId);\n                    if (!_this[_protected].viewable) {\n                        _this[_private].handleViewableImpression(notViewable);\n                    }\n                });\n            },\n            handleViewableImpression: function (event) {\n                _this[_protected].viewable = Boolean(event);\n                _this.emit(event, {\n                    adUnit: _this,\n                    type: event\n                });\n            },\n            setupViewability: function () {\n                var unsubscribe = onElementVisibilityChange(_this.videoAdContainer.element, function (visible) {\n                    if (_this.isFinished()) {\n                        return;\n                    }\n                    if (typeof visible === 'boolean') {\n                        if (visible) {\n                            _this.resume();\n                        }\n                        else {\n                            _this.pause();\n                        }\n                    }\n                });\n                _this[_protected].onFinishCallbacks.push(unsubscribe);\n            },\n            setupResponsive: function () {\n                var element = _this.videoAdContainer.element;\n                _this[_protected].size = {\n                    height: element.clientHeight,\n                    viewmode: viewmode(element.clientWidth, element.clientHeight),\n                    width: element.clientWidth\n                };\n                var unsubscribe = onElementResize(element, function () {\n                    if (_this.isFinished()) {\n                        return;\n                    }\n                    var prevSize = _this[_protected].size;\n                    var height = element.clientHeight;\n                    var width = element.clientWidth;\n                    if (height !== (prevSize === null || prevSize === void 0 ? void 0 : prevSize.height) || width !== (prevSize === null || prevSize === void 0 ? void 0 : prevSize.width)) {\n                        _this.resize(width, height, viewmode(width, height));\n                    }\n                });\n                _this[_protected].onFinishCallbacks.push(unsubscribe);\n            }\n        };\n        _this[_b] = {\n            finished: false,\n            started: false,\n            viewable: false,\n            onErrorCallbacks: [],\n            onFinishCallbacks: [],\n            finish: function () {\n                if (!_this.isFinished()) {\n                    _this[_protected].finished = true;\n                    _this[_protected].onFinishCallbacks.forEach(function (callback) { return callback(); });\n                    _this.emit(finish, {\n                        adUnit: _this,\n                        type: finish\n                    });\n                }\n            },\n            throwIfCalled: function () {\n                throw new Error('VideoAdUnit method must be implemented on child class');\n            },\n            throwIfFinished: function () {\n                if (_this.isFinished()) {\n                    throw new Error('VideoAdUnit is finished');\n                }\n            }\n        };\n        /** Reference to the {@link VastChain} used to load the ad. */\n        _this.vastChain = vastChain;\n        /** Reference to the {@link VideoAdContainer} that contains the ad. */\n        _this.videoAdContainer = videoAdContainer;\n        /** Array of {@link VastIcon} definitions to display from the passed {@link VastChain} or undefined if there are no icons.*/\n        _this.icons = retrieveIcons(vastChain);\n        _this.pauseOnAdClick = pauseOnAdClick;\n        _this[_protected].onFinishCallbacks.push(preventManualProgress(_this.videoAdContainer.videoElement));\n        _this[_private].addIcons();\n        var viewableImpression = vastChain.some(function (_c) {\n            var ad = _c.ad;\n            return ad && getViewable(ad);\n        });\n        if (viewableImpression) {\n            _this.once(start, _this[_private].setupViewableImpression);\n        }\n        if (viewability) {\n            _this.once(start, _this[_private].setupViewability);\n        }\n        if (responsive) {\n            _this.once(start, _this[_private].setupResponsive);\n        }\n        return _this;\n    }\n    /*\n     * Starts the ad unit.\n     *\n     * @throws if called twice.\n     * @throws if ad unit is finished.\n     */\n    VideoAdUnit.prototype.start = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VideoAdUnit.prototype.resume = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VideoAdUnit.prototype.pause = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Skips the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VideoAdUnit.prototype.skip = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param volume must be a value between 0 and 1;\n     */\n    VideoAdUnit.prototype.setVolume = function (_volume) {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns the volume of the ad unit.\n     */\n    VideoAdUnit.prototype.getVolume = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n    VideoAdUnit.prototype.cancel = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the duration of the ad unit.\n     */\n    VideoAdUnit.prototype.duration = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n    VideoAdUnit.prototype.paused = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the current time of the ad unit.\n     */\n    VideoAdUnit.prototype.currentTime = function () {\n        this[_protected].throwIfCalled();\n    };\n    /**\n     * Register a callback function that will be called whenever the ad finishes. No matter if it was finished because de ad ended, or cancelled or there was an error playing the ad.\n     *\n     * @throws if ad unit is finished.\n     *\n     * @param callback will be called once the ad unit finished\n     */\n    VideoAdUnit.prototype.onFinish = function (callback) {\n        if (typeof callback !== 'function') {\n            throw new TypeError('Expected a callback function');\n        }\n        this[_protected].onFinishCallbacks.push(safeCallback(callback, this.logger));\n    };\n    /**\n     * Register a callback function that will be called if there is an error while running the ad.\n     *\n     * @throws if ad unit is finished.\n     *\n     * @param callback will be called on ad unit error passing the Error instance  and an object with the adUnit and the  {@link VastChain}.\n     */\n    VideoAdUnit.prototype.onError = function (callback) {\n        if (typeof callback !== 'function') {\n            throw new TypeError('Expected a callback function');\n        }\n        this[_protected].onErrorCallbacks.push(safeCallback(callback, this.logger));\n    };\n    /**\n     * @returns true if the ad unit is finished and false otherwise\n     */\n    VideoAdUnit.prototype.isFinished = function () {\n        return this[_protected].finished;\n    };\n    /**\n     * @returns true if the ad unit has started and false otherwise\n     */\n    VideoAdUnit.prototype.isStarted = function () {\n        return this[_protected].started;\n    };\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns Promise that resolves once the unit was resized\n     */\n    VideoAdUnit.prototype.resize = function (width, height, mode) {\n        var _c, _d, _e, _f;\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_g) {\n                switch (_g.label) {\n                    case 0:\n                        this[_protected].size = {\n                            height: height,\n                            viewmode: mode,\n                            width: width\n                        };\n                        if (!(this.isStarted() && !this.isFinished() && this.icons)) return [3 /*break*/, 3];\n                        return [4 /*yield*/, ((_d = (_c = this[_protected]).removeIcons) === null || _d === void 0 ? void 0 : _d.call(_c))];\n                    case 1:\n                        _g.sent();\n                        return [4 /*yield*/, ((_f = (_e = this[_protected]).drawIcons) === null || _f === void 0 ? void 0 : _f.call(_e))];\n                    case 2:\n                        _g.sent();\n                        _g.label = 3;\n                    case 3: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return VideoAdUnit;\n}(Emitter));\n_a = _private, _b = _protected;\nexport default VideoAdUnit;\n","var mimeMap = {\n    '3gp': 'video/3gpp',\n    avi: 'video/x-msvideo',\n    flv: 'video/x-flv',\n    m3u8: 'application/x-mpegURL',\n    m4v: 'video/mp4',\n    mov: 'video/quicktime',\n    mp4: 'video/mp4',\n    mpd: 'application/dash+xml',\n    ogv: 'video/ogg',\n    ts: 'video/MP2T',\n    webm: 'video/webm',\n    wmv: 'video/x-ms-wmv'\n};\nvar guessMimeType = function (src) {\n    var match = src.match(/\\.([^./?]+)(\\?[^/]+)?$/i);\n    var ext = match && match[1];\n    return (ext && mimeMap[ext]) || 'video/' + ext;\n};\nexport default guessMimeType;\n","import guessMimeType from './guessMimeType';\nvar canPlay = function (videoElement, mediaFile) {\n    var src = mediaFile.src, type = mediaFile.type;\n    return videoElement.canPlayType(type || guessMimeType(src || ''));\n};\nexport default canPlay;\n","var getRectParams = function (rect) {\n    var width = Number(rect.width) || 0;\n    var height = Number(rect.height) || 0;\n    // NOTE: leaving 1 digit after the decimal point to handle\n    //       approximately equal ratios, because aspect ratio\n    //       of 480p (854x480) don't strict equal to 360p (640x360)\n    var aspectRatio = height ? Math.floor((width / height) * 10) / 10 : 0;\n    return {\n        aspectRatio: aspectRatio,\n        height: height,\n        width: width\n    };\n};\nvar sortMediaByBestFit = function (mediaFiles, screenRect) {\n    var screenParams = getRectParams(screenRect);\n    var compareTo = function (mediaFileA, mediaFileB) {\n        var mediaFileAParams = getRectParams(mediaFileA);\n        var mediaFileBParams = getRectParams(mediaFileB);\n        var widthDeltaA = Math.abs(screenParams.width - mediaFileAParams.width);\n        var widthDeltaB = Math.abs(screenParams.width - mediaFileBParams.width);\n        var aspectRatioDeltaA = Math.abs(screenParams.aspectRatio - mediaFileAParams.aspectRatio);\n        var aspectRatioDeltaB = Math.abs(screenParams.aspectRatio - mediaFileBParams.aspectRatio);\n        return aspectRatioDeltaA - aspectRatioDeltaB || widthDeltaA - widthDeltaB;\n    };\n    return mediaFiles.slice(0).sort(compareTo);\n};\nexport default sortMediaByBestFit;\n","import { getMediaFiles } from '../../../vastSelectors';\nimport canPlay from './canPlay';\nimport sortMediaByBestFit from './sortMediaByBestFit';\nvar getMediaByDefaultBestFit = function (mediaFiles, screenRect) {\n    var sortedMediaFiles = sortMediaByBestFit(mediaFiles, screenRect);\n    return sortedMediaFiles[0];\n};\nvar findBestMedia = function (inlineAd, videoElement, container, _a) {\n    var _b = _a.getMediaFile, getMediaFile = _b === void 0 ? getMediaByDefaultBestFit : _b;\n    var screenRect = container.getBoundingClientRect();\n    var mediaFiles = getMediaFiles(inlineAd);\n    var supportedMediaFiles = mediaFiles === null || mediaFiles === void 0 ? void 0 : mediaFiles.filter(function (mediaFile) {\n        return canPlay(videoElement, mediaFile);\n    });\n    return supportedMediaFiles && getMediaFile(supportedMediaFiles, screenRect);\n};\nexport default findBestMedia;\n","var once = function (element, eventName, listener) {\n    var handler = function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        element.removeEventListener(eventName, handler);\n        return listener.apply(void 0, args);\n    };\n    element.addEventListener(eventName, handler);\n    return function () {\n        element.removeEventListener(eventName, handler);\n    };\n};\nexport default once;\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { getLinearTrackingEvents } from '../../../vastSelectors';\nimport { linearEvents } from '../../../tracker';\nvar progress = linearEvents.progress;\nvar getProgressEvents = function (vastChain) {\n    return vastChain\n        .map(function (_a) {\n        var ad = _a.ad;\n        return ad;\n    })\n        .reduce(function (accumulated, ad) {\n        var events = (ad && getLinearTrackingEvents(ad, progress)) || [];\n        return __spreadArray(__spreadArray([], accumulated, true), events, true);\n    }, [])\n        .map(function (_a) {\n        var offset = _a.offset, uri = _a.uri;\n        return ({\n            offset: offset,\n            uri: uri\n        });\n    });\n};\nexport default getProgressEvents;\n","var safeCallback = function (callback, logger) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        try {\n            callback.apply(void 0, args);\n        }\n        catch (error) {\n            logger === null || logger === void 0 ? void 0 : logger.error(error);\n        }\n    };\n};\nexport default safeCallback;\n","import { linearEvents } from '../../../../tracker';\nvar fullscreenElement = function () {\n    return document.fullscreenElement ||\n        document.webkitFullscreenElement ||\n        document.mozFullScreenElement ||\n        document.msFullscreenElement ||\n        null;\n};\nvar fullscreen = linearEvents.fullscreen, exitFullscreen = linearEvents.exitFullscreen, playerCollapse = linearEvents.playerCollapse, playerExpand = linearEvents.playerExpand;\nvar onFullscreenChange = function (_a, callback) {\n    var videoElement = _a.videoElement;\n    var fullscreenEvtNames = [\n        'webkitfullscreenchange',\n        'mozfullscreenchange',\n        'fullscreenchange',\n        'MSFullscreenChange'\n    ];\n    var fullscreenOn = false;\n    var fullscreenchangeHandler = function () {\n        if (fullscreenElement() === videoElement) {\n            fullscreenOn = true;\n            callback(playerExpand);\n            callback(fullscreen);\n        }\n        else if (fullscreenOn) {\n            fullscreenOn = false;\n            callback(playerCollapse);\n            callback(exitFullscreen);\n        }\n    };\n    for (var _i = 0, fullscreenEvtNames_1 = fullscreenEvtNames; _i < fullscreenEvtNames_1.length; _i++) {\n        var event_1 = fullscreenEvtNames_1[_i];\n        document.addEventListener(event_1, fullscreenchangeHandler);\n    }\n    return function () {\n        for (var _i = 0, fullscreenEvtNames_2 = fullscreenEvtNames; _i < fullscreenEvtNames_2.length; _i++) {\n            var event_2 = fullscreenEvtNames_2[_i];\n            document.removeEventListener(event_2, fullscreenchangeHandler);\n        }\n    };\n};\nexport default onFullscreenChange;\n","import { linearEvents } from '../../../../tracker';\nvar pause = linearEvents.pause, resume = linearEvents.resume;\nvar onPlayPause = function (_a, callback) {\n    var videoElement = _a.videoElement;\n    var started = false;\n    var paused = true;\n    var playHandler = function () {\n        if (!started) {\n            started = true;\n            paused = false;\n        }\n        else if (paused) {\n            paused = false;\n            callback(resume);\n        }\n    };\n    var pauseHandler = function () {\n        if (!paused) {\n            paused = true;\n            callback(pause);\n        }\n    };\n    videoElement.addEventListener('play', playHandler);\n    videoElement.addEventListener('pause', pauseHandler);\n    return function () {\n        videoElement.removeEventListener('play', playHandler);\n        videoElement.removeEventListener('pause', pauseHandler);\n    };\n};\nexport default onPlayPause;\n","import { linearEvents } from '../../../../tracker';\nvar rewind = linearEvents.rewind;\nvar onRewind = function (_a, callback) {\n    var videoElement = _a.videoElement;\n    var currentTime = videoElement.currentTime;\n    var timeupdateHandler = function () {\n        var delta = videoElement.currentTime - currentTime;\n        if (delta < 0 && Math.abs(delta) >= 1) {\n            callback(rewind);\n        }\n        currentTime = videoElement.currentTime;\n    };\n    videoElement.addEventListener('timeupdate', timeupdateHandler);\n    return function () {\n        videoElement.removeEventListener('timeupdate', timeupdateHandler);\n    };\n};\nexport default onRewind;\n","import { linearEvents } from '../../../../tracker';\nvar skip = linearEvents.skip;\nvar createDefaultSkipControl = function () {\n    var skipBtn = document.createElement('button');\n    skipBtn.classList.add('mol-vast-skip-control');\n    skipBtn.type = 'button';\n    skipBtn.innerHTML = 'skip';\n    skipBtn.style.position = 'absolute';\n    skipBtn.style.bottom = '15px';\n    skipBtn.style.right = '15px';\n    return skipBtn;\n};\nvar onSkip = function (videoAdContainer, callback, _a) {\n    var _b = _a === void 0 ? {} : _a, skipoffset = _b.skipoffset, _c = _b.createSkipControl, createSkipControl = _c === void 0 ? createDefaultSkipControl : _c;\n    if (!skipoffset) {\n        return function () { return null; };\n    }\n    var skipControl;\n    var videoElement = videoAdContainer.videoElement, element = videoAdContainer.element;\n    var skipHandler = function () {\n        var currentTimeMs = videoElement.currentTime * 1000;\n        if (!skipControl &&\n            typeof skipoffset === 'number' &&\n            currentTimeMs >= skipoffset) {\n            skipControl = createSkipControl();\n            skipControl.onclick = function (event) {\n                var _a;\n                (_a = event.stopPropagation) === null || _a === void 0 ? void 0 : _a.call(event);\n                callback(skip);\n                return false;\n            };\n            element.appendChild(skipControl);\n            videoElement.removeEventListener('timeupdate', skipHandler);\n        }\n    };\n    videoElement.addEventListener('timeupdate', skipHandler);\n    return function () {\n        videoElement.removeEventListener('timeupdate', skipHandler);\n        if (skipControl) {\n            element.removeChild(skipControl);\n        }\n    };\n};\nexport default onSkip;\n","import { linearEvents, ErrorCode } from '../../../../tracker';\nvar error = linearEvents.error;\nvar onError = function (_a, callback) {\n    var videoElement = _a.videoElement;\n    var errorHandler = function () {\n        var _a;\n        var mediaError = (_a = videoElement.error) !== null && _a !== void 0 ? _a : undefined;\n        if (mediaError) {\n            Object.defineProperty(mediaError, 'code', {\n                get: function () { return ErrorCode.VAST_PROBLEM_DISPLAYING_MEDIA_FILE; }\n            });\n        }\n        callback(error, mediaError);\n    };\n    videoElement.addEventListener('error', errorHandler);\n    return function () {\n        videoElement.removeEventListener('error', errorHandler);\n    };\n};\nexport default onError;\n","/**\n * Fires when the adUnit's volume has changed.\n *\n * @event VideoAdUnit#volumeChanged\n */\nexport var volumeChanged = 'volumeChanged';\n/**\n * Fires when the adUnit's has finished.\n *\n * @event VideoAdUnit#finish\n */\nexport var finish = 'finish';\n/**\n * fires on ad progress.\n *\n * @event VideoAdUnit#adProgress\n */\nexport var adProgress = 'adProgress';\nvar adUnitEvents = {\n    adProgress: adProgress,\n    finish: finish,\n    volumeChanged: volumeChanged\n};\nexport default adUnitEvents;\n","import { linearEvents } from '../../../../tracker';\nimport { adProgress } from '../../../adUnitEvents';\nvar complete = linearEvents.complete, firstQuartile = linearEvents.firstQuartile, midpoint = linearEvents.midpoint, start = linearEvents.start, thirdQuartile = linearEvents.thirdQuartile;\nvar percentageProgress = function (currentTime, duration) {\n    return (currentTime * 100) / duration;\n};\nvar isPassFirstQuartile = function (currentTime, duration) {\n    return percentageProgress(currentTime, duration) >= 25;\n};\nvar isPassMidPoint = function (currentTime, duration) {\n    return percentageProgress(currentTime, duration) >= 50;\n};\nvar isPassThirdQuartile = function (currentTime, duration) {\n    return percentageProgress(currentTime, duration) >= 75;\n};\nvar isCompleted = function (currentTime, duration) {\n    return percentageProgress(currentTime, duration) >= 99;\n};\n// TODO: implement logic to track `timeSpentViewing` linear event\nvar onTimeUpdate = function (_a, callback) {\n    var videoElement = _a.videoElement;\n    var started = false;\n    var passFirstQuartile = false;\n    var passMidPoint = false;\n    var passThirdQuartile = false;\n    var completed = false;\n    var events = {\n        start: {\n            isFired: function (currentTime) { return !started && currentTime > 0; },\n            callback: function () {\n                started = true;\n                callback(start);\n            }\n        },\n        firstQuartile: {\n            isFired: function (currentTime, duration) {\n                return !passFirstQuartile && isPassFirstQuartile(currentTime, duration);\n            },\n            callback: function () {\n                passFirstQuartile = true;\n                callback(firstQuartile);\n            }\n        },\n        midpoint: {\n            isFired: function (currentTime, duration) {\n                return !passMidPoint && isPassMidPoint(currentTime, duration);\n            },\n            callback: function () {\n                passMidPoint = true;\n                callback(midpoint);\n            }\n        },\n        thirdQuartile: {\n            isFired: function (currentTime, duration) {\n                return !passThirdQuartile && isPassThirdQuartile(currentTime, duration);\n            },\n            callback: function () {\n                passThirdQuartile = true;\n                callback(thirdQuartile);\n            }\n        },\n        complete: {\n            isFired: function (currentTime, duration) {\n                return !completed && isCompleted(currentTime, duration);\n            },\n            callback: function () {\n                completed = true;\n                callback(complete);\n            }\n        }\n    };\n    var timeUpdateHandler = function () {\n        var duration = videoElement.duration;\n        var currentTime = videoElement.currentTime;\n        for (var event_1 in events) {\n            if (events[event_1].isFired(currentTime, duration)) {\n                events[event_1].callback();\n                break;\n            }\n        }\n        callback(adProgress);\n    };\n    var endedHandler = function () {\n        var duration = videoElement.duration;\n        var currentTime = videoElement.currentTime;\n        if (!completed && isCompleted(currentTime, duration)) {\n            completed = true;\n            callback(complete);\n        }\n        videoElement.removeEventListener('ended', endedHandler);\n        videoElement.removeEventListener('timeupdate', timeUpdateHandler);\n    };\n    videoElement.addEventListener('timeupdate', timeUpdateHandler);\n    videoElement.addEventListener('ended', endedHandler);\n    return function () {\n        videoElement.removeEventListener('timeupdate', timeUpdateHandler);\n        videoElement.removeEventListener('ended', endedHandler);\n    };\n};\nexport default onTimeUpdate;\n","import { linearEvents } from '../../../../tracker';\nimport { volumeChanged } from '../../../adUnitEvents';\nvar mute = linearEvents.mute, unmute = linearEvents.unmute;\nvar isMuted = function (videoElement) {\n    return videoElement.muted || videoElement.volume === 0;\n};\nvar onVolumeChange = function (_a, callback) {\n    var videoElement = _a.videoElement;\n    var wasMuted = isMuted(videoElement);\n    var volumechangeHandler = function () {\n        callback(volumeChanged);\n        if (wasMuted && !isMuted(videoElement)) {\n            callback(unmute);\n        }\n        else if (!wasMuted && isMuted(videoElement)) {\n            callback(mute);\n        }\n        wasMuted = isMuted(videoElement);\n    };\n    videoElement.addEventListener('volumechange', volumechangeHandler);\n    return function () {\n        videoElement.removeEventListener('volumechange', volumechangeHandler);\n    };\n};\nexport default onVolumeChange;\n","import { linearEvents } from '../../../../tracker';\nvar impression = linearEvents.impression, creativeView = linearEvents.creativeView;\nvar onImpression = function (_a, callback) {\n    var videoElement = _a.videoElement;\n    var started = false;\n    var impressionHandler = function () {\n        var currentTime = videoElement.currentTime;\n        if (!started && currentTime > 0) {\n            started = true;\n            callback(impression);\n            callback(creativeView);\n            videoElement.removeEventListener('timeupdate', impressionHandler);\n        }\n    };\n    videoElement.addEventListener('timeupdate', impressionHandler);\n    return function () {\n        videoElement.removeEventListener('timeupdate', impressionHandler);\n    };\n};\nexport default onImpression;\n","var toFixedDigits = function (num, digits) {\n    var formattedNum = String(num);\n    while (formattedNum.length < digits) {\n        formattedNum = '0' + formattedNum;\n    }\n    return formattedNum;\n};\nexport default toFixedDigits;\n","import toFixedDigits from './toFixedDigits';\nvar formatProgress = function (progress) {\n    var hours = Math.floor(progress / (60 * 60 * 1000));\n    var minutes = Math.floor((progress / (60 * 1000)) % 60);\n    var seconds = Math.floor((progress / 1000) % 60);\n    var ms = progress % 1000;\n    return (toFixedDigits(hours, 2) +\n        ':' +\n        toFixedDigits(minutes, 2) +\n        ':' +\n        toFixedDigits(seconds, 2) +\n        '.' +\n        toFixedDigits(ms, 3));\n};\nexport default formatProgress;\n","import { linearEvents } from '../../../../tracker';\nimport formatProgress from '../../progress/formatProgress';\nvar progress = linearEvents.progress;\nvar secondsToMilliseconds = function (seconds) { return seconds * 1000; };\nvar isPercentage = function (offset) {\n    var percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n    return percentageRegex.test(offset) && !isNaN(parseFloat(offset));\n};\nvar isValid = function (_a) {\n    var offset = _a.offset, uri = _a.uri;\n    var offsetIsValid = typeof offset === 'number' || Boolean(offset && isPercentage(offset));\n    var uriIsValid = typeof uri === 'string' && uri.length > 0;\n    return offsetIsValid && uriIsValid;\n};\nvar offsetToMs = function (offset, durationInMs) {\n    if (typeof offset === 'number') {\n        return offset;\n    }\n    return (parseFloat(offset) / 100) * durationInMs;\n};\nvar onProgress = function (_a, callback, _b) {\n    var videoElement = _a.videoElement;\n    var _c = _b === void 0 ? {} : _b, _d = _c.progressEvents, progressEvents = _d === void 0 ? [] : _d;\n    var duration = videoElement.duration;\n    var durationInMs = secondsToMilliseconds(duration);\n    var playedMs = 0;\n    var previousCurrentTime = secondsToMilliseconds(videoElement.currentTime);\n    var pendingEvents = progressEvents\n        .filter(isValid)\n        .map(function (_a) {\n        var offset = _a.offset, uri = _a.uri;\n        return ({\n            offset: offsetToMs(offset, durationInMs),\n            uri: uri\n        });\n    });\n    var progressHandler = function () {\n        var currentTime = videoElement.currentTime;\n        var delta = Math.abs(currentTime - previousCurrentTime);\n        playedMs += secondsToMilliseconds(delta);\n        previousCurrentTime = currentTime;\n        var _a = pendingEvents.reduce(function (accumulator, event) {\n            var offset = event.offset;\n            if (typeof offset === 'number' && playedMs >= offset) {\n                accumulator.toCall.push(event);\n            }\n            else {\n                accumulator.stillPending.push(event);\n            }\n            return accumulator;\n        }, {\n            stillPending: [],\n            toCall: []\n        }), stillPending = _a.stillPending, toCall = _a.toCall;\n        pendingEvents = stillPending;\n        toCall.forEach(function (_a) {\n            var uri = _a.uri;\n            callback(progress, {\n                contentplayhead: formatProgress(playedMs),\n                progressUri: uri\n            });\n        });\n        if (pendingEvents.length === 0) {\n            videoElement.removeEventListener('timeupdate', progressHandler);\n        }\n    };\n    if (pendingEvents.length > 0) {\n        videoElement.addEventListener('timeupdate', progressHandler);\n    }\n    return function () {\n        videoElement.removeEventListener('timeupdate', progressHandler);\n    };\n};\nexport default onProgress;\n","import { linearEvents } from '../../../../tracker';\nvar clickThrough = linearEvents.clickThrough;\nvar createDefaultClickControl = function () {\n    var anchor = document.createElement('a');\n    anchor.classList.add('mol-vast-clickthrough');\n    anchor.style.width = '100%';\n    anchor.style.height = '100%';\n    anchor.style.position = 'absolute';\n    anchor.style.left = '0';\n    anchor.style.top = '0';\n    return anchor;\n};\nvar onClickThrough = function (_a, callback, _b) {\n    var videoElement = _a.videoElement, element = _a.element;\n    var _c = _b === void 0 ? {} : _b, clickThroughUrl = _c.clickThroughUrl, _d = _c.pauseOnAdClick, pauseOnAdClick = _d === void 0 ? true : _d, _e = _c.createClickControl, createClickControl = _e === void 0 ? createDefaultClickControl : _e;\n    var placeholder = element || videoElement.parentNode;\n    var anchor = createClickControl();\n    var isVirtual = !document.body.contains(anchor);\n    if (isVirtual) {\n        placeholder.appendChild(anchor);\n    }\n    if (clickThroughUrl && anchor instanceof HTMLAnchorElement) {\n        anchor.href = clickThroughUrl;\n        anchor.target = '_blank';\n    }\n    anchor.onclick = function (event) {\n        event.stopPropagation();\n        if (videoElement.paused && pauseOnAdClick) {\n            event.preventDefault();\n            videoElement.play();\n        }\n        else {\n            if (pauseOnAdClick) {\n                videoElement.pause();\n            }\n            callback(clickThrough);\n        }\n    };\n    return function () {\n        if (isVirtual) {\n            placeholder.removeChild(anchor);\n        }\n    };\n};\nexport default onClickThrough;\n","import onFullscreenChange from './onFullscreenChange';\nimport onPlayPause from './onPlayPause';\nimport onRewind from './onRewind';\nimport onSkip from './onSkip';\nimport onError from './onError';\nimport onTimeUpdate from './onTimeUpdate';\nimport onVolumeChange from './onVolumeChange';\nimport onImpression from './onImpression';\nimport onProgress from './onProgress';\nimport onClickThrough from './onClickThrough';\nvar handlers = [\n    onClickThrough,\n    onError,\n    onFullscreenChange,\n    onImpression,\n    onPlayPause,\n    onProgress,\n    onRewind,\n    onSkip,\n    onTimeUpdate,\n    onVolumeChange\n];\nexport default handlers;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nimport { getClickThrough, getSkipOffset } from '../../../vastSelectors';\nimport getProgressEvents from '../progress/getProgressEvents';\nimport safeCallback from '../safeCallback';\nimport metricHandlers from './handlers';\nvar setupMetricHandlers = function (_a, callback) {\n    var vastChain = _a.vastChain, videoAdContainer = _a.videoAdContainer, hooks = _a.hooks, pauseOnAdClick = _a.pauseOnAdClick;\n    var inlineAd = vastChain[0].ad;\n    var skipoffset = inlineAd && getSkipOffset(inlineAd);\n    var clickThroughUrl = inlineAd && getClickThrough(inlineAd);\n    var progressEvents = getProgressEvents(vastChain);\n    var data = __assign({ clickThroughUrl: clickThroughUrl, pauseOnAdClick: pauseOnAdClick, progressEvents: progressEvents, skipoffset: skipoffset }, hooks);\n    var stopHandlersFns = metricHandlers.map(function (handler) {\n        return safeCallback(handler(videoAdContainer, callback, data));\n    });\n    return function () { return stopHandlersFns.forEach(function (disconnect) { return disconnect(); }); };\n};\nexport default setupMetricHandlers;\n","export default window.MutationObserver ||\n    window.WebKitMutationObserver ||\n    window.MozMutationObserver;\n","import debounce from 'lodash.debounce';\nimport MutationObserver from './helpers/MutationObserver';\nvar validate = function (target, callback) {\n    if (!(target instanceof Element)) {\n        throw new TypeError('Target is not an Element node');\n    }\n    if (!(callback instanceof Function)) {\n        throw new TypeError('Callback is not a function');\n    }\n};\nvar noop = function () { };\nvar sizeMutationAttrs = ['style', 'clientWidth', 'clientHeight'];\nvar createResizeMO = function (target, callback) {\n    var observer = new MutationObserver(function (mutations) {\n        for (var index = 0; index < mutations.length; index++) {\n            var attributeName = mutations[index].attributeName;\n            if (attributeName && sizeMutationAttrs.includes(attributeName)) {\n                callback();\n            }\n        }\n    });\n    observer.observe(target, {\n        attributes: true,\n        characterData: false,\n        childList: true\n    });\n    return observer;\n};\nvar mutationHandlers = Symbol('mutationHandlers');\nvar observerKey = Symbol('mutationObserver');\nvar onMutation = function (target, callback) {\n    var _a;\n    if (!target[mutationHandlers]) {\n        target[mutationHandlers] = [];\n        var execHandlers = function () {\n            var _a;\n            (_a = target[mutationHandlers]) === null || _a === void 0 ? void 0 : _a.forEach(function (handler) { return handler(); });\n        };\n        target[observerKey] = createResizeMO(target, execHandlers);\n    }\n    (_a = target[mutationHandlers]) === null || _a === void 0 ? void 0 : _a.push(callback);\n    return function () {\n        var _a, _b, _c;\n        target[mutationHandlers] = (_a = target[mutationHandlers]) === null || _a === void 0 ? void 0 : _a.filter(function (handler) { return handler !== callback; });\n        if (((_b = target[mutationHandlers]) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n            (_c = target[observerKey]) === null || _c === void 0 ? void 0 : _c.disconnect();\n            delete target[mutationHandlers];\n            delete target[observerKey];\n        }\n    };\n};\nvar createResizeElement = function (callback) {\n    var iframe = document.createElement('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; border: 0; overflow: hidden; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('type', 'text/html');\n    iframe.setAttribute('loading', 'eager');\n    iframe.onload = function () {\n        if (iframe.contentWindow) {\n            iframe.contentWindow.addEventListener('resize', callback);\n        }\n    };\n    iframe.src = 'about:blank';\n    return iframe;\n};\nvar resizeHandlers = Symbol('resizeHandlers');\nvar resizeElement = Symbol('resizeElement');\n// Original code http://www.backalleycoder.com/2013/03/18/cross-browser-event-based-element-resize-detection/\nvar onResize = function (target, callback) {\n    var _a;\n    if (!target[resizeHandlers]) {\n        target[resizeHandlers] = [];\n        var execHandlers = function () {\n            var _a;\n            (_a = target[resizeHandlers]) === null || _a === void 0 ? void 0 : _a.forEach(function (handler) { return handler(); });\n        };\n        target[resizeElement] = createResizeElement(execHandlers);\n        if (getComputedStyle(target).position === 'static') {\n            target.style.position = 'relative';\n        }\n        target.appendChild(target[resizeElement]);\n    }\n    (_a = target[resizeHandlers]) === null || _a === void 0 ? void 0 : _a.push(callback);\n    return function () {\n        var _a, _b;\n        target[resizeHandlers] = (_a = target[resizeHandlers]) === null || _a === void 0 ? void 0 : _a.filter(function (handler) { return handler !== callback; });\n        if (((_b = target[resizeHandlers]) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n            target.removeChild(target[resizeElement]);\n            delete target[resizeHandlers];\n            delete target[resizeElement];\n        }\n    };\n};\n/**\n * Helper function to know if an element has been resized.\n *\n * @ignore\n *\n * @param target The element that we want to observe.\n * @param callback The callback that handles the resize.\n * @param options Options Map.\n *\n * @returns Unsubscribe function.\n */\nvar onElementResize = function (target, callback, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.threshold, threshold = _c === void 0 ? 20 : _c;\n    validate(target, callback);\n    var makeSizeId = function (_a) {\n        var style = _a.style, clientHeight = _a.clientHeight, clientWidth = _a.clientWidth;\n        return [style.width, style.height, clientWidth, clientHeight].join('.');\n    };\n    var lastSize = makeSizeId(target);\n    var checkElementSize = function () {\n        var currentSize = makeSizeId(target);\n        if (currentSize !== lastSize) {\n            lastSize = currentSize;\n            callback();\n        }\n    };\n    var checkElementHandler = debounce(checkElementSize, threshold);\n    var stopObservingMutations = MutationObserver\n        ? onMutation(target, checkElementHandler)\n        : noop;\n    var stopListeningToResize = onResize(target, checkElementHandler);\n    return function () {\n        stopObservingMutations();\n        stopListeningToResize();\n    };\n};\nexport default onElementResize;\n","export default window.IntersectionObserver;\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport debounce from 'lodash.debounce';\nimport IntersectionObserver from './helpers/IntersectionObserver';\nvar validate = function (target, callback) {\n    if (!(target instanceof Element)) {\n        throw new TypeError('Target is not an Element node');\n    }\n    if (!(callback instanceof Function)) {\n        throw new TypeError('Callback is not a function');\n    }\n};\nvar noop = function () { };\nvar intersectionHandlers = Symbol('intersectionHandlers');\nvar observerKey = Symbol('intersectionObserver');\nvar onIntersection = function (target, callback) {\n    var _a, _b;\n    if (!target[intersectionHandlers]) {\n        target[intersectionHandlers] = [];\n        var execHandlers = function (entries, observer) {\n            var _a;\n            (_a = target[intersectionHandlers]) === null || _a === void 0 ? void 0 : _a.forEach(function (handler) {\n                return handler(entries, observer);\n            });\n        };\n        var options = {\n            root: null,\n            rootMargin: '0px',\n            threshold: __spreadArray([], new Array(11), true).map(function (_item, index) { return index / 10; })\n        };\n        target[observerKey] = new IntersectionObserver(execHandlers, options);\n        (_a = target[observerKey]) === null || _a === void 0 ? void 0 : _a.observe(target);\n    }\n    (_b = target[intersectionHandlers]) === null || _b === void 0 ? void 0 : _b.push(callback);\n    return function () {\n        var _a, _b, _c;\n        target[intersectionHandlers] = (_a = target[intersectionHandlers]) === null || _a === void 0 ? void 0 : _a.filter(function (handler) { return handler !== callback; });\n        if (((_b = target[intersectionHandlers]) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n            (_c = target[observerKey]) === null || _c === void 0 ? void 0 : _c.disconnect();\n            delete target[intersectionHandlers];\n            delete target[observerKey];\n        }\n    };\n};\nvar visibilityHandlers = [];\nvar onVisibilityChange = function (_target, callback) {\n    var execHandlers = function () {\n        if (visibilityHandlers) {\n            visibilityHandlers.forEach(function (handler) { return handler(); });\n        }\n    };\n    visibilityHandlers.push(callback);\n    if (visibilityHandlers.length === 1) {\n        document.addEventListener('visibilitychange', execHandlers);\n    }\n    return function () {\n        visibilityHandlers = visibilityHandlers.filter(function (handler) { return handler !== callback; });\n        if (visibilityHandlers.length === 0) {\n            document.removeEventListener('visibilitychange', execHandlers);\n        }\n    };\n};\nvar lastIntersectionEntries = [];\n/**\n * Helper function to know if the visibility of an element has changed.\n *\n * @ignore\n *\n * @param target The element that we want to observe.\n * @param callback The callback that handles the visibility change.\n * @param options Options Map.\n *\n * @returns Unsubscribe function.\n */\nvar onElementVisibilityChange = function (target, callback, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.threshold, threshold = _c === void 0 ? 100 : _c, _d = _b.viewabilityOffset, viewabilityOffset = _d === void 0 ? 0.4 : _d;\n    validate(target, callback);\n    if (!IntersectionObserver) {\n        // NOTE: visibility is not determined\n        callback(undefined);\n        return noop;\n    }\n    var lastIsInViewport = false;\n    var checkVisibility = function (entries) {\n        entries.forEach(function (entry) {\n            if (entry.target === target) {\n                var isInViewport = !document.hidden && entry.intersectionRatio > viewabilityOffset;\n                if (isInViewport !== lastIsInViewport) {\n                    lastIsInViewport = isInViewport;\n                    callback(isInViewport);\n                }\n            }\n        });\n        lastIntersectionEntries = entries;\n    };\n    var visibilityHandler = debounce(checkVisibility, threshold);\n    var stopObservingIntersection = onIntersection(target, visibilityHandler);\n    var stopListeningToVisibilityChange = onVisibilityChange(target, function () {\n        return visibilityHandler(lastIntersectionEntries);\n    });\n    return function () {\n        stopObservingIntersection();\n        stopListeningToVisibilityChange();\n    };\n};\nexport default onElementVisibilityChange;\n","/**\n * Subset of node's [Emitter class](https://nodejs.org/api/events.html#events_class_eventemitter)\n *\n * @param logger Optional logger instance. Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n */\nvar Emitter = /** @class */ (function () {\n    function Emitter(logger) {\n        this.events = {};\n        this.logger = logger || console;\n    }\n    /**\n     * Adds the listener function to the end of the listeners array for the event named eventName.\n     *\n     * @param eventName The name of the event.\n     * @param listener Listener fn that handles the evt.\n     * @returns The Emitter instance.\n     */\n    Emitter.prototype.on = function (eventName, listener) {\n        var events = this.events;\n        var eventListeners = events[eventName] || (events[eventName] = []);\n        eventListeners.push(listener);\n        return this;\n    };\n    /**\n     * Removes the specified listener from the listener array for the event named eventName.\n     *\n     * @param eventName The name of the event.\n     * @param listener Listener fn that handles the evt.\n     * @returns The Emitter instance.\n     */\n    Emitter.prototype.removeListener = function (eventName, listener) {\n        var events = this.events;\n        var eventListeners = events[eventName] || (events[eventName] = []);\n        events[eventName] = eventListeners.filter(function (eListener) { return eListener !== listener && eListener._ !== listener; });\n        return this;\n    };\n    /**\n     * Removes all listeners, or those of the specified eventName.\n     *\n     * @param eventName The name of the event. Optional if omitted all listeners will be removed.\n     * @returns The Emitter instance.\n     */\n    Emitter.prototype.removeAllListeners = function (eventName) {\n        if (eventName) {\n            delete this.events[eventName];\n        }\n        else {\n            this.events = {};\n        }\n        return this;\n    };\n    /**\n     * Adds a one time listener function for the event named eventName. The next time eventName is triggered,\n     * this listener is removed and then invoked.\n     *\n     * @param eventName The name of the event.\n     * @param listener Listener fn that handles the evt.\n     * @returns The Emitter instance.\n     */\n    Emitter.prototype.once = function (eventName, listener) {\n        var _this = this;\n        var handler = function () {\n            var args = [];\n            for (var _i = 0; _i < arguments.length; _i++) {\n                args[_i] = arguments[_i];\n            }\n            _this.removeListener(eventName, handler);\n            listener.apply(void 0, args);\n        };\n        handler._ = listener;\n        return this.on(eventName, handler);\n    };\n    /**\n     * Synchronously calls each of the listeners registered for the event named eventName, in the order they were registered,\n     * passing the supplied arguments to each.\n     *\n     * @param eventName The name of the event.\n     * @returns Returns true if the event had listeners, false otherwise.\n     */\n    Emitter.prototype.emit = function (eventName) {\n        var _this = this;\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        var events = this.events;\n        var eventListeners = events[eventName] || (events[eventName] = []);\n        var hasListeners = eventListeners.length > 0;\n        eventListeners.forEach(function (handler) {\n            try {\n                handler.apply(void 0, args);\n            }\n            catch (error) {\n                if (error instanceof Error) {\n                    _this.logger.error(error, error.stack);\n                }\n            }\n        });\n        return hasListeners;\n    };\n    return Emitter;\n}());\nexport default Emitter;\n","var getResource = function (_a) {\n    var _b = _a === void 0 ? {} : _a, staticResource = _b.staticResource, htmlResource = _b.htmlResource, iFrameResource = _b.iFrameResource;\n    return staticResource || htmlResource || iFrameResource || undefined;\n};\nexport default getResource;\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { getIcons } from '../../../vastSelectors';\nimport getResource from '../resources/getResource';\nvar UNKNOWN = 'UNKNOWN';\nvar uniqBy = function (array, uniqValue) {\n    var seen = {};\n    return array.filter(function (item) {\n        var key = uniqValue(item);\n        if (!key || seen.hasOwnProperty(key)) {\n            return false;\n        }\n        seen[key] = true;\n        return true;\n    });\n};\nvar uniqByResource = function (icons) {\n    return uniqBy(icons, getResource);\n};\nvar groupIconsByProgram = function (icons) {\n    return icons.reduce(function (accumulator, icon) {\n        var _a, _b;\n        var program = (_a = icon.program) !== null && _a !== void 0 ? _a : UNKNOWN;\n        (_b = accumulator[program]) !== null && _b !== void 0 ? _b : (accumulator[program] = []);\n        accumulator[program].push(icon);\n        return accumulator;\n    }, {});\n};\nvar sortIconByBestPxratio = function (icons) {\n    var devicePixelRatio = window.devicePixelRatio || 0;\n    var compareTo = function (iconA, iconB) {\n        var deltaA = Math.abs(devicePixelRatio - (iconA.pxratio || 0));\n        var deltaB = Math.abs(devicePixelRatio - (iconB.pxratio || 0));\n        return deltaA - deltaB;\n    };\n    return icons.slice(0).sort(compareTo);\n};\nvar chooseByPxRatio = function (icons) {\n    if (icons.length === 1) {\n        return icons[0];\n    }\n    return sortIconByBestPxratio(icons)[0];\n};\nvar chooseIcons = function (icons) {\n    var byProgram = groupIconsByProgram(icons);\n    var programs = Object.keys(byProgram);\n    return programs.reduce(function (accumulator, program) {\n        if (program === UNKNOWN) {\n            return __spreadArray(__spreadArray([], accumulator, true), byProgram[UNKNOWN], true);\n        }\n        return __spreadArray(__spreadArray([], accumulator, true), [chooseByPxRatio(byProgram[program])], false);\n    }, []);\n};\nvar retrieveIcons = function (vastChain) {\n    var ads = vastChain.map(function (_a) {\n        var ad = _a.ad;\n        return ad;\n    }).filter(Boolean);\n    var icons = ads.reduce(function (accumulator, ad) { return __spreadArray(__spreadArray([], accumulator, true), (getIcons(ad) || []), true); }, []);\n    if (icons.length > 0) {\n        var uniqIcons = uniqByResource(icons);\n        return chooseIcons(uniqIcons);\n    }\n};\nexport default retrieveIcons;\n","import once from './once';\nvar waitFor = function (element, event) {\n    var pending = true;\n    var resolvePromise;\n    var rejectPromise;\n    var promise = new Promise(function (resolve, reject) {\n        resolvePromise = resolve;\n        rejectPromise = reject;\n    });\n    var cancelOnce = once(element, event, function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        pending = false;\n        resolvePromise(args);\n    });\n    var cancel = function () {\n        if (pending) {\n            pending = false;\n            cancelOnce();\n            rejectPromise(new Error('waitFor was canceled'));\n        }\n    };\n    return {\n        cancel: cancel,\n        promise: promise\n    };\n};\nexport default waitFor;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar FetchError = /** @class */ (function (_super) {\n    __extends(FetchError, _super);\n    function FetchError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = 'FetchError';\n        Object.setPrototypeOf(_this, FetchError.prototype);\n        return _this;\n    }\n    return FetchError;\n}(Error));\nvar isValidContentType = function (contentType) {\n    var normalisedCT = contentType.toLowerCase();\n    return ['text/plain', 'text/html'].some(function (allowedType) {\n        return normalisedCT.includes(allowedType);\n    });\n};\nvar fetchHtml = function (endpoint) { return __awaiter(void 0, void 0, void 0, function () {\n    var response, contentType, error, error;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0: return [4 /*yield*/, fetch(endpoint)];\n            case 1:\n                response = _a.sent();\n                contentType = response.headers.get('Content-Type');\n                if (response.status >= 400) {\n                    error = new FetchError(response.statusText);\n                    error.response = response;\n                    throw error;\n                }\n                if (!contentType || !isValidContentType(contentType)) {\n                    error = new FetchError(\"fetchHtml error, invalid Content-Type \".concat(contentType));\n                    error.response = response;\n                    throw error;\n                }\n                return [2 /*return*/, response.text()];\n        }\n    });\n}); };\nexport default fetchHtml;\n","import createHtmlResource from './createHtmlResource';\nimport createIframeResource from './createIframeResource';\nimport createStaticResource from './createStaticResource';\nvar noopResource = document.createElement('div');\nvar createResource = function (document, data) {\n    var staticResource = data.staticResource, htmlResource = data.htmlResource, iFrameResource = data.iFrameResource;\n    if (staticResource) {\n        return createStaticResource(staticResource, {\n            data: data,\n            document: document\n        });\n    }\n    if (htmlResource) {\n        return createHtmlResource(htmlResource, {\n            data: data,\n            document: document\n        });\n    }\n    if (iFrameResource) {\n        return createIframeResource(iFrameResource, {\n            data: data,\n            document: document\n        });\n    }\n    return noopResource;\n};\nexport default createResource;\n","var createStaticResource = function (src, _a) {\n    var document = _a.document, data = _a.data;\n    var height = data.height, width = data.width;\n    var image = document.createElement('img');\n    if (width) {\n        image.width = width;\n    }\n    if (height) {\n        image.height = height;\n    }\n    image.src = src;\n    return image;\n};\nexport default createStaticResource;\n","import fetchHtml from '../fetch/fetchHtml';\nvar createHtmlResource = function (src, _a) {\n    var document = _a.document, data = _a.data;\n    var height = data.height, width = data.width;\n    var divElement = document.createElement('div');\n    if (width) {\n        divElement.style.width = \"\".concat(width, \"px\");\n    }\n    if (height) {\n        divElement.style.height = \"\".concat(height, \"px\");\n    }\n    fetchHtml(src)\n        .then(function (html) {\n        divElement.innerHTML = html;\n        divElement.dispatchEvent(new CustomEvent('load'));\n    })\n        .catch(function () {\n        divElement.dispatchEvent(new CustomEvent('error'));\n    });\n    return divElement;\n};\nexport default createHtmlResource;\n","var createIframeResource = function (src, _a) {\n    var document = _a.document, data = _a.data;\n    var height = data.height, width = data.width;\n    var iframeElement = document.createElement('iframe');\n    iframeElement.setAttribute('sandbox', 'allow-forms allow-popups allow-scripts');\n    iframeElement.setAttribute('loading', 'eager');\n    if (width) {\n        iframeElement.width = width.toString();\n    }\n    if (height) {\n        iframeElement.height = height.toString();\n    }\n    iframeElement.src = src;\n    iframeElement.frameBorder = '0';\n    iframeElement.style.border = 'none';\n    return iframeElement;\n};\nexport default createIframeResource;\n","import waitFor from '../dom/waitFor';\nimport createResource from './createResource';\nvar noop = function () { };\nvar loadResource = function (icon, _a) {\n    var document = _a.document, placeholder = _a.placeholder;\n    return new Promise(function (resolve, reject) {\n        try {\n            var resourceElement_1 = createResource(document, icon);\n            var resourceErrorWait_1 = waitFor(resourceElement_1, 'error');\n            var resourceLoadWait_1 = waitFor(resourceElement_1, 'load');\n            var cleanUp_1 = function () {\n                if (placeholder.contains(resourceElement_1)) {\n                    placeholder.removeChild(resourceElement_1);\n                    resourceElement_1.style.zIndex = '0';\n                }\n            };\n            resourceErrorWait_1.promise\n                .then(function () {\n                resourceLoadWait_1.cancel();\n                cleanUp_1();\n                reject(new Error('Error loading resource'));\n            })\n                .catch(noop);\n            resourceLoadWait_1.promise\n                .then(function () {\n                resourceErrorWait_1.cancel();\n                cleanUp_1();\n                resolve(resourceElement_1);\n            })\n                .catch(noop);\n            // Some browsers will not load the resource if they are not added to the DOM\n            resourceElement_1.style.zIndex = '-9999';\n            placeholder.appendChild(resourceElement_1);\n        }\n        catch (error) {\n            reject(error);\n        }\n    });\n};\nexport default loadResource;\n","var calculateArea = function (_a) {\n    var height = _a.height, width = _a.width;\n    return height * width;\n};\nexport var hasSpace = function (newIcon, config) {\n    var drawnIcons = config.drawnIcons, placeholder = config.placeholder;\n    var placeholderArea = calculateArea(placeholder.getBoundingClientRect());\n    var iconArea = calculateArea(newIcon);\n    var usedIconsArea = drawnIcons.reduce(function (accumulator, icon) {\n        var width = icon.width, height = icon.height;\n        if (!width || !height) {\n            return accumulator;\n        }\n        return accumulator + calculateArea({ width: width, height: height });\n    }, 0);\n    return iconArea + usedIconsArea <= placeholderArea * 0.35;\n};\nexport var withinBoundaries = function (newIcon, _a) {\n    var placeholder = _a.placeholder;\n    var phRect = placeholder.getBoundingClientRect();\n    return (newIcon.left >= 0 &&\n        newIcon.left + newIcon.width <= phRect.width &&\n        newIcon.top >= 0 &&\n        newIcon.top + newIcon.height <= phRect.height);\n};\nvar right = function (_a) {\n    var left = _a.left, width = _a.width;\n    return left + width;\n};\nvar left = function (_a) {\n    var left = _a.left;\n    return left;\n};\nvar top = function (_a) {\n    var top = _a.top;\n    return top;\n};\nvar bottom = function (_a) {\n    var top = _a.top, height = _a.height;\n    return top + height;\n};\nvar overlap = function (newIcon, drawnIcon) {\n    return left(newIcon) <= right(drawnIcon) &&\n        right(newIcon) >= left(drawnIcon) &&\n        bottom(newIcon) >= top(drawnIcon) &&\n        top(newIcon) <= bottom(drawnIcon);\n};\nexport var withoutOverlaps = function (newIcon, _a) {\n    var drawnIcons = _a.drawnIcons;\n    return !drawnIcons.some(function (drawnIcon) { return overlap(newIcon, drawnIcon); });\n};\nvar canBeRendered = function (newIcon, config) {\n    var thereIsSpace = hasSpace(newIcon, config);\n    var isWithinTheContentArea = withinBoundaries(newIcon, config);\n    var doesNotOverlap = withoutOverlaps(newIcon, config);\n    return thereIsSpace && isWithinTheContentArea && doesNotOverlap;\n};\nexport default canBeRendered;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport loadResource from '../resources/loadResource';\nimport updateIcon from './updateIcon';\nimport canBeRendered from './canBeRendered';\nvar noop = function () { };\nvar wrapWithClickThrough = function (iconElement, icon, _a) {\n    var _b = _a === void 0 ? {} : _a, _c = _b.onIconClick, onIconClick = _c === void 0 ? noop : _c;\n    var anchor = document.createElement('a');\n    if (icon.iconClickThrough) {\n        anchor.href = icon.iconClickThrough;\n        anchor.target = '_blank';\n    }\n    // NOTE: if iframe icon disable pointer events so that clickThrough and click tracking work\n    if (icon.iFrameResource) {\n        iconElement.style.pointerEvents = 'none';\n    }\n    anchor.onclick = function (event) {\n        if (Event.prototype.stopPropagation !== undefined) {\n            event.stopPropagation();\n        }\n        onIconClick(icon);\n    };\n    anchor.appendChild(iconElement);\n    return anchor;\n};\nvar createIcon = function (icon, options) { return __awaiter(void 0, void 0, void 0, function () {\n    var iconResource;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                if (!!icon.element) return [3 /*break*/, 2];\n                return [4 /*yield*/, loadResource(icon, options)];\n            case 1:\n                iconResource = _a.sent();\n                if (iconResource instanceof HTMLIFrameElement ||\n                    iconResource instanceof HTMLImageElement) {\n                    iconResource.width = '100%';\n                    iconResource.height = '100%';\n                }\n                iconResource.style.height = '100%';\n                iconResource.style.width = '100%';\n                icon.element = wrapWithClickThrough(iconResource, icon, options);\n                _a.label = 2;\n            case 2: return [2 /*return*/, icon.element];\n        }\n    });\n}); };\nvar updateIconElement = function (iconElement, icon) {\n    var height = icon.height, width = icon.width, left = icon.left, top = icon.top, yPosition = icon.yPosition;\n    iconElement.style.position = 'absolute';\n    iconElement.style.left = \"\".concat(left, \"px\");\n    // NOTE: This if is a bit odd but some browser don't calculate the placeholder height pixel perfect and,\n    //       setting the top of the icon will change the size of the icon's placeholder this if prevents that situation\n    if (yPosition === 'bottom') {\n        iconElement.style.bottom = '0';\n    }\n    else {\n        iconElement.style.top = \"\".concat(top, \"px\");\n    }\n    iconElement.style.height = \"\".concat(height, \"px\");\n    iconElement.style.width = \"\".concat(width, \"px\");\n    return iconElement;\n};\nvar renderIcon = function (icon, config) { return __awaiter(void 0, void 0, void 0, function () {\n    var placeholder, iconElement, updatedIcon;\n    var _a;\n    return __generator(this, function (_b) {\n        switch (_b.label) {\n            case 0:\n                placeholder = config.placeholder;\n                return [4 /*yield*/, createIcon(icon, config)];\n            case 1:\n                iconElement = _b.sent();\n                updatedIcon = updateIcon(icon, iconElement, config);\n                if (canBeRendered(updatedIcon, config)) {\n                    if (!iconElement.parentNode || updatedIcon.updated) {\n                        placeholder.appendChild(updateIconElement(iconElement, updatedIcon));\n                    }\n                }\n                else {\n                    (_a = iconElement.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(iconElement);\n                    throw new Error(\"Icon can't be rendered\");\n                }\n                return [2 /*return*/, updatedIcon];\n        }\n    });\n}); };\nexport default renderIcon;\n","var isCustomXposition = function (xPosition) {\n    return !['left', 'right'].includes(String(xPosition).toLowerCase());\n};\nvar isCustomYPosition = function (yPosition) {\n    return !['top', 'bottom'].includes(String(yPosition).toLowerCase());\n};\nvar calculateIconLeft = function (dynamicPos, iconWidth, drawnIcons, phWidth) {\n    var drawnIconsWidth = drawnIcons.reduce(function (accumulator, icon) { return accumulator + (icon.width ? icon.width + 1 : 0); }, 0);\n    if (dynamicPos === 'left') {\n        return drawnIconsWidth;\n    }\n    return phWidth - drawnIconsWidth - iconWidth;\n};\nvar calculateIconTop = function (dynamicPos, iconHeight, phHeight) {\n    if (dynamicPos === 'top') {\n        return 0;\n    }\n    return phHeight - iconHeight;\n};\nvar updateIcon = function (icon, iconElement, _a) {\n    var drawnIcons = _a.drawnIcons, placeholder = _a.placeholder;\n    var oldSignature = icon.signature;\n    var rect = iconElement.getBoundingClientRect();\n    var phRect = placeholder.getBoundingClientRect();\n    var width = icon.width || rect.width;\n    var height = icon.height || rect.height;\n    var xPosition = icon.xPosition || 'right';\n    var yPosition = icon.yPosition || 'top';\n    var left;\n    var top;\n    if (isCustomXposition(xPosition)) {\n        left = xPosition;\n    }\n    else {\n        var icons = drawnIcons.filter(function (dIcon) { return dIcon.xPosition === xPosition && dIcon.yPosition === yPosition; });\n        left = calculateIconLeft(xPosition, width, icons, phRect.width);\n    }\n    if (isCustomYPosition(yPosition)) {\n        top = yPosition;\n    }\n    else {\n        top = calculateIconTop(yPosition, height, phRect.height);\n    }\n    var signature = \"\".concat(left, \"-\").concat(top, \"_\").concat(width, \"x\").concat(height);\n    return Object.assign(icon, {\n        height: height,\n        left: left,\n        signature: signature,\n        top: top,\n        updated: oldSignature !== signature,\n        width: width\n    });\n};\nexport default updateIcon;\n","import renderIcon from './renderIcon';\nimport canBeShown from './canBeShown';\nvar renderIcons = function (icons, _a) {\n    var onIconClick = _a.onIconClick, videoAdContainer = _a.videoAdContainer, _b = _a.logger, logger = _b === void 0 ? console : _b;\n    var element = videoAdContainer.element, videoElement = videoAdContainer.videoElement;\n    var drawnIcons = [];\n    var _c = icons.reduce(function (accumulator, icon) {\n        if (canBeShown(icon, videoElement)) {\n            accumulator.iconsToShow.push(icon);\n        }\n        else {\n            accumulator.otherIcons.push(icon);\n        }\n        return accumulator;\n    }, {\n        iconsToShow: [],\n        otherIcons: []\n    }), iconsToShow = _c.iconsToShow, otherIcons = _c.otherIcons;\n    otherIcons.forEach(function (_a) {\n        var _b;\n        var iconElement = _a.element;\n        (_b = iconElement === null || iconElement === void 0 ? void 0 : iconElement.parentNode) === null || _b === void 0 ? void 0 : _b.removeChild(iconElement);\n    });\n    return iconsToShow\n        .reduce(function (promise, icon) {\n        return promise\n            .then(function () {\n            return renderIcon(icon, {\n                document: document,\n                drawnIcons: drawnIcons,\n                onIconClick: onIconClick,\n                placeholder: element\n            });\n        })\n            .then(function (renderedIcon) {\n            drawnIcons.push(renderedIcon);\n        })\n            .catch(function (error) { return logger.log(error); });\n    }, Promise.resolve())\n        .then(function () { return drawnIcons; });\n};\nexport default renderIcons;\n","var canBeShown = function (icon, videoElement) {\n    var currentTimeInMs = videoElement.currentTime * 1000;\n    var videoDurationInMs = videoElement.duration * 1000;\n    var offset = typeof icon.offset === 'string'\n        ? parseInt(icon.offset, 10)\n        : icon.offset || 0;\n    var duration = icon.duration || videoDurationInMs;\n    return offset <= currentTimeInMs && currentTimeInMs - offset <= duration;\n};\nexport default canBeShown;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport renderIcons from './renderIcons';\nvar firstRenderPending = Symbol('firstRenderPending');\nvar noop = function () { };\nvar hasPendingIconRedraws = function (icons, videoElement) {\n    var currentTimeInMs = videoElement.currentTime * 1000;\n    var videoDurationInMs = videoElement.duration * 1000;\n    var iconsPendingToRedraw = icons.filter(function (icon) { return !icon.offset || icon.offset < currentTimeInMs; });\n    var iconsPendingToBeRemoved = icons.filter(function (icon) { return icon.duration && icon.duration < videoDurationInMs; });\n    return iconsPendingToRedraw.length > 0 || iconsPendingToBeRemoved.length > 0;\n};\nvar removeDrawnIcons = function (icons) {\n    return icons\n        .filter(function (_a) {\n        var element = _a.element;\n        return Boolean(element === null || element === void 0 ? void 0 : element.parentNode);\n    })\n        .forEach(function (_a) {\n        var _b;\n        var element = _a.element;\n        return (_b = element === null || element === void 0 ? void 0 : element.parentNode) === null || _b === void 0 ? void 0 : _b.removeChild(element);\n    });\n};\nvar addIcons = function (icons, _a) {\n    var videoAdContainer = _a.videoAdContainer, _b = _a.onIconView, onIconView = _b === void 0 ? noop : _b, _c = _a.onIconClick, onIconClick = _c === void 0 ? noop : _c, rest = __rest(_a, [\"videoAdContainer\", \"onIconView\", \"onIconClick\"]);\n    var videoElement = videoAdContainer.videoElement, element = videoAdContainer.element;\n    var drawIcons = function () { return __awaiter(void 0, void 0, void 0, function () {\n        var drawnIcons;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0: return [4 /*yield*/, renderIcons(icons, __assign({ onIconClick: onIconClick, videoAdContainer: videoAdContainer }, rest))];\n                case 1:\n                    drawnIcons = _a.sent();\n                    element.dispatchEvent(new CustomEvent('iconsDrawn'));\n                    drawnIcons.forEach(function (icon) {\n                        if (icon[firstRenderPending]) {\n                            onIconView(icon);\n                            icon[firstRenderPending] = false;\n                        }\n                    });\n                    return [2 /*return*/];\n            }\n        });\n    }); };\n    icons.forEach(function (icon) {\n        icon[firstRenderPending] = true;\n    });\n    return {\n        drawIcons: drawIcons,\n        hasPendingIconRedraws: function () { return hasPendingIconRedraws(icons, videoElement); },\n        removeIcons: function () { return removeDrawnIcons(icons); }\n    };\n};\nexport default addIcons;\n","var viewmode = function (width, height) {\n    var screen = window.screen;\n    var isFullscreen = width + 100 > screen.width && height + 100 > screen.height;\n    if (isFullscreen) {\n        return 'fullscreen';\n    }\n    if (width < 400) {\n        return 'thumbnail';\n    }\n    return 'normal';\n};\nexport default viewmode;\n","var preventManualProgress = function (videoElement) {\n    // IOS video clock is very unreliable and we need a 3 seconds threshold to ensure that the user forwarded/rewound the ad\n    var PROGRESS_THRESHOLD = 3;\n    var previousTime = 0;\n    var skipAttempts = 0;\n    var preventAdSkip = function () {\n        // Ignore ended event if the Ad time was not 'near' the end\n        // and revert time to the previous 'valid' time\n        if (videoElement.duration - previousTime > PROGRESS_THRESHOLD) {\n            // this reduces the video jitter if the IOS skip button is pressed\n            videoElement.pause();\n            // we need to trigger the play to put the video element back in a valid state\n            videoElement.play();\n            videoElement.currentTime = previousTime;\n        }\n    };\n    var preventAdSeek = function () {\n        var currentTime = videoElement.currentTime;\n        var progressDelta = Math.abs(currentTime - previousTime);\n        if (progressDelta > PROGRESS_THRESHOLD) {\n            skipAttempts += 1;\n            if (skipAttempts >= 2) {\n                videoElement.pause();\n            }\n            videoElement.currentTime = previousTime;\n        }\n        else {\n            previousTime = currentTime;\n        }\n    };\n    videoElement.addEventListener('timeupdate', preventAdSeek);\n    videoElement.addEventListener('ended', preventAdSkip);\n    return function () {\n        videoElement.removeEventListener('timeupdate', preventAdSeek);\n        videoElement.removeEventListener('ended', preventAdSkip);\n    };\n};\nexport default preventManualProgress;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar _a;\nimport { linearEvents, ErrorCode, isVastErrorCode } from '../tracker';\nimport { getSkipOffset } from '../vastSelectors';\nimport findBestMedia from './helpers/media/findBestMedia';\nimport once from './helpers/dom/once';\nimport setupMetricHandlers from './helpers/metrics/setupMetricHandlers';\nimport updateMedia from './helpers/media/updateMedia';\nimport AdUnitError from './helpers/adUnitError';\nimport VideoAdUnit, { _protected } from './VideoAdUnit';\nvar complete = linearEvents.complete, errorEvt = linearEvents.error, skip = linearEvents.skip;\nvar _private = Symbol('_private');\n/**\n * This class provides everything necessary to run a Vast ad.\n */\nvar VastAdUnit = /** @class */ (function (_super) {\n    __extends(VastAdUnit, _super);\n    /**\n     * Creates a {@link VastAdUnit}.\n     *\n     * @param vastChain The {@link VastChain} with all the {@link VastResponse}\n     * @param videoAdContainer - container instance to place the ad\n     * @param options Options Map\n     */\n    function VastAdUnit(vastChain, videoAdContainer, options) {\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, vastChain, videoAdContainer, options) || this;\n        _this[_a] = {\n            handleMetric: function (event, data) {\n                var _b;\n                switch (event) {\n                    case complete: {\n                        _this[_protected].finish();\n                        break;\n                    }\n                    case errorEvt: {\n                        if (data instanceof Error) {\n                            _this.error = data;\n                            _this.errorCode =\n                                ((_b = _this.error) === null || _b === void 0 ? void 0 : _b.code) && isVastErrorCode(_this.error.code)\n                                    ? _this.error.code\n                                    : ErrorCode.VAST_PROBLEM_DISPLAYING_MEDIA_FILE;\n                        }\n                        _this[_protected].onErrorCallbacks.forEach(function (callback) {\n                            return callback(_this.error, {\n                                adUnit: _this,\n                                vastChain: _this.vastChain\n                            });\n                        });\n                        _this[_protected].finish();\n                        break;\n                    }\n                    case skip: {\n                        _this.cancel();\n                        break;\n                    }\n                }\n                _this.emit(event, {\n                    adUnit: _this,\n                    data: data,\n                    type: event\n                });\n            },\n            drawIcons: function () { return __awaiter(_this, void 0, void 0, function () {\n                var videoElement;\n                var _b, _c, _d, _e;\n                return __generator(this, function (_f) {\n                    switch (_f.label) {\n                        case 0:\n                            if (this.isFinished()) {\n                                return [2 /*return*/];\n                            }\n                            return [4 /*yield*/, ((_c = (_b = this[_protected]).drawIcons) === null || _c === void 0 ? void 0 : _c.call(_b))];\n                        case 1:\n                            _f.sent();\n                            if (((_e = (_d = this[_protected]).hasPendingIconRedraws) === null || _e === void 0 ? void 0 : _e.call(_d)) && !this.isFinished()) {\n                                videoElement = this.videoAdContainer.videoElement;\n                                once(videoElement, 'timeupdate', this[_private].drawIcons);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); }\n        };\n        /** Ad unit type. Will be `VAST` for VastAdUnit */\n        _this.type = 'VAST';\n        var onFinishCallbacks = _this[_protected].onFinishCallbacks;\n        var handleMetric = _this[_private].handleMetric;\n        _this.hooks = options.hooks || {};\n        var removeMetricHandlers = setupMetricHandlers({\n            hooks: _this.hooks,\n            pauseOnAdClick: _this.pauseOnAdClick,\n            vastChain: _this.vastChain,\n            videoAdContainer: _this.videoAdContainer\n        }, handleMetric);\n        onFinishCallbacks.push(removeMetricHandlers);\n        return _this;\n    }\n    /**\n     * Starts the ad unit.\n     *\n     * @throws if called twice.\n     * @throws if ad unit is finished.\n     */\n    VastAdUnit.prototype.start = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var inlineAd, _b, videoElement, element, media, adUnitError;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this[_protected].throwIfFinished();\n                        if (this.isStarted()) {\n                            throw new AdUnitError('VastAdUnit already started');\n                        }\n                        inlineAd = this.vastChain[0].ad;\n                        _b = this.videoAdContainer, videoElement = _b.videoElement, element = _b.element;\n                        media = inlineAd && findBestMedia(inlineAd, videoElement, element, this.hooks);\n                        if (!media) return [3 /*break*/, 3];\n                        if (!this.icons) return [3 /*break*/, 2];\n                        return [4 /*yield*/, this[_private].drawIcons()];\n                    case 1:\n                        _c.sent();\n                        _c.label = 2;\n                    case 2:\n                        if (media === null || media === void 0 ? void 0 : media.src) {\n                            videoElement.src = media.src;\n                            this.assetUri = media.src;\n                        }\n                        videoElement.play();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        adUnitError = new AdUnitError(\"Can't find a suitable media to play\");\n                        adUnitError.code = ErrorCode.VAST_LINEAR_ASSET_MISMATCH;\n                        this[_private].handleMetric(errorEvt, adUnitError);\n                        _c.label = 4;\n                    case 4:\n                        this[_protected].started = true;\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VastAdUnit.prototype.resume = function () {\n        this.videoAdContainer.videoElement.play();\n    };\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VastAdUnit.prototype.pause = function () {\n        this.videoAdContainer.videoElement.pause();\n    };\n    /**\n     * Skips the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VastAdUnit.prototype.skip = function () {\n        var inlineAd = this.vastChain[0].ad;\n        var skipoffset = inlineAd && getSkipOffset(inlineAd);\n        var currentTimeMs = this.currentTime() * 1000;\n        if (typeof skipoffset === 'number' && currentTimeMs >= skipoffset) {\n            this[_private].handleMetric(skip);\n        }\n    };\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n    VastAdUnit.prototype.paused = function () {\n        return this.videoAdContainer.videoElement.paused;\n    };\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param volume must be a value between 0 and 1;\n     */\n    VastAdUnit.prototype.setVolume = function (volume) {\n        this.videoAdContainer.videoElement.volume = volume;\n    };\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns the volume of the ad unit.\n     */\n    VastAdUnit.prototype.getVolume = function () {\n        return this.videoAdContainer.videoElement.volume;\n    };\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n    VastAdUnit.prototype.cancel = function () {\n        this[_protected].throwIfFinished();\n        this.videoAdContainer.videoElement.pause();\n        this[_protected].finish();\n    };\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the duration of the ad unit.\n     */\n    VastAdUnit.prototype.duration = function () {\n        if (!this.isStarted()) {\n            return 0;\n        }\n        return this.videoAdContainer.videoElement.duration;\n    };\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the current time of the ad unit.\n     */\n    VastAdUnit.prototype.currentTime = function () {\n        if (!this.isStarted()) {\n            return 0;\n        }\n        return this.videoAdContainer.videoElement.currentTime;\n    };\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @param width the new width of the ad container.\n     * @param height the new height of the ad container.\n     * @param viewmode fullscreen | normal | thumbnail\n     * @returns Promise that resolves once the unit was resized\n     */\n    VastAdUnit.prototype.resize = function (width, height, viewmode) {\n        return __awaiter(this, void 0, void 0, function () {\n            var inlineAd, _b, videoElement, element, media;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0: return [4 /*yield*/, _super.prototype.resize.call(this, width, height, viewmode)];\n                    case 1:\n                        _c.sent();\n                        if (this.isStarted() && !this.isFinished()) {\n                            inlineAd = this.vastChain[0].ad;\n                            _b = this.videoAdContainer, videoElement = _b.videoElement, element = _b.element;\n                            media = inlineAd && findBestMedia(inlineAd, videoElement, element, this.hooks);\n                            if (media && videoElement.src !== media.src) {\n                                updateMedia(videoElement, media);\n                            }\n                        }\n                        return [2 /*return*/];\n                }\n            });\n        });\n    };\n    return VastAdUnit;\n}(VideoAdUnit));\n_a = _private;\nexport default VastAdUnit;\n","import once from '../dom/once';\nvar updateMedia = function (videoElement, mediaFile) {\n    return new Promise(function (resolve) {\n        var state = {\n            currentTime: videoElement.currentTime,\n            playing: !videoElement.paused\n        };\n        if (state.playing) {\n            videoElement.pause();\n        }\n        if (mediaFile.src) {\n            videoElement.src = mediaFile.src;\n        }\n        videoElement.load();\n        once(videoElement, 'loadeddata', function () {\n            videoElement.currentTime = state.currentTime;\n            if (state.playing) {\n                videoElement.play();\n            }\n            resolve();\n        });\n    });\n};\nexport default updateMedia;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar _a;\nimport { linearEvents, ErrorCode, isVastErrorCode } from '../tracker';\nimport { acceptInvitation, adCollapse } from '../tracker/nonLinearEvents';\nimport { getClickThrough } from '../vastSelectors';\nimport { volumeChanged, adProgress } from './adUnitEvents';\nimport loadCreative from './helpers/vpaid/loadCreative';\nimport { adLoaded, adStarted, adStopped, adPlaying, adPaused, startAd, stopAd, resumeAd, pauseAd, skipAd, setAdVolume, getAdVolume, getAdDuration, resizeAd, adSizeChange, adError, adVideoComplete, adSkipped, EVENTS, adVolumeChange, adImpression, adVideoStart, adVideoFirstQuartile, adVideoMidpoint, adVideoThirdQuartile, adUserAcceptInvitation, adUserMinimize, adUserClose, adDurationChange, adRemainingTimeChange, adClickThru, getAdIcons, getAdRemainingTime } from './helpers/vpaid/api';\nimport waitFor from './helpers/vpaid/waitFor';\nimport callAndWait from './helpers/vpaid/callAndWait';\nimport handshake from './helpers/vpaid/handshake';\nimport initAd from './helpers/vpaid/initAd';\nimport AdUnitError from './helpers/adUnitError';\nimport VideoAdUnit, { _protected } from './VideoAdUnit';\nvar complete = linearEvents.complete, mute = linearEvents.mute, unmute = linearEvents.unmute, skip = linearEvents.skip, start = linearEvents.start, firstQuartile = linearEvents.firstQuartile, pause = linearEvents.pause, resume = linearEvents.resume, impression = linearEvents.impression, midpoint = linearEvents.midpoint, thirdQuartile = linearEvents.thirdQuartile, clickThrough = linearEvents.clickThrough, errorEvt = linearEvents.error, closeLinear = linearEvents.closeLinear, creativeView = linearEvents.creativeView;\n// NOTE some ads only allow one handler per event and we need to subscribe to the adLoaded to know the creative is loaded.\nvar VPAID_EVENTS = EVENTS.filter(function (event) { return event !== adLoaded; });\nvar _private = Symbol('_private');\nvar vpaidGeneralError = function (payload) {\n    var error = payload instanceof Error ? payload : new AdUnitError('VPAID general error');\n    if (!error.code || !isVastErrorCode(error.code)) {\n        error.code = ErrorCode.VPAID_ERROR;\n    }\n    return error;\n};\n/**\n * This class provides everything necessary to run a Vpaid ad.\n */\nvar VpaidAdUnit = /** @class */ (function (_super) {\n    __extends(VpaidAdUnit, _super);\n    /**\n     * Creates a {@link VpaidAdUnit}.\n     *\n     * @param vastChain The {@link VastChain} with all the {@link VastResponse}\n     * @param videoAdContainer container instance to place the ad\n     * @param options Options Map\n     */\n    function VpaidAdUnit(vastChain, videoAdContainer, options) {\n        var _b;\n        if (options === void 0) { options = {}; }\n        var _this = _super.call(this, vastChain, videoAdContainer, options) || this;\n        _this[_a] = {\n            evtHandler: (_b = {},\n                _b[adClickThru] = function (url, _id, playerHandles) {\n                    if (playerHandles) {\n                        _this[_private].handleClickThrough(url);\n                    }\n                    _this.emit(clickThrough, {\n                        adUnit: _this,\n                        type: clickThrough\n                    });\n                },\n                _b[adDurationChange] = function () {\n                    _this.emit(adProgress, {\n                        adUnit: _this,\n                        type: adProgress\n                    });\n                },\n                _b[adError] = function (payload) {\n                    _this.error = vpaidGeneralError(payload);\n                    _this.errorCode = _this.error.code;\n                    _this[_protected].onErrorCallbacks.forEach(function (callback) {\n                        return callback(_this.error, {\n                            adUnit: _this,\n                            vastChain: _this.vastChain\n                        });\n                    });\n                    _this[_protected].finish();\n                    _this.emit(errorEvt, {\n                        adUnit: _this,\n                        type: errorEvt\n                    });\n                },\n                _b[adImpression] = function () {\n                    // NOTE: some ads forget to trigger the adVideoStart event. :(\n                    if (!_this[_private].videoStart) {\n                        _this[_private].handleVpaidEvent(adVideoStart);\n                    }\n                    _this.emit(impression, {\n                        adUnit: _this,\n                        type: impression\n                    });\n                },\n                _b[adPaused] = function () {\n                    _this[_private].paused = true;\n                    _this.emit(pause, {\n                        adUnit: _this,\n                        type: pause\n                    });\n                },\n                _b[adPlaying] = function () {\n                    _this[_private].paused = false;\n                    _this.emit(resume, {\n                        adUnit: _this,\n                        type: resume\n                    });\n                },\n                _b[adRemainingTimeChange] = function () {\n                    _this.emit(adProgress, {\n                        adUnit: _this,\n                        type: adProgress\n                    });\n                },\n                _b[adSkipped] = function () {\n                    _this.cancel();\n                    _this.emit(skip, {\n                        adUnit: _this,\n                        type: skip\n                    });\n                },\n                _b[adStarted] = function () {\n                    _this.emit(creativeView, {\n                        adUnit: _this,\n                        type: creativeView\n                    });\n                },\n                _b[adStopped] = function () {\n                    _this.emit(adStopped, {\n                        adUnit: _this,\n                        type: adStopped\n                    });\n                    _this[_protected].finish();\n                },\n                _b[adUserAcceptInvitation] = function () {\n                    _this.emit(acceptInvitation, {\n                        adUnit: _this,\n                        type: acceptInvitation\n                    });\n                },\n                _b[adUserClose] = function () {\n                    _this.emit(closeLinear, {\n                        adUnit: _this,\n                        type: closeLinear\n                    });\n                    _this[_protected].finish();\n                },\n                _b[adUserMinimize] = function () {\n                    _this.emit(adCollapse, {\n                        adUnit: _this,\n                        type: adCollapse\n                    });\n                },\n                _b[adVideoComplete] = function () {\n                    _this.emit(complete, {\n                        adUnit: _this,\n                        type: complete\n                    });\n                },\n                _b[adVideoFirstQuartile] = function () {\n                    _this.emit(firstQuartile, {\n                        adUnit: _this,\n                        type: firstQuartile\n                    });\n                },\n                _b[adVideoMidpoint] = function () {\n                    _this.emit(midpoint, {\n                        adUnit: _this,\n                        type: midpoint\n                    });\n                },\n                _b[adVideoStart] = function () {\n                    if (!_this[_private].videoStart) {\n                        _this[_private].videoStart = true;\n                        _this[_private].paused = false;\n                        _this.emit(start, {\n                            adUnit: _this,\n                            type: start\n                        });\n                    }\n                },\n                _b[adVideoThirdQuartile] = function () {\n                    _this.emit(thirdQuartile, {\n                        adUnit: _this,\n                        type: thirdQuartile\n                    });\n                },\n                _b[adVolumeChange] = function () {\n                    var volume = _this.getVolume();\n                    _this.emit(volumeChanged, {\n                        adUnit: _this,\n                        type: volumeChanged\n                    });\n                    if (volume === 0 && !_this[_private].muted) {\n                        _this[_private].muted = true;\n                        _this.emit(mute, {\n                            adUnit: _this,\n                            type: mute\n                        });\n                    }\n                    if (volume > 0 && _this[_private].muted) {\n                        _this[_private].muted = false;\n                        _this.emit(unmute, {\n                            adUnit: _this,\n                            type: unmute\n                        });\n                    }\n                },\n                _b),\n            handleVpaidEvent: function (event) {\n                var args = [];\n                for (var _i = 1; _i < arguments.length; _i++) {\n                    args[_i - 1] = arguments[_i];\n                }\n                var handler = _this[_private].evtHandler[event];\n                if (handler) {\n                    handler.apply(void 0, args);\n                }\n                _this.emit(event, {\n                    adUnit: _this,\n                    type: event\n                });\n            },\n            handleClickThrough: function (url) {\n                if (_this.paused() && _this.pauseOnAdClick) {\n                    _this.resume();\n                    return;\n                }\n                var inlineAd = _this.vastChain[0].ad;\n                var clickThroughUrl = typeof url === 'string' && url.length > 0\n                    ? url\n                    : inlineAd && getClickThrough(inlineAd);\n                if (_this.pauseOnAdClick) {\n                    _this.pause();\n                }\n                if (clickThroughUrl) {\n                    window.open(clickThroughUrl, '_blank');\n                }\n            },\n            getIcons: function () {\n                var _b;\n                if ((_b = _this.creativeAd) === null || _b === void 0 ? void 0 : _b[getAdIcons]) {\n                    try {\n                        if (!_this.creativeAd[getAdIcons]()) {\n                            delete _this.icons;\n                        }\n                    }\n                    catch (error) {\n                        delete _this.icons;\n                    }\n                }\n            },\n            drawIcons: function () { return __awaiter(_this, void 0, void 0, function () {\n                var _b, _c, _d, _e;\n                return __generator(this, function (_f) {\n                    switch (_f.label) {\n                        case 0:\n                            if (this.isFinished()) {\n                                return [2 /*return*/];\n                            }\n                            return [4 /*yield*/, ((_c = (_b = this[_protected]).drawIcons) === null || _c === void 0 ? void 0 : _c.call(_b))];\n                        case 1:\n                            _f.sent();\n                            if (((_e = (_d = this[_protected]).hasPendingIconRedraws) === null || _e === void 0 ? void 0 : _e.call(_d)) && !this.isFinished()) {\n                                setTimeout(this[_private].drawIcons, 500);\n                            }\n                            return [2 /*return*/];\n                    }\n                });\n            }); },\n            muted: false,\n            paused: true\n        };\n        /** Ad unit type. Will be `VPAID` for VpaidAdUnit */\n        _this.type = 'VPAID';\n        _this[_private].loadCreativePromise = loadCreative(vastChain, videoAdContainer);\n        return _this;\n    }\n    /**\n     * Starts the ad unit.\n     *\n     * @throws if called twice.\n     * @throws if ad unit is finished.\n     */\n    VpaidAdUnit.prototype.start = function () {\n        return __awaiter(this, void 0, void 0, function () {\n            var _b, adLoadedPromise, _i, VPAID_EVENTS_1, creativeEvt, videoElement, error_1, error_2;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this[_protected].throwIfFinished();\n                        if (this.isStarted()) {\n                            throw new Error('VpaidAdUnit already started');\n                        }\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 10, , 11]);\n                        _b = this;\n                        return [4 /*yield*/, this[_private]\n                                .loadCreativePromise];\n                    case 2:\n                        _b.creativeAd = (_c.sent());\n                        adLoadedPromise = waitFor(this.creativeAd, adLoaded);\n                        for (_i = 0, VPAID_EVENTS_1 = VPAID_EVENTS; _i < VPAID_EVENTS_1.length; _i++) {\n                            creativeEvt = VPAID_EVENTS_1[_i];\n                            this.creativeAd.subscribe(this[_private].handleVpaidEvent.bind(this, creativeEvt), creativeEvt);\n                        }\n                        this[_private].getIcons();\n                        handshake(this.creativeAd, '2.0');\n                        initAd(this.creativeAd, this.videoAdContainer, this.vastChain);\n                        return [4 /*yield*/, adLoadedPromise\n                            // if the ad timed out while trying to load the videoAdContainer will be destroyed\n                        ];\n                    case 3:\n                        _c.sent();\n                        if (!!this.videoAdContainer.isDestroyed()) return [3 /*break*/, 9];\n                        _c.label = 4;\n                    case 4:\n                        _c.trys.push([4, 8, , 9]);\n                        videoElement = this.videoAdContainer.videoElement;\n                        if (videoElement.muted) {\n                            this[_private].muted = true;\n                            this.setVolume(0);\n                        }\n                        else {\n                            this.setVolume(videoElement.volume);\n                        }\n                        return [4 /*yield*/, callAndWait(this.creativeAd, startAd, adStarted)];\n                    case 5:\n                        _c.sent();\n                        if (!this.icons) return [3 /*break*/, 7];\n                        return [4 /*yield*/, this[_private].drawIcons()];\n                    case 6:\n                        _c.sent();\n                        _c.label = 7;\n                    case 7:\n                        this[_protected].started = true;\n                        return [3 /*break*/, 9];\n                    case 8:\n                        error_1 = _c.sent();\n                        this.cancel();\n                        return [3 /*break*/, 9];\n                    case 9: return [3 /*break*/, 11];\n                    case 10:\n                        error_2 = _c.sent();\n                        this[_private].handleVpaidEvent(adError, error_2);\n                        throw error_2;\n                    case 11: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VpaidAdUnit.prototype.resume = function () {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[resumeAd]();\n    };\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VpaidAdUnit.prototype.pause = function () {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[pauseAd]();\n    };\n    /**\n     * Skip the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    VpaidAdUnit.prototype.skip = function () {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[skipAd]();\n    };\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n    VpaidAdUnit.prototype.paused = function () {\n        return this.isFinished() || this[_private].paused;\n    };\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param volume must be a value between 0 and 1;\n     */\n    VpaidAdUnit.prototype.setVolume = function (volume) {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[setAdVolume](volume);\n    };\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns the volume of the ad unit.\n     */\n    VpaidAdUnit.prototype.getVolume = function () {\n        if (!this.creativeAd) {\n            return 0;\n        }\n        return this.creativeAd[getAdVolume]();\n    };\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n    VpaidAdUnit.prototype.cancel = function () {\n        var _b;\n        return __awaiter(this, void 0, void 0, function () {\n            var adStoppedPromise, error_3;\n            return __generator(this, function (_c) {\n                switch (_c.label) {\n                    case 0:\n                        this[_protected].throwIfFinished();\n                        _c.label = 1;\n                    case 1:\n                        _c.trys.push([1, 3, , 4]);\n                        adStoppedPromise = this.creativeAd && waitFor(this.creativeAd, adStopped, 3000);\n                        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[stopAd]();\n                        return [4 /*yield*/, adStoppedPromise];\n                    case 2:\n                        _c.sent();\n                        return [3 /*break*/, 4];\n                    case 3:\n                        error_3 = _c.sent();\n                        this[_protected].finish();\n                        return [3 /*break*/, 4];\n                    case 4: return [2 /*return*/];\n                }\n            });\n        });\n    };\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * Note: if the user has engaged with the ad, the duration becomes unknown and it will return 0;\n     *\n     * @returns the duration of the ad unit.\n     */\n    VpaidAdUnit.prototype.duration = function () {\n        if (!this.creativeAd) {\n            return 0;\n        }\n        var duration = this.creativeAd[getAdDuration]();\n        if (duration < 0) {\n            return 0;\n        }\n        return duration;\n    };\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * Note: if the user has engaged with the ad, the currentTime becomes unknown and it will return 0;\n     *\n     * @returns the current time of the ad unit.\n     */\n    VpaidAdUnit.prototype.currentTime = function () {\n        if (!this.creativeAd) {\n            return 0;\n        }\n        var remainingTime = this.creativeAd[getAdRemainingTime]();\n        if (remainingTime < 0) {\n            return 0;\n        }\n        return this.duration() - remainingTime;\n    };\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns Promise that resolves once the unit was resized\n     */\n    VpaidAdUnit.prototype.resize = function (width, height, viewmode) {\n        return __awaiter(this, void 0, void 0, function () {\n            var slot;\n            return __generator(this, function (_b) {\n                switch (_b.label) {\n                    case 0: return [4 /*yield*/, _super.prototype.resize.call(this, width, height, viewmode)];\n                    case 1:\n                        _b.sent();\n                        if (!this.creativeAd) {\n                            return [2 /*return*/];\n                        }\n                        if (this.isStarted() && !this.isFinished()) {\n                            slot = this.videoAdContainer.slotElement;\n                            if (slot) {\n                                slot.style.height = \"\".concat(height, \"px\");\n                                slot.style.width = \"\".concat(width, \"px\");\n                            }\n                        }\n                        return [2 /*return*/, callAndWait(this.creativeAd, resizeAd, adSizeChange, width, height, viewmode)];\n                }\n            });\n        });\n    };\n    return VpaidAdUnit;\n}(VideoAdUnit));\n_a = _private;\nexport default VpaidAdUnit;\n","export var SUPPORTED_MIMETYPES = [\n    'text/javascript',\n    'text/javascript1.0',\n    'text/javascript1.2',\n    'text/javascript1.4',\n    'text/jscript',\n    'application/javascript',\n    'application/x-javascript',\n    'text/ecmascript',\n    'text/ecmascript1.0',\n    'text/ecmascript1.2',\n    'text/ecmascript1.4',\n    'text/livescript',\n    'application/ecmascript',\n    'application/x-ecmascript'\n];\nvar isSupported = function (_a) {\n    var type = _a.type;\n    return SUPPORTED_MIMETYPES.some(function (mimetype) { return mimetype === type; });\n};\nexport default isSupported;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { getInteractiveFiles } from '../../../vastSelectors';\nimport isSupported from './isSupported';\nvar loadCreative = function (vastChain, videoAdContainer) { return __awaiter(void 0, void 0, void 0, function () {\n    var creative, src, type, context;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                creative = ((vastChain[0].ad && getInteractiveFiles(vastChain[0].ad)) ||\n                    []).filter(isSupported)[0];\n                if (!creative || !creative.src) {\n                    throw new TypeError('VastChain does not contain a supported vpaid creative');\n                }\n                src = creative.src, type = creative.type;\n                return [4 /*yield*/, videoAdContainer.addScript(src, { type: type })];\n            case 1:\n                _a.sent();\n                context = videoAdContainer.executionContext;\n                return [2 /*return*/, context.getVPAIDAd()];\n        }\n    });\n}); };\nexport default loadCreative;\n","export var handshakeVersion = 'handshakeVersion';\nexport var initAd = 'initAd';\nexport var resizeAd = 'resizeAd';\nexport var startAd = 'startAd';\nexport var stopAd = 'stopAd';\nexport var pauseAd = 'pauseAd';\nexport var resumeAd = 'resumeAd';\nexport var expandAd = 'expandAd';\nexport var skipAd = 'skipAd';\nexport var collapseAd = 'collapseAd';\nexport var getAdLinear = 'getAdLinear';\nexport var getAdWidth = 'getAdWidth';\nexport var getAdHeight = 'getAdHeight';\nexport var getAdExpanded = 'getAdExpanded';\nexport var getAdSkippableState = 'getAdSkippableState';\nexport var getAdRemainingTime = 'getAdRemainingTime';\nexport var getAdDuration = 'getAdDuration';\nexport var getAdVolume = 'getAdVolume';\nexport var getAdCompanions = 'getAdCompanions';\nexport var getAdIcons = 'getAdIcons';\nexport var setAdVolume = 'setAdVolume';\nexport var adLoaded = 'AdLoaded';\nexport var adStarted = 'AdStarted';\nexport var adStopped = 'AdStopped';\nexport var adSkipped = 'AdSkipped';\nexport var adSkippableStateChange = 'AdSkippableStateChange';\nexport var adSizeChange = 'AdSizeChange';\nexport var adLinearChange = 'AdLinearChange';\nexport var adDurationChange = 'AdDurationChange';\nexport var adExpandedChange = 'AdExpandedChange';\nexport var adRemainingTimeChange = 'AdRemainingTimeChange';\nexport var adVolumeChange = 'AdVolumeChange';\nexport var adImpression = 'AdImpression';\nexport var adVideoStart = 'AdVideoStart';\nexport var adVideoFirstQuartile = 'AdVideoFirstQuartile';\nexport var adVideoMidpoint = 'AdVideoMidpoint';\nexport var adVideoThirdQuartile = 'AdVideoThirdQuartile';\nexport var adVideoComplete = 'AdVideoComplete';\nexport var adClickThru = 'AdClickThru';\nexport var adInteraction = 'AdInteraction';\nexport var adUserAcceptInvitation = 'AdUserAcceptInvitation';\nexport var adUserMinimize = 'AdUserMinimize';\nexport var adUserClose = 'AdUserClose';\nexport var adPaused = 'AdPaused';\nexport var adPlaying = 'AdPlaying';\nexport var adLog = 'AdLog';\nexport var adError = 'AdError';\nexport var EVENTS = [\n    adLoaded,\n    adStarted,\n    adStopped,\n    adSkipped,\n    adSkippableStateChange,\n    adSizeChange,\n    adLinearChange,\n    adDurationChange,\n    adExpandedChange,\n    adRemainingTimeChange,\n    adVolumeChange,\n    adImpression,\n    adVideoStart,\n    adVideoFirstQuartile,\n    adVideoMidpoint,\n    adVideoThirdQuartile,\n    adVideoComplete,\n    adClickThru,\n    adInteraction,\n    adUserAcceptInvitation,\n    adUserMinimize,\n    adUserClose,\n    adPaused,\n    adPlaying,\n    adLog,\n    adError\n];\nexport var METHODS = [\n    handshakeVersion,\n    initAd,\n    resizeAd,\n    startAd,\n    stopAd,\n    pauseAd,\n    resumeAd,\n    expandAd,\n    collapseAd,\n    // VPAID 2.0 new methods\n    skipAd\n];\nexport var GETTERS = [\n    getAdLinear,\n    getAdExpanded,\n    getAdRemainingTime,\n    getAdVolume,\n    // VPAID 2.0 new getters\n    getAdWidth,\n    getAdHeight,\n    getAdSkippableState,\n    getAdDuration,\n    getAdCompanions,\n    getAdIcons\n];\nexport var SETTERS = [setAdVolume];\n","var waitFor = function (creativeAd, event, timeout) {\n    return new Promise(function (resolve, reject) {\n        var timeoutId;\n        var handler = function () {\n            if (typeof timeout === 'number') {\n                window.clearTimeout(timeoutId);\n            }\n            creativeAd.unsubscribe(handler, event);\n            resolve();\n        };\n        if (typeof timeout === 'number') {\n            timeoutId = window.setTimeout(function () {\n                creativeAd.unsubscribe(handler, event);\n                reject(new Error(\"Timeout waiting for event '\".concat(event, \"'\")));\n            }, timeout);\n        }\n        creativeAd.subscribe(handler, event);\n    });\n};\nexport default waitFor;\n","import waitFor from './waitFor';\nvar callAndWait = function (creativeAd, method, event) {\n    var args = [];\n    for (var _i = 3; _i < arguments.length; _i++) {\n        args[_i - 3] = arguments[_i];\n    }\n    var waitPromise = waitFor(creativeAd, event, 5000);\n    var creativeMethod = creativeAd[method];\n    creativeMethod === null || creativeMethod === void 0 ? void 0 : creativeMethod.apply(creativeAd, args);\n    return waitPromise;\n};\nexport default callAndWait;\n","import { handshakeVersion } from './api';\nvar major = function (version) {\n    var parts = version.split('.');\n    return parseInt(parts[0], 10);\n};\nvar isSupported = function (supportedVersion, creativeVersion) {\n    var creativeMajorNum = major(creativeVersion);\n    if (creativeMajorNum < 1) {\n        return false;\n    }\n    return creativeMajorNum <= major(supportedVersion);\n};\nvar handshake = function (creativeAd, supportedVersion) {\n    var creativeVersion = creativeAd[handshakeVersion](supportedVersion);\n    if (!isSupported(supportedVersion, creativeVersion)) {\n        throw new Error(\"Creative Version '\".concat(creativeVersion, \"' not supported\"));\n    }\n    return creativeVersion;\n};\nexport default handshake;\n","import { getCreativeData } from '../../../vastSelectors';\nimport viewmode from './viewmode';\nvar initAd = function (creativeAd, videoAdContainer, vastChain) {\n    var _a = videoAdContainer.element.getBoundingClientRect(), width = _a.width, height = _a.height;\n    var mode = viewmode(width, height);\n    var desiredBitrate = -1;\n    var creativeData = getCreativeData(vastChain[0].XML);\n    videoAdContainer.addSlot(width, height);\n    var environmentVars = {\n        slot: videoAdContainer.slotElement,\n        videoSlot: videoAdContainer.videoElement,\n        videoSlotCanAutoPlay: videoAdContainer.isOriginalVideoElement\n    };\n    creativeAd.initAd(width, height, mode, desiredBitrate, creativeData, environmentVars);\n};\nexport default initAd;\n","import { linearEvents, nonLinearEvents, trackLinearEvent, trackNonLinearEvent } from '../tracker';\nimport VastAdUnit from './VastAdUnit';\nimport VpaidAdUnit from './VpaidAdUnit';\nfunction createVideoAdUnit(vastChain, videoAdContainer, options) {\n    var tracker = options.tracker, type = options.type;\n    var adUnit = type === 'VPAID'\n        ? new VpaidAdUnit(vastChain, videoAdContainer, options)\n        : new VastAdUnit(vastChain, videoAdContainer, options);\n    Object.values(linearEvents).forEach(function (linearEvent) {\n        return adUnit.on(linearEvent, function (event) {\n            var evtType = event.type, data = event.data;\n            var payload = {\n                data: data,\n                errorCode: adUnit.errorCode,\n                tracker: tracker\n            };\n            trackLinearEvent(evtType, vastChain, payload);\n        });\n    });\n    Object.values(nonLinearEvents).forEach(function (nonLinearEvent) {\n        return adUnit.on(nonLinearEvent, function (event) {\n            var payload = {\n                data: event.data,\n                tracker: tracker\n            };\n            trackNonLinearEvent(event.type, vastChain, payload);\n        });\n    });\n    return adUnit;\n}\nexport default createVideoAdUnit;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar VastError = /** @class */ (function (_super) {\n    __extends(VastError, _super);\n    function VastError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = 'VastError';\n        Object.setPrototypeOf(_this, VastError.prototype);\n        return _this;\n    }\n    return VastError;\n}(Error));\nexport default VastError;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { createVideoAdUnit } from '../../adUnit';\nimport { VideoAdContainer } from '../../adContainer';\nimport { ErrorCode } from '../../tracker';\nimport { getInteractiveFiles, getMediaFiles } from '../../vastSelectors';\nimport canPlay from '../../adUnit/helpers/media/canPlay';\nimport { start, closeLinear } from '../../tracker/linearEvents';\nimport { adStopped, adUserClose } from '../../adUnit/helpers/vpaid/api';\nimport VastError from '../../vastRequest/helpers/vastError';\nvar validate = function (vastChain, videoAdContainer) {\n    if (!Array.isArray(vastChain) || vastChain.length === 0) {\n        throw new TypeError('Invalid vastChain');\n    }\n    if (!(videoAdContainer instanceof VideoAdContainer)) {\n        throw new TypeError('Invalid VideoAdContainer');\n    }\n};\nvar hasVpaidCreative = function (ad) {\n    return Boolean(getInteractiveFiles(ad));\n};\nvar hasVastCreative = function (ad, videoElement) {\n    var mediaFiles = getMediaFiles(ad);\n    if (mediaFiles) {\n        return mediaFiles.some(function (mediaFile) { return canPlay(videoElement, mediaFile); });\n    }\n    return false;\n};\nvar startAdUnit = function (adUnit, _a) {\n    var onAdReady = _a.onAdReady;\n    return new Promise(function (resolve, reject) {\n        var createRejectHandler = function (event) { return function () {\n            return reject(new Error(\"Ad unit start rejected due to event '\".concat(event, \"'\")));\n        }; };\n        adUnit.onError(reject);\n        adUnit.on(start, function () { return resolve(adUnit); });\n        adUnit.on(adUserClose, createRejectHandler(adUserClose));\n        adUnit.on(closeLinear, createRejectHandler(closeLinear));\n        adUnit.on(adStopped, createRejectHandler(adStopped));\n        onAdReady(adUnit);\n        adUnit.start();\n    });\n};\nvar tryToStartVpaidAd = function (vastChain, videoAdContainer, options) {\n    var inlineAd = vastChain[0].ad;\n    if (!inlineAd || !hasVpaidCreative(inlineAd)) {\n        var error = new VastError('No valid creative found in the passed VAST chain');\n        error.code = ErrorCode.VAST_MEDIA_FILE_NOT_FOUND;\n        throw error;\n    }\n    var adUnit = createVideoAdUnit(vastChain, videoAdContainer, __assign(__assign({}, options), { type: 'VPAID' }));\n    return startAdUnit(adUnit, options);\n};\nvar startVastAd = function (vastChain, videoAdContainer, options) {\n    var adUnit = createVideoAdUnit(vastChain, videoAdContainer, __assign(__assign({}, options), { type: 'VAST' }));\n    return startAdUnit(adUnit, options);\n};\nvar startVideoAd = function (vastChain, videoAdContainer, options) { return __awaiter(void 0, void 0, void 0, function () {\n    var error_1, inlineAd;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                validate(vastChain, videoAdContainer);\n                _a.label = 1;\n            case 1:\n                _a.trys.push([1, 3, , 4]);\n                return [4 /*yield*/, tryToStartVpaidAd(vastChain, videoAdContainer, options)];\n            case 2: return [2 /*return*/, _a.sent()];\n            case 3:\n                error_1 = _a.sent();\n                inlineAd = vastChain[0].ad;\n                if (inlineAd && hasVastCreative(inlineAd, videoAdContainer.videoElement)) {\n                    return [2 /*return*/, startVastAd(vastChain, videoAdContainer, options)];\n                }\n                throw error_1;\n            case 4: return [2 /*return*/];\n        }\n    });\n}); };\nexport default startVideoAd;\n","var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nimport { trackError, ErrorCode } from '../tracker';\nimport { createVideoAdContainer } from '../adContainer';\nimport startVideoAd from './helpers/startVideoAd';\n/**\n * Will try to start video ad in the passed {@link VastChain} and return the started VideoAdUnit.\n * If there is an error starting the ad or it times out (by throw I mean that it will reject promise with the error).\n *\n * @param vastChain The {@link VastChain} with all the {@link VastResponse}s.\n * @param placeholder Element that will contain the video ad.\n * @param options - Options Map.\n * @returns The video ad unit.\n */\nvar run = function (vastChain, placeholder, options) { return __awaiter(void 0, void 0, void 0, function () {\n    var videoAdContainer, timeout, adUnitPromise, timedOut_1, timeoutId_1, timeoutPromise, adUnit, error_1;\n    return __generator(this, function (_a) {\n        switch (_a.label) {\n            case 0:\n                _a.trys.push([0, 2, , 3]);\n                timeout = options.timeout;\n                videoAdContainer = createVideoAdContainer(placeholder, options.videoElement);\n                adUnitPromise = startVideoAd(vastChain, videoAdContainer, options);\n                if (typeof timeout === 'number') {\n                    timedOut_1 = false;\n                    timeoutPromise = new Promise(function (_resolve, reject) {\n                        timeoutId_1 = window.setTimeout(function () {\n                            var tracker = options.tracker;\n                            trackError(vastChain, {\n                                errorCode: ErrorCode.VAST_MEDIA_LOAD_TIMEOUT,\n                                tracker: tracker\n                            });\n                            timedOut_1 = true;\n                            reject(new Error('Timeout while starting the ad'));\n                        }, options.timeout);\n                    });\n                    adUnitPromise = Promise.race([\n                        adUnitPromise.then(function (newAdUnit) {\n                            if (timedOut_1) {\n                                if (newAdUnit.isStarted()) {\n                                    newAdUnit.cancel();\n                                }\n                            }\n                            else {\n                                clearTimeout(timeoutId_1);\n                            }\n                            return newAdUnit;\n                        }),\n                        timeoutPromise\n                    ]);\n                }\n                return [4 /*yield*/, adUnitPromise];\n            case 1:\n                adUnit = _a.sent();\n                adUnit.onFinish(function () {\n                    videoAdContainer === null || videoAdContainer === void 0 ? void 0 : videoAdContainer.destroy();\n                });\n                return [2 /*return*/, adUnit];\n            case 2:\n                error_1 = _a.sent();\n                videoAdContainer === null || videoAdContainer === void 0 ? void 0 : videoAdContainer.destroy();\n                throw error_1;\n            case 3: return [2 /*return*/];\n        }\n    });\n}); };\nexport default run;\n","import VideoAdContainer from './VideoAdContainer';\n/**\n * VideoAdContainer factory method. Returns a VideoAdContainer instance that will contain the video ad.\n *\n * @ignore\n * @param placeholder Placeholder element that will contain the video ad.\n * @param videoElement Optional videoElement that will be used to play the ad.\n *\n * @returns Returns a `VideoAdContainer` instance.\n */\nvar createVideoAdContainer = function (placeholder, videoElement) {\n    if (!placeholder) {\n        throw new TypeError('placeholder is required');\n    }\n    return new VideoAdContainer(placeholder, videoElement);\n};\nexport default createVideoAdContainer;\n","var __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (Object.prototype.hasOwnProperty.call(b, p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    };\n    return function (d, b) {\n        if (typeof b !== \"function\" && b !== null)\n            throw new TypeError(\"Class extends value \" + String(b) + \" is not a constructor or null\");\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar FetchError = /** @class */ (function (_super) {\n    __extends(FetchError, _super);\n    function FetchError(message) {\n        var _this = _super.call(this, message) || this;\n        _this.name = 'FetchError';\n        Object.setPrototypeOf(_this, FetchError.prototype);\n        return _this;\n    }\n    return FetchError;\n}(Error));\nvar fetch = function (endpoint, options) {\n    if (options === void 0) { options = {}; }\n    return __awaiter(void 0, void 0, void 0, function () {\n        var defaults, fetchOptions, response, error;\n        return __generator(this, function (_a) {\n            switch (_a.label) {\n                case 0:\n                    defaults = {\n                        credentials: 'include'\n                    };\n                    fetchOptions = Object.assign({}, defaults, options);\n                    return [4 /*yield*/, window.fetch(endpoint, fetchOptions)];\n                case 1:\n                    response = _a.sent();\n                    if (response.status >= 400) {\n                        error = new FetchError(response.statusText);\n                        error.response = response;\n                        throw error;\n                    }\n                    return [2 /*return*/, response];\n            }\n        });\n    });\n};\nexport default fetch;\n","var requested = Symbol('requested');\nexport var markAdAsRequested = function (ad) {\n    ad[requested] = true;\n};\nexport var unmarkAdAsRequested = function (ad) {\n    delete ad[requested];\n};\nexport var hasAdBeenRequested = function (ad) {\n    return Boolean(ad[requested]);\n};\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { parseXml } from '../xml';\nimport { isVastErrorCode, ErrorCode } from '../tracker';\nimport { getWrapperOptions, getFirstAd, getVASTAdTagURI, hasAdPod, isInline, isWrapper } from '../vastSelectors';\nimport fetch from './helpers/fetch';\nimport VastError from './helpers/vastError';\nimport { markAdAsRequested } from './helpers/adUtils';\nvar validateChain = function (vastChain, _a) {\n    var _b = _a.wrapperLimit, wrapperLimit = _b === void 0 ? 5 : _b;\n    if (vastChain.length > wrapperLimit) {\n        var error = new VastError('Wrapper Limit reached');\n        error.code = ErrorCode.VAST_TOO_MANY_REDIRECTS;\n        throw error;\n    }\n};\nvar fetchAdXML = function (adTag, options) { return __awaiter(void 0, void 0, void 0, function () {\n    var response, XML, error_1;\n    var _a;\n    return __generator(this, function (_b) {\n        switch (_b.label) {\n            case 0:\n                _b.trys.push([0, 3, , 4]);\n                return [4 /*yield*/, fetch(adTag, options)];\n            case 1:\n                response = _b.sent();\n                return [4 /*yield*/, response.text()];\n            case 2:\n                XML = _b.sent();\n                return [2 /*return*/, { response: response, XML: XML }];\n            case 3:\n                error_1 = _b.sent();\n                error_1.code = ErrorCode.VAST_NONLINEAR_LOADING_FAILED;\n                (_a = error_1.response) !== null && _a !== void 0 ? _a : (error_1.response = response);\n                throw error_1;\n            case 4: return [2 /*return*/];\n        }\n    });\n}); };\nvar parseVastXml = function (xml) {\n    try {\n        return parseXml(xml);\n    }\n    catch (error) {\n        error.code = ErrorCode.VAST_XML_PARSING_ERROR;\n        throw error;\n    }\n};\nvar getAd = function (parsedXML) {\n    try {\n        var ad = getFirstAd(parsedXML);\n        if (ad) {\n            markAdAsRequested(ad);\n            return ad;\n        }\n        throw new Error('No Ad');\n    }\n    catch (error) {\n        error.code = ErrorCode.VAST_NO_ADS_AFTER_WRAPPER;\n        throw error;\n    }\n};\nvar validateResponse = function (_a, _b) {\n    var ad = _a.ad, parsedXML = _a.parsedXML;\n    var _c = _b.allowMultipleAds, allowMultipleAds = _c === void 0 ? true : _c, _d = _b.followAdditionalWrappers, followAdditionalWrappers = _d === void 0 ? true : _d;\n    if (!isWrapper(ad) && !isInline(ad)) {\n        var error = new VastError('Invalid VAST, ad contains neither Wrapper nor Inline');\n        error.code = ErrorCode.VAST_SCHEMA_VALIDATION_ERROR;\n        throw error;\n    }\n    if (hasAdPod(parsedXML) && !allowMultipleAds) {\n        var error = new VastError('Multiple ads are not allowed');\n        error.code = ErrorCode.VAST_UNEXPECTED_MEDIA_FILE;\n        throw error;\n    }\n    if (isWrapper(ad) && !followAdditionalWrappers) {\n        var error = new VastError('To follow additional wrappers is not allowed');\n        error.code = ErrorCode.VAST_UNEXPECTED_AD_TYPE;\n        throw error;\n    }\n};\nvar getOptions = function (vastChain, options) {\n    var parentAd = vastChain[0];\n    var parentAdIsWrapper = Boolean(parentAd) && parentAd.ad && isWrapper(parentAd.ad);\n    var wrapperOptions = parentAdIsWrapper && parentAd.ad ? getWrapperOptions(parentAd.ad) : {};\n    return __assign(__assign({}, wrapperOptions), options);\n};\n/**\n * Request the ad using the passed ad tag and returns an array with the {@link VastResponse} needed to get an inline ad.\n *\n * @param adTag The VAST ad tag request url.\n * @param options Options Map. The allowed properties are:\n * @param vastChain Optional vastChain with the previous VAST responses.\n * @returns Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nvar requestAd = function (adTag, options, vastChain) {\n    if (vastChain === void 0) { vastChain = []; }\n    return __awaiter(void 0, void 0, void 0, function () {\n        var vastAdResponse, epoch, timeout, resultOptions, fetchPromise, _a, response, XML, error_2;\n        var _b;\n        return __generator(this, function (_c) {\n            switch (_c.label) {\n                case 0:\n                    vastAdResponse = {\n                        requestTag: adTag\n                    };\n                    _c.label = 1;\n                case 1:\n                    _c.trys.push([1, 3, , 4]);\n                    resultOptions = getOptions(vastChain, options);\n                    validateChain(vastChain, resultOptions);\n                    fetchPromise = fetchAdXML(adTag, resultOptions);\n                    if (typeof resultOptions.timeout === 'number') {\n                        timeout = resultOptions.timeout;\n                        epoch = Date.now();\n                        fetchPromise = Promise.race([\n                            fetchPromise,\n                            new Promise(function (_resolve, reject) {\n                                setTimeout(function () {\n                                    var error = new VastError('RequestAd timeout');\n                                    error.code = ErrorCode.VAST_LOAD_TIMEOUT;\n                                    reject(error);\n                                }, timeout);\n                            })\n                        ]);\n                    }\n                    return [4 /*yield*/, fetchPromise];\n                case 2:\n                    _a = _c.sent(), response = _a.response, XML = _a.XML;\n                    vastAdResponse.response = response;\n                    vastAdResponse.XML = XML;\n                    vastAdResponse.parsedXML = parseVastXml(vastAdResponse.XML);\n                    vastAdResponse.ad = getAd(vastAdResponse.parsedXML);\n                    validateResponse(vastAdResponse, resultOptions);\n                    if (isWrapper(vastAdResponse.ad)) {\n                        if (epoch && timeout) {\n                            timeout -= Date.now() - epoch;\n                        }\n                        return [2 /*return*/, requestAd(getVASTAdTagURI(vastAdResponse.ad), __assign(__assign({}, resultOptions), { timeout: timeout }), __spreadArray([vastAdResponse], vastChain, true))];\n                    }\n                    return [2 /*return*/, __spreadArray([vastAdResponse], vastChain, true)];\n                case 3:\n                    error_2 = _c.sent();\n                    /* istanbul ignore if */\n                    if (!isVastErrorCode(error_2.code)) {\n                        error_2.code = ErrorCode.UNKNOWN_ERROR;\n                    }\n                    vastAdResponse.errorCode = error_2.code;\n                    vastAdResponse.error = error_2;\n                    (_b = vastAdResponse.response) !== null && _b !== void 0 ? _b : (vastAdResponse.response = error_2.response);\n                    return [2 /*return*/, __spreadArray([vastAdResponse], vastChain, true)];\n                case 4: return [2 /*return*/];\n            }\n        });\n    });\n};\nexport default requestAd;\n","import saneError from 'sane-domparser-error';\nimport xmlToJson from './xmlToJson';\nvar xml2js = function (parser, xmlText) {\n    var xmlDom = parser.parseFromString(xmlText, 'application/xml');\n    saneError.failOnParseError(xmlDom);\n    return xmlToJson(xmlDom);\n};\nexport default xml2js;\n","var __spreadArray = (this && this.__spreadArray) || function (to, from, pack) {\n    if (pack || arguments.length === 2) for (var i = 0, l = from.length, ar; i < l; i++) {\n        if (ar || !(i in from)) {\n            if (!ar) ar = Array.prototype.slice.call(from, 0, i);\n            ar[i] = from[i];\n        }\n    }\n    return to.concat(ar || Array.prototype.slice.call(from));\n};\nimport { getVASTAdTagURI, isWrapper } from '../vastSelectors';\nimport requestAd from './requestAd';\nimport getNextAd from './helpers/getNextAd';\nimport { markAdAsRequested } from './helpers/adUtils';\nvar validateChain = function (vastChain) {\n    if (!Array.isArray(vastChain)) {\n        throw new TypeError('Invalid VAST chain');\n    }\n    if (vastChain.length === 0) {\n        throw new Error('No next ad to request');\n    }\n};\n/**\n * Requests the next ad in the VAST Chain.\n *\n * @param vastChain Array of {@link VastResponse}.\n * @param options Options Map. The allowed properties are:\n * @returns Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nvar requestNextAd = function (vastChain, options) {\n    validateChain(vastChain);\n    var vastResponse = vastChain[0];\n    var nextAd = getNextAd(vastResponse, options);\n    if (nextAd) {\n        var newVastResponse = Object.assign({}, vastResponse, {\n            ad: nextAd\n        });\n        var newVastChain = __spreadArray([newVastResponse], vastChain.slice(1), true);\n        markAdAsRequested(nextAd);\n        if (isWrapper(nextAd)) {\n            return requestAd(getVASTAdTagURI(nextAd), options, newVastChain);\n        }\n        return Promise.resolve(newVastChain);\n    }\n    return requestNextAd(vastChain.slice(1), options);\n};\nexport default requestNextAd;\n","import { hasAdPod, getAds, getPodAdSequence, isPodAd } from '../../vastSelectors';\nimport { hasAdBeenRequested } from './adUtils';\nvar getNextPod = function (currentPod, ads) {\n    var nextPodSequence = (getPodAdSequence(currentPod) || 0) + 1;\n    return ads.find(function (ad) { return getPodAdSequence(ad) === nextPodSequence; });\n};\nvar getNextAd = function (_a, _b) {\n    var ad = _a.ad, parsedXML = _a.parsedXML;\n    var _c = _b.fallbackOnNoAd, fallbackOnNoAd = _c === void 0 ? true : _c, _d = _b.useAdBuffet, useAdBuffet = _d === void 0 ? false : _d;\n    var ads = getAds(parsedXML);\n    var availableAds = ads.filter(function (adDefinition) { return !hasAdBeenRequested(adDefinition); });\n    var nextAd;\n    if (hasAdPod(parsedXML)) {\n        if (useAdBuffet) {\n            nextAd = availableAds.filter(function (adDefinition) { return !isPodAd(adDefinition); })[0];\n        }\n        if (ad && !nextAd) {\n            nextAd = getNextPod(ad, availableAds);\n        }\n    }\n    else if (availableAds.length > 0 && fallbackOnNoAd) {\n        nextAd = availableAds[0];\n    }\n    return nextAd;\n};\nexport default getNextAd;\n","var __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {\n    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }\n    return new (P || (P = Promise))(function (resolve, reject) {\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\n        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\n    });\n};\nvar __generator = (this && this.__generator) || function (thisArg, body) {\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\n    function verb(n) { return function (v) { return step([n, v]); }; }\n    function step(op) {\n        if (f) throw new TypeError(\"Generator is already executing.\");\n        while (g && (g = 0, op[0] && (_ = 0)), _) try {\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\n            if (y = 0, t) op = [op[0] & 2, t.value];\n            switch (op[0]) {\n                case 0: case 1: t = op; break;\n                case 4: _.label++; return { value: op[1], done: false };\n                case 5: _.label++; y = op[1]; op = [0]; continue;\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\n                default:\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\n                    if (t[2]) _.ops.pop();\n                    _.trys.pop(); continue;\n            }\n            op = body.call(thisArg, _);\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\n    }\n};\nvar __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { trackError, isVastErrorCode, ErrorCode } from '../tracker';\nimport { requestAd, requestNextAd } from '../vastRequest';\nimport VastError from '../vastRequest/helpers/vastError';\nimport { getInteractiveFiles } from '../vastSelectors';\nimport isIOS from '../utils/isIOS';\nimport run from './run';\nvar isVpaid = function (vastChain) {\n    return Boolean(vastChain[0].ad && getInteractiveFiles(vastChain[0].ad));\n};\nvar validateVastChain = function (vastChain, options) {\n    var _a;\n    if (!vastChain || vastChain.length === 0) {\n        throw new Error('Invalid VastChain');\n    }\n    var lastVastResponse = vastChain[0];\n    if (!options.vpaidEnabled && isVpaid(vastChain)) {\n        var error = new VastError('VPAID ads are not supported by the current player');\n        error.code = ErrorCode.VAST_UNEXPECTED_AD_TYPE;\n        lastVastResponse.errorCode = ErrorCode.VAST_UNEXPECTED_AD_TYPE;\n        lastVastResponse.error = error;\n    }\n    if (lastVastResponse.error) {\n        throw lastVastResponse.error;\n    }\n    if (typeof ((_a = options.hooks) === null || _a === void 0 ? void 0 : _a.validateVastResponse) === 'function') {\n        options.hooks.validateVastResponse(vastChain);\n    }\n};\nvar callbackHandler = function (callback) {\n    return function () {\n        var args = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            args[_i] = arguments[_i];\n        }\n        if (typeof callback === 'function') {\n            callback.apply(void 0, args);\n        }\n    };\n};\nvar transformVastResponse = function (vastChain, _a) {\n    var hooks = _a.hooks;\n    if (typeof (hooks === null || hooks === void 0 ? void 0 : hooks.transformVastResponse) === 'function') {\n        return hooks.transformVastResponse(vastChain);\n    }\n    return vastChain;\n};\nvar handleVastError = function (error, vastChain, tracker) {\n    var _a;\n    var errorCode = ((_a = vastChain === null || vastChain === void 0 ? void 0 : vastChain[0]) === null || _a === void 0 ? void 0 : _a.errorCode) || (error === null || error === void 0 ? void 0 : error.code);\n    if (vastChain && errorCode) {\n        if (!isVastErrorCode(errorCode)) {\n            errorCode = ErrorCode.UNKNOWN_ERROR;\n        }\n        trackError(vastChain, {\n            errorCode: errorCode,\n            tracker: tracker\n        });\n    }\n};\nvar waterfall = function (fetchVastChain, placeholder, _a, isCanceled) { return __awaiter(void 0, void 0, void 0, function () {\n    var vastChain, runEpoch, adUnit, onAdStart, onError, onRunFinish, newEpoch, error_1;\n    var options = __rest(_a, []);\n    return __generator(this, function (_b) {\n        switch (_b.label) {\n            case 0:\n                onAdStart = options.onAdStart, onError = options.onError, onRunFinish = options.onRunFinish;\n                _b.label = 1;\n            case 1:\n                _b.trys.push([1, 4, , 5]);\n                if (typeof options.timeout === 'number') {\n                    runEpoch = Date.now();\n                }\n                return [4 /*yield*/, fetchVastChain()];\n            case 2:\n                vastChain = _b.sent();\n                if (isCanceled()) {\n                    onRunFinish();\n                    return [2 /*return*/];\n                }\n                if (options.timeout && runEpoch) {\n                    newEpoch = Date.now();\n                    options.timeout -= newEpoch - runEpoch;\n                    runEpoch = newEpoch;\n                }\n                validateVastChain(vastChain, options);\n                return [4 /*yield*/, run(transformVastResponse(vastChain, options), placeholder, __assign({}, options))];\n            case 3:\n                adUnit = _b.sent();\n                if (isCanceled()) {\n                    adUnit.cancel();\n                    onRunFinish();\n                    return [2 /*return*/];\n                }\n                adUnit.onError(onError);\n                adUnit.onFinish(onRunFinish);\n                onAdStart(adUnit);\n                return [3 /*break*/, 5];\n            case 4:\n                error_1 = _b.sent();\n                handleVastError(error_1, vastChain, options.tracker);\n                onError(error_1, {\n                    adUnit: adUnit,\n                    vastChain: vastChain\n                });\n                if (!vastChain || isCanceled()) {\n                    onRunFinish();\n                    return [2 /*return*/];\n                }\n                if (options.timeout && runEpoch) {\n                    options.timeout -= Date.now() - runEpoch;\n                }\n                if (runEpoch && options.timeout && options.timeout <= 0) {\n                    onRunFinish();\n                    return [2 /*return*/];\n                }\n                waterfall(function () { return requestNextAd(vastChain, options); }, placeholder, __assign({}, options), isCanceled);\n                return [3 /*break*/, 5];\n            case 5: return [2 /*return*/];\n        }\n    });\n}); };\n/**\n * Will try to start one of the ads returned by the `adTag`. It will keep trying until it times out or it runs out of ads.\n *\n * @param adTag The VAST ad tag request url.\n * @param placeholder placeholder element that will contain the video ad.\n * @param options Options Map\n * @returns CancelFunction function. If called it will cancel the ad run. {@link runWaterfall~onRunFinish} will still be called;\n */\nvar runWaterfall = function (adTag, placeholder, options) {\n    var canceled = false;\n    var adUnit;\n    var isCanceled = function () { return canceled; };\n    var onAdStartHandler = callbackHandler(options.onAdStart);\n    var onAdStart = function (newAdUnit) {\n        adUnit = newAdUnit;\n        onAdStartHandler(adUnit);\n    };\n    var resultOptions = __assign(__assign({ vpaidEnabled: true }, options), { onAdReady: callbackHandler(options.onAdReady), onAdStart: onAdStart, onError: callbackHandler(options.onError), onRunFinish: callbackHandler(options.onRunFinish) });\n    // NOTE: It seems that if the video doesn't load synchronously inside a touchend or click event handler, the user gesture breaks on iOS and it won't allow a play.\n    if (options.videoElement && options.videoElement.paused && isIOS()) {\n        options.videoElement.load();\n    }\n    waterfall(function () { return requestAd(adTag, resultOptions); }, placeholder, resultOptions, isCanceled);\n    return function () {\n        canceled = true;\n        if (adUnit && !adUnit.isFinished()) {\n            adUnit.cancel();\n        }\n    };\n};\nexport default runWaterfall;\n","var isIOS = function () {\n    return /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\n};\nexport default isIOS;\n","import { runWaterfall } from '../src';\nimport './styles.css';\ndocument.addEventListener('DOMContentLoaded', function () {\n    var textArea = document.querySelector('#adTag');\n    var testBtn = document.querySelector('.vast-test-btn');\n    var videoElement = document.querySelector('.vast-media video');\n    var videoAdContainer = document.querySelector('.video-ad-container');\n    var adUnit;\n    var onAdReady = function (newAdUnit) {\n        adUnit = newAdUnit;\n        console.log('### onAdReady', adUnit);\n        var eventHandler = function (event) {\n            console.log(\"### \".concat(event.type), event.adUnit);\n        };\n        [\n            'pause',\n            'resume',\n            'finish',\n            'impression',\n            'start',\n            'skip',\n            'firstQuartile',\n            'midpoint',\n            'thirdQuartile',\n            'complete'\n        ].forEach(function (eventType) {\n            adUnit.on(eventType, eventHandler);\n        });\n    };\n    var requestAdRun = function () {\n        var adTag = textArea.value;\n        var src = videoElement.src;\n        var resumeContent = function () {\n            videoElement.play();\n            videoElement.removeEventListener('contentloadedmetadata', resumeContent);\n            videoElement.removeEventListener('canplay', resumeContent);\n        };\n        var onError = function (error) {\n            console.log('### onError', error);\n        };\n        var onRunFinish = function () {\n            console.log('### onRunFinish');\n            videoAdContainer.classList.remove('active');\n            if (videoElement.src === src) {\n                videoElement.play();\n            }\n            else {\n                videoElement.addEventListener('contentloadedmetadata', resumeContent);\n                videoElement.addEventListener('canplay', resumeContent);\n                videoElement.src = src;\n                videoElement.load();\n            }\n        };\n        videoAdContainer.classList.add('active');\n        videoElement.pause();\n        videoElement.currentTime = 0;\n        console.log('### adTag', adTag);\n        runWaterfall(adTag, videoAdContainer, {\n            onAdReady: onAdReady,\n            onError: onError,\n            onRunFinish: onRunFinish,\n            timeout: 15000,\n            videoElement: videoElement,\n            credentials: 'omit'\n        });\n    };\n    textArea.addEventListener('change', function () {\n        var adTag = textArea.value;\n        if (adTag) {\n            testBtn.classList.add('active');\n            testBtn.addEventListener('click', requestAdRun);\n        }\n        else {\n            testBtn.classList.remove('active');\n            testBtn.removeEventListener('click', requestAdRun);\n        }\n    });\n});\n"],"names":["root","factory","exports","module","define","amd","a","i","self","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","freeGlobal","g","Object","freeSelf","Function","objectToString","prototype","toString","nativeMax","Math","max","nativeMin","min","now","Date","isObject","value","type","toNumber","isObjectLike","call","isSymbol","other","valueOf","replace","isBinary","test","slice","func","wait","options","lastArgs","lastThis","maxWait","result","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","undefined","apply","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","setTimeout","remainingWait","debounced","isInvoking","arguments","this","leadingEdge","cancel","clearTimeout","flush","errorMessagePatterns","RegExp","failOnParseError","doc","errorMessage","Error","parseError","documentElement","tagName","namespaceURI","childNodes","length","nodeName","getParseError","errorNode","node","s","match","content","XMLSerializer","Array","map","serializeToString","join","exec","extractParseError","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","definition","key","o","defineProperty","enumerable","get","globalThis","e","window","obj","prop","hasOwnProperty","r","Symbol","toStringTag","ErrorCode","NodeType","isVastErrorCode","code","values","includes","complete","clickThrough","error","firstQuartile","impression","viewable","notViewable","viewUndetermined","midpoint","mute","pause","playerCollapse","exitFullscreen","playerExpand","fullscreen","progress","resume","rewind","skip","start","thirdQuartile","unmute","iconClick","iconView","closeLinear","creativeView","otherAdInteraction","timeSpentViewing","acceptInvitation","adCollapse","close","_a","count","xmlToJson","nodeType","ELEMENT","TEXT","DOCUMENT","getNodeType","element","Element","attributes","fromEntries","from","attribute","nodeValue","getNodeAttributes","name","toLowerCase","Text","CDATASection","text","trim","getNodeText","children","_b","hasChildNodes","filter","childNode","elements","_i","childNodes_1","childElement","push","getNodeChildren","getChildren","childName","find","toUpperCase","getAll","childrenName","filterChildrenByName","firstChild","getAttributes","attributeName","parser","DOMParser","durationStr","durationInMs","hourStr","minStr","secStr","isNaN","offset","isPercentage","hasLinear","creative","ad","adTypeElement","creativesElement","getTrackingEvent","trackingEventElement","event","uri","eventName","creativeElement","linearElement","trackingEventsElement","trackingEventElements","trackingEvents","filteredEvents","__assign","assign","t","p","formatSize","size","concat","formatPosition","position","getBooleanValue","val","Boolean","compareBySequence","itemA","itemB","itemASequenceString","itemBSequenceString","itemASequence","itemBSequence","getAds","parsedVast","vastElement","ads","getPodAdSequence","sequenceString","sequence","isPodAd","hasAdPod","isArray","getVASTAdTagURI","wrapperElement","vastAdTagURIElement","getViewable","viewableImpression","viewableElements","universalAdIdElement","universalAdId","mediaFilesElement","mediaFileElements","mediaFileElement","src","apiFramework","bitrate","codec","delivery","height","id","maintainAspectRatio","maxBitrate","minBitrate","scalable","width","interactiveFiles","interactiveElements","interactiveElement","getInteractiveCreativeFiles","mediaFiles","getVideoClicksElement","videoClicksElement","clickThroughElement","getSkipOffset","skipoffset","urlMacro","data","img","Image","macro","upperKeysMap","parsedMacro","macroData","keys","forEach","CACHEBUSTING","round","random","TIMESTAMP","toISOString","encodeURIComponent","vastChain","errorCode","tracker","parsedXML","errorURIs","errors","getAdErrorURI","getVastErrorURI","trackingEventSelector","_c","eventSelector","selectors","trackingURIs","getElements","linearTrackingEventSelector","linearTrackers","clickTrackingElements","customClickElements","_vastChain","iconClickTracking","iconClickTracking_1","iconViewTracking","iconViewTracking_1","impressions","notViewableElements","progressUri","viewUndeterminedElements","nonLinearAdsElement","async","_d","defer","placeholder","Promise","resolve","reject","script","document","createElement","scriptPlaceholder","onerror","URIError","onload","currentScript","parentNode","head","appendChild","iframeElement","contentDocument","contentWindow","supported","createBaseIframe","iframe","setAttribute","style","margin","padding","border","location","targetOrigin","iframeContent","origin","protocol","hostname","port","write","removeChild","srcdoc","handleMessage","removeEventListener","addEventListener","nextId","namespace","VideoAdContainer","videoElement","destroyed","readyPromise","adContainer","classList","add","isOriginalVideoElement","video","addScript","_arguments","P","generator","body","f","y","_","label","sent","trys","ops","next","verb","iterator","v","op","done","pop","step","__generator","isDestroyed","executionContext","fulfilled","rejected","then","addSlot","slotElement","slot","cursor","left","top","destroy","_this","removePromise","zIndex","extendStatics","mimeMap","avi","flv","m3u8","m4v","mov","mp4","mpd","ogv","ts","webm","wmv","mediaFile","canPlayType","ext","getRectParams","rect","Number","aspectRatio","floor","getMediaByDefaultBestFit","screenRect","screenParams","sort","mediaFileA","mediaFileB","mediaFileAParams","mediaFileBParams","widthDeltaA","abs","widthDeltaB","inlineAd","container","getMediaFile","getBoundingClientRect","supportedMediaFiles","listener","handler","__spreadArray","to","pack","ar","l","callback","logger","createDefaultSkipControl","skipBtn","innerHTML","bottom","right","volumeChanged","finish","adProgress","percentageProgress","currentTime","duration","isCompleted","isMuted","muted","volume","num","digits","formattedNum","String","hours","minutes","seconds","ms","secondsToMilliseconds","isValid","offsetIsValid","parseFloat","uriIsValid","offsetToMs","createDefaultClickControl","anchor","clickThroughUrl","pauseOnAdClick","_e","createClickControl","isVirtual","contains","HTMLAnchorElement","href","target","onclick","stopPropagation","paused","preventDefault","play","errorHandler","mediaError","VAST_PROBLEM_DISPLAYING_MEDIA_FILE","fullscreenEvtNames","fullscreenOn","fullscreenchangeHandler","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","fullscreenEvtNames_1","event_1","fullscreenEvtNames_2","event_2","started","impressionHandler","playHandler","pauseHandler","progressEvents","playedMs","previousCurrentTime","pendingEvents","progressHandler","delta","reduce","accumulator","toCall","stillPending","contentplayhead","timeupdateHandler","videoAdContainer","skipControl","createSkipControl","skipHandler","currentTimeMs","passFirstQuartile","passMidPoint","passThirdQuartile","completed","events","isFired","isPassFirstQuartile","isPassMidPoint","isPassThirdQuartile","timeUpdateHandler","endedHandler","wasMuted","volumechangeHandler","hooks","accumulated","stopHandlersFns","disconnect","__extends","b","setPrototypeOf","__proto__","__","constructor","create","_super","AdUnitError","message","MutationObserver","WebKitMutationObserver","MozMutationObserver","noop","sizeMutationAttrs","mutationHandlers","observerKey","resizeHandlers","resizeElement","threshold","validate","makeSizeId","clientHeight","clientWidth","lastSize","checkElementHandler","currentSize","stopObservingMutations","observer","mutations","index","observe","characterData","childList","createResizeMO","onMutation","stopListeningToResize","createResizeElement","getComputedStyle","onResize","intersectionHandlers","visibilityHandlers","lastIntersectionEntries","viewabilityOffset","IntersectionObserver","lastIsInViewport","visibilityHandler","entries","entry","isInViewport","hidden","intersectionRatio","stopObservingIntersection","rootMargin","_item","onIntersection","stopListeningToVisibilityChange","_target","execHandlers","onVisibilityChange","Emitter","console","on","removeListener","eventListeners","eListener","removeAllListeners","once","emit","hasListeners","stack","staticResource","htmlResource","iFrameResource","UNKNOWN","chooseByPxRatio","icons","devicePixelRatio","iconA","iconB","pxratio","sortIconByBestPxratio","linearCreativeElement","iconsElement","iconElements","iconElement","program","xPosition","yPosition","getIconAttributes","staticResourceElement","htmlResourceElement","iFrameResourceElement","getIconResource","iconTrackingElements","iconViewTrackingElement","getIconViewTracking","iconClicksElement","iconClickThroughElement","iconClickTrackingElements","iconClickTrackingElement","iconClickThrough","getIconClicks","uniqIcons","uniqValue","seen","item","uniqByResource","byProgram","icon","groupIconsByProgram","chooseIcons","resolvePromise","rejectPromise","pending","promise","cancelOnce","FetchError","endpoint","response","contentType","fetch","headers","status","statusText","normalisedCT","some","allowedType","isValidContentType","noopResource","image","divElement","html","dispatchEvent","CustomEvent","catch","frameBorder","resourceElement_1","resourceErrorWait_1","resourceLoadWait_1","cleanUp_1","calculateArea","newIcon","config","thereIsSpace","drawnIcons","placeholderArea","hasSpace","isWithinTheContentArea","phRect","withinBoundaries","doesNotOverlap","drawnIcon","overlap","withoutOverlaps","createIcon","iconResource","HTMLIFrameElement","HTMLImageElement","onIconClick","pointerEvents","Event","wrapWithClickThrough","updatedIcon","dynamicPos","iconHeight","phHeight","oldSignature","signature","isCustomXposition","dIcon","iconWidth","phWidth","drawnIconsWidth","calculateIconLeft","isCustomYPosition","updated","updateIconElement","currentTimeInMs","videoDurationInMs","iconsToShow","otherIcons","renderedIcon","log","firstRenderPending","onIconView","rest","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__rest","drawIcons","hasPendingIconRedraws","iconsPendingToRedraw","iconsPendingToBeRemoved","removeIcons","removeDrawnIcons","screen","_private","_protected","VideoAdUnit","previousTime","skipAttempts","preventAdSkip","preventAdSeek","viewability","_f","responsive","_g","_h","addIcons","adUnit","onFinishCallbacks","setupViewableImpression","timeoutId","unsubscribe","visible","isFinished","handleViewableImpression","setupViewability","setupResponsive","viewmode","prevSize","resize","finished","onErrorCallbacks","throwIfCalled","throwIfFinished","setVolume","_volume","getVolume","onFinish","onError","isStarted","mode","errorEvt","VastAdUnit","handleMetric","removeMetricHandlers","media","adUnitError","assetUri","VAST_LINEAR_ASSET_MISMATCH","state","playing","load","SUPPORTED_MIMETYPES","mimetype","getVPAIDAd","getAdIcons","adLoaded","adStarted","adStopped","adSkipped","adSizeChange","adDurationChange","adRemainingTimeChange","adVolumeChange","adImpression","adVideoStart","adVideoFirstQuartile","adVideoMidpoint","adVideoThirdQuartile","adVideoComplete","adClickThru","adUserAcceptInvitation","adUserMinimize","adUserClose","adPaused","adPlaying","adError","EVENTS","creativeAd","timeout","subscribe","method","waitPromise","creativeMethod","major","version","parts","split","VPAID_EVENTS","VpaidAdUnit","evtHandler","url","_id","playerHandles","handleClickThrough","payload","VPAID_ERROR","vpaidGeneralError","videoStart","handleVpaidEvent","open","getIcons","loadCreativePromise","adLoadedPromise","VPAID_EVENTS_1","creativeEvt","error_2","bind","supportedVersion","creativeVersion","creativeMajorNum","linearContent","AdParameters","xmlEncoded","creativeData","xml","XML","getAdParametersContent","getXmlEncodedValue","environmentVars","videoSlot","videoSlotCanAutoPlay","initAd","adStoppedPromise","remainingTime","linearEvent","evtType","linearTracker","nonLinearEvent","VastError","startAdUnit","onAdReady","createRejectHandler","tryToStartVpaidAd","VAST_MEDIA_FILE_NOT_FOUND","startVastAd","error_1","adUnitPromise","timedOut_1","timeoutId_1","timeoutPromise","_resolve","VAST_MEDIA_LOAD_TIMEOUT","race","newAdUnit","defaults","fetchOptions","credentials","requested","markAdAsRequested","parseVastXml","xmlText","xmlDom","parseFromString","VAST_XML_PARSING_ERROR","requestAd","adTag","vastAdResponse","epoch","resultOptions","fetchPromise","requestTag","parentAd","wrapperOptions","allowMultipleAds","fallbackOnNoAd","followAdditionalWrappers","getWrapperOptions","getOptions","wrapperLimit","VAST_TOO_MANY_REDIRECTS","validateChain","VAST_NONLINEAR_LOADING_FAILED","fetchAdXML","VAST_LOAD_TIMEOUT","getFirstAd","VAST_NO_ADS_AFTER_WRAPPER","getAd","VAST_SCHEMA_VALIDATION_ERROR","VAST_UNEXPECTED_MEDIA_FILE","VAST_UNEXPECTED_AD_TYPE","validateResponse","UNKNOWN_ERROR","requestNextAd","vastResponse","nextAd","nextPodSequence","useAdBuffet","availableAds","adDefinition","hasAdBeenRequested","newVastChain","callbackHandler","transformVastResponse","waterfall","fetchVastChain","isCanceled","runEpoch","onAdStart","onRunFinish","newEpoch","lastVastResponse","vpaidEnabled","isVpaid","validateVastResponse","validateVastChain","handleVastError","canceled","onAdStartHandler","navigator","userAgent","MSStream","textArea","querySelector","testBtn","eventHandler","eventType","requestAdRun","resumeContent","remove"],"sourceRoot":""}