{"version":3,"file":"demo.js","mappings":"CAAA,SAA2CA,EAAMC,GAChD,GAAsB,iBAAZC,SAA0C,iBAAXC,OACxCA,OAAOD,QAAUD,SACb,GAAqB,mBAAXG,QAAyBA,OAAOC,IAC9CD,OAAO,GAAIH,OACP,CACJ,IAAIK,EAAIL,IACR,IAAI,IAAIM,KAAKD,GAAuB,iBAAZJ,QAAuBA,QAAUF,GAAMO,GAAKD,EAAEC,EACvE,CACA,CATD,CASGC,MAAM,WACT,O,sCCAA,IASIC,EAAS,aAGTC,EAAa,qBAGbC,EAAa,aAGbC,EAAY,cAGZC,EAAeC,SAGfC,EAA8B,iBAAV,EAAAC,GAAsB,EAAAA,GAAU,EAAAA,EAAOC,SAAWA,QAAU,EAAAD,EAGhFE,EAA0B,iBAARV,MAAoBA,MAAQA,KAAKS,SAAWA,QAAUT,KAGxER,EAAOe,GAAcG,GAAYC,SAAS,cAATA,GAUjCC,EAPcH,OAAOI,UAOQC,SAG7BC,EAAYC,KAAKC,IACjBC,EAAYF,KAAKG,IAkBjBC,EAAM,WACR,OAAO5B,EAAK6B,KAAKD,KACnB,EA2MA,SAASE,EAASC,GAChB,IAAIC,SAAcD,EAClB,QAASA,IAAkB,UAARC,GAA4B,YAARA,EACzC,CA2EA,SAASC,EAASF,GAChB,GAAoB,iBAATA,EACT,OAAOA,EAET,GAhCF,SAAkBA,GAChB,MAAuB,iBAATA,GAtBhB,SAAsBA,GACpB,QAASA,GAAyB,iBAATA,CAC3B,CAqBKG,CAAaH,IAzTF,mBAyTYX,EAAee,KAAKJ,EAChD,CA6BMK,CAASL,GACX,OA3VM,IA6VR,GAAID,EAASC,GAAQ,CACnB,IAAIM,EAAgC,mBAAjBN,EAAMO,QAAwBP,EAAMO,UAAYP,EACnEA,EAAQD,EAASO,GAAUA,EAAQ,GAAMA,CAC3C,CACA,GAAoB,iBAATN,EACT,OAAiB,IAAVA,EAAcA,GAASA,EAEhCA,EAAQA,EAAMQ,QAAQ9B,EAAQ,IAC9B,IAAI+B,EAAW7B,EAAW8B,KAAKV,GAC/B,OAAQS,GAAY5B,EAAU6B,KAAKV,GAC/BlB,EAAakB,EAAMW,MAAM,GAAIF,EAAW,EAAI,GAC3C9B,EAAW+B,KAAKV,GAxWb,KAwW6BA,CACvC,CAEA5B,EAAOD,QAtPP,SAAkByC,EAAMC,EAAMC,GAC5B,IAAIC,EACAC,EACAC,EACAC,EACAC,EACAC,EACAC,EAAiB,EACjBC,GAAU,EACVC,GAAS,EACTC,GAAW,EAEf,GAAmB,mBAARZ,EACT,MAAM,IAAIa,UArIQ,uBA+IpB,SAASC,EAAWC,GAClB,IAAIC,EAAOb,EACPc,EAAUb,EAKd,OAHAD,EAAWC,OAAWc,EACtBT,EAAiBM,EACjBT,EAASN,EAAKmB,MAAMF,EAASD,EAE/B,CAmBA,SAASI,EAAaL,GACpB,IAAIM,EAAoBN,EAAOP,EAM/B,YAAyBU,IAAjBV,GAA+Ba,GAAqBpB,GACzDoB,EAAoB,GAAOV,GANJI,EAAON,GAM8BJ,CACjE,CAEA,SAASiB,IACP,IAAIP,EAAO9B,IACX,GAAImC,EAAaL,GACf,OAAOQ,EAAaR,GAGtBR,EAAUiB,WAAWF,EAzBvB,SAAuBP,GACrB,IAEIT,EAASL,GAFWc,EAAOP,GAI/B,OAAOG,EAAS5B,EAAUuB,EAAQD,GAHRU,EAAON,IAGkCH,CACrE,CAmBqCmB,CAAcV,GACnD,CAEA,SAASQ,EAAaR,GAKpB,OAJAR,OAAUW,EAINN,GAAYT,EACPW,EAAWC,IAEpBZ,EAAWC,OAAWc,EACfZ,EACT,CAcA,SAASoB,IACP,IAAIX,EAAO9B,IACP0C,EAAaP,EAAaL,GAM9B,GAJAZ,EAAWyB,UACXxB,EAAWyB,KACXrB,EAAeO,EAEXY,EAAY,CACd,QAAgBT,IAAZX,EACF,OAvEN,SAAqBQ,GAMnB,OAJAN,EAAiBM,EAEjBR,EAAUiB,WAAWF,EAAcrB,GAE5BS,EAAUI,EAAWC,GAAQT,CACtC,CAgEawB,CAAYtB,GAErB,GAAIG,EAGF,OADAJ,EAAUiB,WAAWF,EAAcrB,GAC5Ba,EAAWN,EAEtB,CAIA,YAHgBU,IAAZX,IACFA,EAAUiB,WAAWF,EAAcrB,IAE9BK,CACT,CAGA,OAxGAL,EAAOX,EAASW,IAAS,EACrBd,EAASe,KACXQ,IAAYR,EAAQQ,QAEpBL,GADAM,EAAS,YAAaT,GACHtB,EAAUU,EAASY,EAAQG,UAAY,EAAGJ,GAAQI,EACrEO,EAAW,aAAcV,IAAYA,EAAQU,SAAWA,GAiG1Dc,EAAUK,OAnCV,gBACkBb,IAAZX,GACFyB,aAAazB,GAEfE,EAAiB,EACjBN,EAAWK,EAAeJ,EAAWG,OAAUW,CACjD,EA8BAQ,EAAUO,MA5BV,WACE,YAAmBf,IAAZX,EAAwBD,EAASiB,EAAatC,IACvD,EA2BOyC,CACT,C,iCCxPA,IAoCIQ,EAAuB,CAEvB,IAAIC,OAAO,mFAEX,IAAIA,OAAO,YA+Bf5E,EAAQ6E,iBAAmB,SAAUC,GAGjC,OAjBmB,SAAUA,GAC7B,IAAIC,EAEJ,GAAY,OAARD,EACA,MAAM,IAAIE,MAAM,eAGpB,IAAIC,EAzDY,SAAUH,GAE1B,MAAoC,gBAAhCA,EAAII,gBAAgBC,SACiB,yDAArCL,EAAII,gBAAgBE,aACbN,EAAII,iBAIsB,QAAhCJ,EAAII,gBAAgBC,SAAqD,SAAhCL,EAAII,gBAAgBC,UAC9DL,EAAII,gBAAgBG,YACpBP,EAAII,gBAAgBG,WAAWC,OAAS,GACO,gBAA/CR,EAAII,gBAAgBG,WAAW,GAAGE,SAC3BT,EAAII,gBAAgBG,WAAW,GAIN,SAAhCP,EAAII,gBAAgBC,SACpBL,EAAII,gBAAgBG,YACpBP,EAAII,gBAAgBG,WAAWC,OAAS,GACO,SAA/CR,EAAII,gBAAgBG,WAAW,GAAGE,UAClCT,EAAII,gBAAgBG,WAAW,GAAGA,YAClCP,EAAII,gBAAgBG,WAAW,GAAGA,WAAWC,QACgB,gBAA7DR,EAAII,gBAAgBG,WAAW,GAAGA,WAAW,GAAGE,SACzCT,EAAII,gBAAgBG,WAAW,GAAGA,WAAW,QAPxD,CAWJ,CA8BqBG,CAAcV,GAC/B,QAAmBnB,IAAfsB,EAEA,MADAF,EAvBgB,SAAUU,GAC9B,IA5CqBC,EACjBC,EA4CAtF,EAAGuF,EADHC,GA5CiBH,EA4CED,EA3CnBE,EAAI,IAAIG,cACLC,MAAM5E,UAAU6E,IAAI/D,KAAKyD,EAAKL,YAAY,SAAUK,GACvD,OAAOC,EAAEM,kBAAkBP,EAC/B,IAAGQ,KAAK,KA2CR,IAAI7F,EAAI,EAAGA,EAAIsE,EAAqBW,OAAQjF,IAGxC,GAFAuF,EAAQjB,EAAqBtE,GAAG8F,KAAKN,GAGjC,OAAOD,EAAM,EAIzB,CAWuBQ,CAAkBnB,IAAe,cAC1C,IAAID,MAAMD,EAExB,CAGIF,CAAiBC,GAEVA,CACX,C,GC5EIuB,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqB5C,IAAjB6C,EACH,OAAOA,EAAaxG,QAGrB,IAAIC,EAASoG,EAAyBE,GAAY,CAGjDvG,QAAS,CAAC,GAOX,OAHAyG,EAAoBF,GAAUtG,EAAQA,EAAOD,QAASsG,GAG/CrG,EAAOD,OACf,CCrBAsG,EAAoBI,EAAI,SAASzG,GAChC,IAAI0G,EAAS1G,GAAUA,EAAO2G,WAC7B,WAAa,OAAO3G,EAAgB,OAAG,EACvC,WAAa,OAAOA,CAAQ,EAE7B,OADAqG,EAAoBO,EAAEF,EAAQ,CAAEvG,EAAGuG,IAC5BA,CACR,ECNAL,EAAoBO,EAAI,SAAS7G,EAAS8G,GACzC,IAAI,IAAIC,KAAOD,EACXR,EAAoBU,EAAEF,EAAYC,KAAST,EAAoBU,EAAEhH,EAAS+G,IAC5EhG,OAAOkG,eAAejH,EAAS+G,EAAK,CAAEG,YAAY,EAAMC,IAAKL,EAAWC,IAG3E,ECPAT,EAAoBxF,EAAI,WACvB,GAA0B,iBAAfsG,WAAyB,OAAOA,WAC3C,IACC,OAAO9C,MAAQ,IAAIrD,SAAS,cAAb,EAChB,CAAE,MAAOoG,GACR,GAAsB,iBAAXC,OAAqB,OAAOA,MACxC,CACA,CAPuB,GCAxBhB,EAAoBU,EAAI,SAASO,EAAKC,GAAQ,OAAOzG,OAAOI,UAAUsG,eAAexF,KAAKsF,EAAKC,EAAO,ECCtGlB,EAAoBoB,EAAI,SAAS1H,GACX,oBAAX2H,QAA0BA,OAAOC,aAC1C7G,OAAOkG,eAAejH,EAAS2H,OAAOC,YAAa,CAAE/F,MAAO,WAE7Dd,OAAOkG,eAAejH,EAAS,aAAc,CAAE6B,OAAO,GACvD,E,wCCNO,IAAIgG,E,OACX,SAAWA,GACPA,EAAUA,EAAkC,uBAAI,KAAO,yBACvDA,EAAUA,EAAwC,6BAAI,KAAO,+BAC7DA,EAAUA,EAAoC,yBAAI,KAAO,2BACzDA,EAAUA,EAAmC,wBAAI,KAAO,0BACxDA,EAAUA,EAAqC,0BAAI,KAAO,4BAC1DA,EAAUA,EAA0C,+BAAI,KAAO,iCAC/DA,EAAUA,EAAsC,2BAAI,KAAO,6BAC3DA,EAAUA,EAA8B,mBAAI,KAAO,qBACnDA,EAAUA,EAA6B,kBAAI,KAAO,oBAClDA,EAAUA,EAAmC,wBAAI,KAAO,0BACxDA,EAAUA,EAAqC,0BAAI,KAAO,4BAC1DA,EAAUA,EAA4B,iBAAI,KAAO,mBACjDA,EAAUA,EAAqC,0BAAI,KAAO,4BAC1DA,EAAUA,EAAmC,wBAAI,KAAO,0BACxDA,EAAUA,EAAsC,2BAAI,KAAO,6BAC3DA,EAAUA,EAA8C,mCAAI,KAAO,qCACnEA,EAAUA,EAAyC,8BAAI,KAAO,gCAC9DA,EAAUA,EAA2C,gCAAI,KAAO,kCAChEA,EAAUA,EAAyC,8BAAI,KAAO,gCAC9DA,EAAUA,EAAyC,8BAAI,KAAO,gCAC9DA,EAAUA,EAAyB,cAAI,KAAO,gBAC9CA,EAAUA,EAAuB,YAAI,KAAO,aAC/C,CAvBD,CAuBGA,IAAcA,EAAY,CAAC,IACvB,MAAMC,EAAmBC,GAAShH,OAAOiH,OAAOH,GAAWI,SAASF,GCf9DG,EAAW,WAMXC,EAAe,eAMfC,EAAQ,QAMRC,EAAgB,gBAMhBC,EAAa,aAMbC,EAAW,WAMXC,EAAc,cAMdC,EAAmB,mBAMnBC,EAAW,WAMXC,EAAO,OAYPC,EAAQ,QAMRC,EAAiB,iBAMjBC,EAAiB,iBAMjBC,EAAe,eAMfC,EAAa,aAMbC,EAAW,WAMXC,EAAS,SAMTC,EAAS,SAMTC,EAAO,OAMPC,EAAQ,QAMRC,EAAgB,gBAYhBC,EAAS,SAMTC,EAAY,YAMZC,EAAW,WAMXC,EAAc,cAMdC,EAAe,eA+B5B,MA9BqB,CACjBxB,eACAuB,cACAxB,WACAyB,eACAvB,QACAU,iBACAT,gBACAW,aACAQ,YACAC,WACAnB,aACAI,WACAC,OACAH,cACAoB,mBAtH8B,qBAuH9BhB,QACAC,iBACAE,eACAE,WACAC,SACAC,SACAC,OACAC,QACAC,gBACAO,iBAxD4B,mBAyD5BN,SACAhB,WACAE,oBC/LG,MAAMqB,EAAmB,mBAMnBC,EAAa,aAMb,EAAQ,QAMrB,ICzBWC,EDyBX,EALwB,CACpBF,mBACAC,aACAE,MAAK,G,UCtBT,SAAWD,GACPA,EAAgB,MAAI,QACpBA,EAAmB,SAAI,WACvBA,EAAkB,QAAI,UACtBA,EAAe,KAAI,MACtB,CALD,CAKGA,IAAaA,EAAW,CAAC,ICR5B,MAsCME,EAAaxE,IACf,MAAM5D,EAvCU,CAAC4D,IACjB,OAAQA,EAAKyE,UACT,KAAK,EACD,OAAOH,EAASI,QACpB,KAAK,EACL,KAAK,EACD,OAAOJ,EAASK,KACpB,KAAK,EACD,OAAOL,EAASM,SACpB,QACI,MAAM,IAAItF,MAAM,4BACxB,EA4BauF,CAAY7E,GACnB8E,EAAU,CACZ1I,QAEJ,GAAI4D,aAAgB+E,QAAS,CACzB,MAAMC,EA/BY,CAAChF,GAAoC,IAA3BA,EAAKgF,WAAWpF,YAC9C3B,EACA5C,OAAO4J,YAAY5E,MAAM6E,KAAKlF,EAAKgF,YAAY1E,KAAK6E,IAClD,IAAIC,EACJ,MAAO,CACHD,EAAUtF,SACqB,QAA9BuF,EAAKD,EAAUE,iBAA8B,IAAPD,EAAgBA,OAAKnH,EAC/D,KAwBkBqH,CAAkBtF,GACjCgF,IACAF,EAAQE,WAAaA,GAEzBF,EAAQS,KAAOvF,EAAKH,SAAS2F,aACjC,MACSxF,aAAgByF,MAAQzF,aAAgB0F,gBAC7CZ,EAAQa,KA7BI,CAAC3F,IAAW,IAAIoF,EAAI,OAAiC,QAAzBA,EAAKpF,EAAKqF,iBAA8B,IAAPD,OAAgB,EAASA,EAAGzI,QAAQ,YAAa,IAAIA,QAAQ,MAAO,IAAIiJ,MAAM,EA6BxIC,CAAY7F,IAE/B,MAAM8F,EA9Bc,CAAC9F,IACrB,IAAIoF,EAAIW,EACR,IAAK/F,EAAKgG,gBACN,OAEJ,MAAMrG,EAAaU,MAAM6E,KAAKlF,EAAKL,YAAYsG,QAAQC,GAAc,CAAC,EAAG,EAAG,GAAG3D,SAAS2D,EAAUzB,YAC5F0B,EAAW,GACjB,IAAK,MAAMD,KAAavG,EAAY,CAChC,MAAMyG,EAAe5B,EAAU0B,GACzBA,aAAqBT,SAA6F,QAAlFM,EAAkC,QAA5BX,EAAKgB,EAAaT,YAAyB,IAAPP,OAAgB,EAASA,EAAGxF,cAA2B,IAAPmG,EAAgBA,EAAK,GAAK,IACtJI,EAASE,KAAKD,EAEtB,CACA,OAAOD,CAAQ,EAiBEG,CAAgBtG,GAIjC,OAHI8F,IACAhB,EAAQqB,SAAWL,GAEhBhB,CAAO,EAElB,QC5DA,MAAMyB,EAAezB,IAAc,IAAIM,EAAI,OAAmC,QAA3BA,EAAKN,EAAQqB,gBAA6B,IAAPf,EAAgBA,EAAK,EAAE,EAUhG,EATW,CAACN,EAAS0B,IAAcD,EAAYzB,GAAS2B,MAAK,EAAGlB,OAAO,MAASA,EAAKmB,gBAAkBF,EAAUE,gBAiBjHC,EAAS,CAAC7B,EAAS0B,IACH,iBAAdA,EAjBc,EAAC1B,EAAS8B,IAAiBL,EAAYzB,GAASmB,QAAO,EAAGV,OAAO,MAASA,EAAKmB,gBAAkBE,EAAaF,gBAkB5HG,CAAqB/B,EAAS0B,GAElCD,EAAYzB,GAOV,EAAiBA,GAAYyB,EAAYzB,GAAS,GAMlD,EAAWA,IACpB,MAAMgC,EAAahC,GAAW,EAAcA,GAC5C,OAAOgC,GAAcA,EAAWnB,IAAI,EAO3BoB,EAAiBjC,IAAc,IAAIM,EAAI,OAAqC,QAA7BA,EAAKN,EAAQE,kBAA+B,IAAPI,EAAgBA,EAAK,CAAC,CAAC,EAM3G,EAAe,CAACN,EAASkC,IAAkBD,EAAcjC,GAASkC,GChDzEC,EAAS,IAAIC,UCgBnB,MAfmBC,IACf,GAA2B,iBAAhBA,EAA0B,CACjC,MAAMC,EAAgB,oCAChBlH,EAAQiH,EAAYjH,MAAMkH,GAChC,GAAIlH,EAAO,CACP,MAAMmH,GARMC,EAQwBpH,EAAM,GARM,GAAxBhF,SAASoM,EAAS,IAAW,GAAK,KAChDC,EAQOrH,EAAM,GARqB,GAAvBhF,SAASqM,EAAQ,IAAW,MACvCC,EAQOtH,EAAM,GARqB,IAAvBhF,SAASsM,EAAQ,MASjCtH,EAAM,GAAKhF,SAASgF,EAAM,GAAI,IAAM,IACzC,IAAKuH,MAAMJ,GACP,OAAOA,CAEf,CACJ,CAdiB,IAACG,EADAD,EADED,CAgBpB,ECLJ,EANqBI,GAJA,CAACA,GACM,kBACD7K,KAAK6K,GAGxBC,CAAaD,GACNA,EAEJ,EAAUA,GCRrB,MAAME,EAAaC,GAAa,EAAIA,EAAU,UAM9C,MAL2BC,IACvB,MAAMC,EAAgB,EAAcD,GAC9BE,EAAmBD,GAAiB,EAAIA,EAAe,aAC7D,OAAOC,GAAoBrB,EAAOqB,GAAkBvB,KAAKmB,EAAU,ECFvE,MAAMK,EAAoBC,IACtB,MAAM,MAAEC,EAAK,OAAET,GAAWX,EAAcmB,GAClCE,EAAM,EAAQF,GACpB,MAAO,CACHC,QACAT,OAAQA,GAAU,EAAYA,GAC9BU,MACH,EAyBL,MAhBgC,CAACN,EAAIO,KACjC,MAAMC,EAAkBR,GAAM,EAAkBA,GAC1CS,EAAgBD,GAAmB,EAAIA,EAAiB,UACxDE,EAAwBD,GAAiB,EAAIA,EAAe,kBAC5DE,EAAwBD,GAAyB7B,EAAO6B,EAAuB,YACrF,GAAIC,GAAyBA,EAAsB7I,OAAS,EAAG,CAC3D,MAAM8I,EAAiBD,EAAsBnI,IAAI2H,GACjD,IAAKI,EACD,OAAOK,EAEX,MAAMC,EAAiBD,EAAezC,QAAO,EAAGkC,WAAYA,IAAUE,IACtE,GAAIM,EAAe/I,OAAS,EACxB,OAAO+I,CAEf,GC9BJ,MAAMC,EAAcC,IAChB,MAAM3I,EAAQ,GAAG2I,IAAO3I,MAAM,QAC9B,OAAOhF,UAAUgF,aAAqC,EAASA,EAAM,KAAO,GAAI,GAAG,EAEjF4I,GAAkBC,GACG,MAAMlM,KAAKkM,GAEvBH,EAAWG,GAEfA,EAwEX,OATkBjB,IACd,MAAMkB,EAAwBlB,GAAM,EAAkBA,GAChDS,EAAgBS,GAAyB,EAAIA,EAAuB,UACpEC,EAAeV,GAAiB,EAAIA,EAAe,SACnDW,EAAeD,GAAgBtC,EAAOsC,EAAc,QAC1D,GAAIC,GAAgBA,EAAatJ,OAAS,EACtC,OAAOsJ,EAAa5I,KAAK6I,GAAiB9N,OAAO+N,OAAO/N,OAAO+N,OAAO/N,OAAO+N,OAAO/N,OAAO+N,OAAO,CAAC,EAnEjF,CAACD,IACvB,MAAM,SAAEE,EAAQ,OAAEC,EAAM,OAAE5B,EAAM,QAAE6B,EAAO,QAAEC,EAAO,MAAEC,EAAK,UAAEC,EAAY,QAAO,UAAEC,EAAY,OAAU5C,EAAcoC,GACpH,MAAO,CACHE,SAAWA,GAAY,EAAUA,SAAcpL,EAC/CqL,OAASA,GAAUV,EAAWU,SAAYrL,EAC1CyJ,OAASA,GAAU,EAAUA,SAAYzJ,EACzCsL,UACAC,QAAUA,GAAWtO,SAASsO,EAAS,UAAQvL,EAC/CwL,MAAQA,GAASb,EAAWa,SAAWxL,EACvCyL,UAAWA,GAAaZ,GAAeY,GACvCC,UAAWA,GAAab,GAAea,GAC1C,EAwDyGC,CAAkBT,IAtDxG,CAACA,IACrB,MAAMU,EAAwB,EAAIV,EAAa,kBACzCW,EAAsB,EAAIX,EAAa,gBACvCY,EAAwB,EAAIZ,EAAa,kBAC/C,OAAIU,EACO,CAAEG,eAAgB,EAAQH,IAEjCC,EACO,CAAEG,aAAc,EAAQH,IAE/BC,EACO,CAAEG,eAAgB,EAAQH,IAE9B,CACHC,eAAgB,EAAQb,GAC3B,EAuC0IgB,CAAgBhB,IArCnI,CAACA,IACzB,MAAMiB,EAAuBzD,EAAOwC,EAAa,oBAC5C7I,KAAK+J,GAA4B,EAAQA,KACzCpE,OAAOqE,SACZ,OAAoC,IAAhCF,EAAqBxK,OACd,CAAC,EAEL,CACH2K,iBAAkBH,EACrB,EA4ByKI,CAAoBrB,IA1B5K,CAACA,IACnB,MAAMsB,EAAoB,EAAItB,EAAa,cACrCuB,EAA0BD,GAAqB,EAAIA,EAAmB,oBACtEE,EAA4BF,GAC9B9D,EAAO8D,EAAmB,qBACrBnK,KAAKsK,GAA6B,EAAQA,KAC1C3E,OAAOqE,SAChB,MAAO,CACHO,iBAAkBH,GAA2B,EAAQA,GACrDI,kBAAmBH,GAA6BA,EAA0B/K,OAAS,EAC7E+K,OACA1M,EACT,EAc4M8M,CAAc5B,KAC3N,EC5EJ,MAAM6B,GAAmBC,GACF,iBAARA,EACQ,SAARA,EAEJX,QAAQW,GAEbC,GAAoB,CAACC,EAAOC,KAC9B,MAAMC,EAAsB,EAAaF,EAAO,YAC1CG,EAAsB,EAAaF,EAAO,YAC1CG,EAAgBF,GAAuBnQ,SAASmQ,EAAqB,IACrEG,EAAgBF,GAAuBpQ,SAASoQ,EAAqB,IAC3E,MAA6B,iBAAlBC,GAAuD,iBAAlBC,EACrC,EAEPD,EAAgBC,GACR,EAERD,EAAgBC,EACT,EAEJ,CAAC,EAQCC,GAAUC,IACnB,MAAMC,EAAcD,GAAc,EAAIA,EAAY,QAC5CE,EAAMD,GAAehF,EAAOgF,EAAa,MAC/C,OAAIC,GAAOA,EAAIhM,OAAS,EACbgM,EAEJ,EAAE,EAqBAC,GAAoB/D,IAC7B,MAAMgE,EAAiB,EAAahE,EAAI,YAClCiE,EAAWD,GAAkB5Q,SAAS4Q,EAAgB,IAC5D,GAAwB,iBAAbC,IAA0BtE,MAAMsE,GACvC,OAAOA,CACX,EAQSC,GAAWlE,GAAOwC,QAAQuB,GAAiB/D,IAO3CmE,GAAYP,IACrB,MAAME,EAAMH,GAAOC,GACnB,OAAOrL,MAAM6L,QAAQN,IAAQA,EAAI3F,OAAO+F,IAASpM,OAAS,CAAC,EA8BlD,GAAakI,GAAOwC,QAAQ,EAAIxC,GAAM,CAAC,EAAG,YAc1CqE,GAAmBrE,IAC5B,MAAMsE,EAAiB,EAAItE,EAAI,WACzBuE,EAAsBD,GAAkB,EAAIA,EAAgB,gBAClE,OAAOC,GAAuB,EAAQA,EAAoB,EA2DjDC,GAAexE,IACxB,MAAMC,EAAgBD,GAAM,EAAcA,GACpCyE,EAAqBxE,GAAiB,EAAIA,EAAe,sBACzDyE,EAAmBD,GAAsB5F,EAAO4F,EAAoB,YAC1E,GAAIC,GAAoBA,EAAiB5M,OAAS,EAC9C,OAAO4M,EACFlM,KAAKwE,IAAc,IAAIM,EAAI,OAAmC,QAA3BA,EAAK,EAAQN,UAA6B,IAAPM,EAAgBA,EAAK,EAAE,IAC7Fa,OAAOqE,QAChB,EAwCS,GAAiBxC,IAC1B,MAAMQ,EAAkBR,GAAM,EAAkBA,GAC1C2E,EAAuBnE,GAAmB,EAAIA,EAAiB,iBAC/DoE,EAAgBD,GAAwB,EAAQA,GAChDlE,EAAgBD,GAAmB,EAAIA,EAAiB,UACxDqE,EAAoBpE,GAAiB,EAAIA,EAAe,cACxDqE,EAAoBD,GAAqBhG,EAAOgG,EAAmB,aACzE,GAAIC,GAAqBA,EAAkBhN,OAAS,EAChD,OAAOgN,EAAkBtM,KAAKuM,IAC1B,MAAMC,EAAM,EAAQD,IACd,aAAEE,EAAY,QAAEC,EAAO,MAAEC,EAAK,SAAEC,EAAQ,OAAE5D,EAAM,GAAE6D,EAAE,oBAAEC,EAAmB,WAAEC,EAAU,WAAEC,EAAU,SAAEC,EAAQ,KAAEnR,EAAI,MAAEqN,GAAU1C,EAAc8F,GACjJ,MAAO,CACHE,eACAC,UACAC,QACAC,WACA5D,SACA6D,KACAC,sBACAC,aACAC,aACAC,WACAT,MACA1Q,OACAsQ,gBACAjD,QACH,GAET,EA+BS,GAAuB3B,IAChC,IAAI0F,EAxBmC,CAAC1F,IACxC,MAAMQ,EAAkBR,GAAM,EAAkBA,GAC1CS,EAAgBD,GAAmB,EAAIA,EAAiB,UACxDqE,EAAoBpE,GAAiB,EAAIA,EAAe,cACxDkF,EAAsBd,GAAqBhG,EAAOgG,EAAmB,2BAC3E,GAAIc,GAAuBA,EAAoB7N,OAAS,EACpD,OAAO6N,EAAoBnN,KAAKoN,IAC5B,MAAM,aAAEX,EAAY,KAAE3Q,GAAS2K,EAAc2G,GAE7C,MAAO,CACHX,eACAD,IAHQ,EAAQY,GAIhBtR,OACH,GAET,EASuBuR,CAA4B7F,GACnD,GAAI0F,EACA,OAAOA,EAEX,MAAMI,EAAa,GAAc9F,GACjC,OAAI8F,IACAJ,EAAmBI,EACd3H,QAAO,EAAG8G,eAAe,MAAsG,WAA5FA,aAAmD,EAASA,EAAavH,iBAC5GlF,KAAI,EAAGyM,eAAcD,MAAK1Q,WAAW,CACtC2Q,eACAD,MACA1Q,WAEAoR,EAAiB5N,OAAS,GACnB4N,OATf,CAWA,EAEEK,GAAyB/F,IAC3B,MAAMQ,EAAkBR,GAAM,EAAkBA,GAC1CS,EAAgBD,GAAmB,EAAIA,EAAiB,UAC9D,OAAOC,GAAiB,EAAIA,EAAe,cAAc,EAQhD,GAAmBT,IAC5B,MAAMgG,EAAqBD,GAAsB/F,GAC3CiG,EAAsBD,GAAsB,EAAIA,EAAoB,gBAC1E,OAAOC,GAAuB,EAAQA,EAAoB,EAsCjDC,GAAiBlG,IAC1B,MAAMQ,EAAkBR,GAAM,EAAkBA,GAC1CS,EAAgBD,GAAmB,EAAIA,EAAiB,UACxD2F,EAAa1F,GAAiB,EAAaA,EAAe,cAChE,OAAO0F,GAAc,EAAYA,EAAW,EClVhD,ICpBA,GALqB,CAACC,EAAUC,KAC5B,MAAMC,EAAM,IAAIC,MAEhB,OADAD,EAAItB,IDMW,EAACwB,EAAOH,EAAO,CAAC,KAC/B,IAAII,EAAcD,EAClB,MAAME,EAlBU,CAAClO,IACjB,MAAMmO,EAAe,CAAC,EAItB,OAHApT,OAAOqT,KAAKpO,GAAKqO,SAAStN,IACtBoN,EAAapN,EAAIqF,eAAiBpG,EAAIe,EAAI,IAEvCoN,CAAY,EAaDG,CAAYT,GAa9B,OAZKK,EAAUK,eACXL,EAAUK,aAAejT,KAAKkT,MAAsB,KAAhBlT,KAAKmT,WAExCP,EAAUQ,YACXR,EAAUQ,WAAY,IAAI/S,MAAOgT,eAErC5T,OAAOqT,KAAKF,GAAWG,SAAStN,IAC5B,MAAMlF,EAAQ+S,mBAAmBV,EAAUnN,IAC3CkN,EAAcA,EAAY5R,QAE1B,IAAIuC,OAAO,MAAQmC,EAAM,MAAO,MAAOlF,EAAM,IAE1CoS,CAAW,ECrBR,CAAWL,EAAUC,GACxBC,CAAG,ECKd,GARmB,CAACe,GAAaC,YAAWC,UAAU,OAClDF,EAAUR,SAAQ,EAAG7G,KAAIwH,gBACrB,MAAMC,EAAazH,GHuJE,CAACA,IAC1B,MAAMC,EAAgBD,GAAM,EAAcA,GACpC0H,EAASzH,GAAiBpB,EAAOoB,EAAe,SACtD,GAAIyH,GAAUA,EAAO5P,OAAS,EAC1B,OAAO4P,EAAOlP,KAAKoC,IAAY,IAAI0C,EAAI,OAAiC,QAAzBA,EAAK,EAAQ1C,UAA2B,IAAP0C,EAAgBA,EAAK,EAAE,IAAKa,OAAOqE,QACvH,EG5J6BmF,CAAc3H,IHsChB,CAAC4D,IAC5B,MAAMC,EAAcD,GAAc,EAAIA,EAAY,QAC5C8D,EAAS7D,GAAehF,EAAOgF,EAAa,SAClD,GAAI6D,GAAUA,EAAO5P,OAAS,EAC1B,OAAO4P,EAAOlP,KAAKoC,IAAY,IAAI0C,EAAI,OAAiC,QAAzBA,EAAK,EAAQ1C,UAA2B,IAAP0C,EAAgBA,EAAK,EAAE,IAAKa,OAAOqE,QACvH,EG3CmDoF,CAAgBJ,GAC3DC,GACAA,EAAUjP,KAAK8H,GAAQA,GAAOiH,EAAQjH,EAAK,CAAEgH,eACjD,GACF,ECEN,GAfgCO,GAA0B,CAACR,GAAahB,OAAO,CAAC,EAAGkB,UAAU,OACzFF,EAAUR,SAAQ,EAAG7G,SACjB,MAAM3L,EAAQ2L,GAAM6H,EAAsB7H,GACrC3L,IAGDA,GAA0B,iBAAVA,EAChBkT,EAAQlT,EAAOgS,GAGf9N,MAAM6L,QAAQ/P,IACdA,EAAMmE,KAAI,EAAG8H,SAAUA,GAAOiH,EAAQjH,EAAK+F,KAC/C,GACF,ECNN,MAAMyB,GAAgB,IAAIC,IAAe/H,IACrC,MAAMgI,EAAe,GAUrB,OATID,EAAUjQ,OAAS,GACnBiQ,EAAUlB,SAASoB,IACf,MAAM5J,EAAW4J,EAAYjI,GAEzBzH,MAAM6L,QAAQ/F,IAAaA,EAASvG,OAAS,GAC7CkQ,EAAazJ,QAAQF,EAAS7F,KAAK8H,IAAQ,CAAGA,UAClD,IAGD0H,CAAY,EAEjBE,GAA+B7H,GAAWL,GAAO,EAAwBA,EAAIK,GAC7E8H,GAAiB,CACnB,CAACxN,GAAe,GAAuBmN,IL0TV9H,IAC7B,MAAMgG,EAAqBhG,GAAM+F,GAAsB/F,GACjDoI,EAAwBpC,GAAsBnH,EAAOmH,EAAoB,iBAC/E,GAAIoC,GAAyBA,EAAsBtQ,OAAS,EACxD,OAAOsQ,EACF5P,KAAKwE,IAAc,IAAIM,EAAI,OAAmC,QAA3BA,EAAK,EAAQN,UAA6B,IAAPM,EAAgBA,EAAK,EAAE,IAC7Fa,OAAOqE,QAChB,IAQ2BxC,IAC3B,MAAMgG,EAAqBD,GAAsB/F,GAC3CqI,EAAsBrC,GAAsBnH,EAAOmH,EAAoB,eAC7E,GAAIqC,GAAuBA,EAAoBvQ,OAAS,EACpD,OAAOuQ,EACF7P,KAAKwE,IAAc,IAAIM,EAAI,OAAmC,QAA3BA,EAAK,EAAQN,UAA6B,IAAPM,EAAgBA,EAAK,EAAE,IAC7Fa,OAAOqE,QAChB,KK/UA,CAACtG,GAAc,GAAuBgM,GAA4BhM,IAClE,CAACxB,GAAW,GAAuBwN,GAA4BxN,IAC/D,CAACyB,GAAe,GAAuB+L,GAA4B/L,IACnE,CAACvB,GAAQ,GACT,CAACU,GAAiB,GAAuB4M,GAA4B5M,IACrE,CAACT,GAAgB,GAAuBqN,GAA4BrN,IACpE,CAACW,GAAa,GAAuB0M,GAA4B1M,IACjE,CAACQ,GC9BkB,CAACsM,GAAcjC,OAAO,CAAC,EAAGkB,UAAU,OACvD,MAAM,kBAAEvE,GAAsBqD,EAC9B,GAAI9N,MAAM6L,QAAQpB,GACd,IAAK,MAAMuF,KAAYvF,EACnBuE,EAAQgB,EAAUhV,OAAO+N,OAAO,CAAC,EAAG+E,GAE5C,EDyBA,CAACpK,GE/BiB,CAACqM,GAAcjC,OAAO,CAAC,EAAGkB,UAAU,OACtD,MAAM,iBAAE9E,GAAqB4D,EAC7B,GAAI9N,MAAM6L,QAAQ3B,GACd,IAAK,MAAM8F,KAAY9F,EACnB8E,EAAQgB,EAAUhV,OAAO+N,OAAO,CAAC,EAAG+E,GAE5C,EF0BA,CAACvL,GAAa,GAAuBgN,IL6IX9H,IAC1B,MAAMC,EAAgBD,GAAM,EAAcA,GACpCwI,EAAcvI,GAAiBpB,EAAOoB,EAAe,cAC3D,GAAIuI,GAAeA,EAAY1Q,OAAS,EACpC,OAAO0Q,EACFhQ,KAAKsC,IAAiB,IAAIwC,EAAI,OAAsC,QAA9BA,EAAK,EAAQxC,UAAgC,IAAPwC,EAAgBA,EAAK,EAAE,IACnGa,OAAOqE,QAChB,KKnJA,CAACtH,GAAW,GAAuBgN,GAA4BhN,IAC/D,CAACC,GAAO,GAAuB+M,GAA4B/M,IAC3D,CAACH,GAAc,GAAuB8M,ILyKX9H,IAC3B,MAAMC,EAAgBD,GAAM,EAAcA,GACpCyE,EAAqBxE,GAAiB,EAAIA,EAAe,sBACzDwI,EAAsBhE,GAAsB5F,EAAO4F,EAAoB,eAC7E,GAAIgE,GAAuBA,EAAoB3Q,OAAS,EACpD,OAAO2Q,EACFjQ,KAAKwE,IAAc,IAAIM,EAAI,OAAmC,QAA3BA,EAAK,EAAQN,UAA6B,IAAPM,EAAgBA,EAAK,EAAE,IAC7Fa,OAAOqE,QAChB,KKhLA,CAACpH,GAAQ,GAAuB8M,GAA4B9M,IAC5D,CAACC,GAAiB,GAAuB6M,GAA4B7M,IACrE,CAACE,GAAe,GAAuB2M,GAA4B3M,IACnE,CAACE,GGvCiB,CAAC6M,GAAcjC,OAAO,CAAC,EAAGkB,UAAU,OACtD,MAAM,YAAEmB,GAAgBrC,EACpBqC,GACAnB,EAAQmB,EAAanV,OAAO+N,OAAO,CAAC,EAAG+E,GAC3C,EHoCA,CAAC3K,GAAS,GAAuBwM,GAA4BxM,IAC7D,CAACC,GAAS,GAAuBuM,GAA4BvM,IAC7D,CAACC,GAAO,GAAuBsM,GAA4BtM,IAC3D,CAACC,GAAQ,GAAuBqM,GAA4BrM,IAC5D,CAACC,GAAgB,GAAuBoM,GAA4BpM,IACpE,CAACC,GAAS,GAAuBmM,GAA4BnM,IAC7D,CAAChB,GAAW,GAAuB+M,GAActD,KACjD,CAACvJ,GAAmB,GAAuB6M,IL6KX9H,IAChC,MAAMC,EAAgBD,GAAM,EAAcA,GACpCyE,EAAqBxE,GAAiB,EAAIA,EAAe,sBACzD0I,EAA2BlE,GAAsB5F,EAAO4F,EAAoB,oBAClF,GAAIkE,GAA4BA,EAAyB7Q,OAAS,EAC9D,OAAO6Q,EACFnQ,KAAKwE,IAAc,IAAIM,EAAI,OAAmC,QAA3BA,EAAK,EAAQN,UAA6B,IAAPM,EAAgBA,EAAK,EAAE,IAC7Fa,OAAOqE,QAChB,MSjOJ,MAAMqF,GAAyBxH,GAAWL,GCKP,EAACA,EAAIO,KACpC,MAAMC,EAAkBR,GAAM,EAAkBA,GAC1C4I,EAAsBpI,GAAmB,EAAIA,EAAiB,gBAC9DE,EAAwBkI,GAAuB,EAAIA,EAAqB,kBACxEjI,EAAwBD,GAAyB7B,EAAO6B,EAAuB,YACrF,GAAIC,GAAyBA,EAAsB7I,OAAS,EAAG,CAC3D,MAAM8I,EAAiBD,EAAsBnI,KAAK4H,IAC9C,MAAM,MAAEC,GAAUpB,EAAcmB,GAEhC,MAAO,CACHC,QACAC,IAHQ,EAAQF,GAInB,IAEL,IAAKG,EACD,OAAOK,EAEX,MAAMC,EAAiBD,EAAezC,QAAO,EAAGkC,WAAYA,IAAUE,IACtE,GAAIM,EAAe/I,OAAS,EACxB,OAAO+I,CAEf,GD1B6C,CAA2Bb,EAAIK,GAC1E,GAAiB,CACnB,CAAC/D,GAAmB,GAAuBuL,GAAsBvL,IACjE,CAACC,GAAa,GAAuBsL,GAAsBtL,IAC3D,CAAC,GAAQ,GAAuBsL,GAAsB,KAqB1D,IE1BA,GAH4BgB,GAAkBA,EAAcC,iBAEvDD,EAAcE,eAAiBF,EAAcE,cAAcC,SCFhE,MAAMC,GAAY,WAAYD,SAASE,cAAc,UCGrD,MAOMC,GAAmB,KACrB,MAAMC,EAASJ,SAASE,cAAc,UAStC,OARAE,EAAOC,aAAa,UAAW,4DAC/BD,EAAOC,aAAa,UAAW,SAC/BD,EAAOE,MAAMC,OAAS,IACtBH,EAAOE,MAAME,QAAU,IACvBJ,EAAOE,MAAMG,OAAS,OACtBL,EAAOE,MAAM3H,MAAQ,IACrByH,EAAOE,MAAM9H,OAAS,IACtB4H,EAAOE,MAAMrI,SAAW,WACjBmI,CAAM,EAoCjB,ICxDI9L,GDwDJ,GAlCqB,CAACoM,EAAarE,IAAO,IAAIsE,SAAQ,CAACC,EAASC,KAC5D,MAAMxR,EApBY,EAACgN,EAAIyE,IAAiB,oKAIkBzE,cAAeyE,qCAgBzDC,CAAc1E,EEvBhB,MACd,MAAM2E,EAAWlQ,OAAOkQ,SAExB,OAAIA,EAASC,OACFD,EAASC,OAGRD,EAASE,SACb,KACAF,EAASG,UACRH,EAASI,KAAO,IAAMJ,EAASI,KAAO,GAC/C,EFYkC,IAClC,IAAIhB,EAASD,KAEb,IACIC,EAAOpE,IAAM,cACb0E,EAAYW,YAAYjB,GACxB,MAAMN,EAAkB,GAAmBM,GAC3C,IAAKN,EACD,MAAM,IAAIhT,UAAU,6CAExBgT,EAAgBwB,MAAMjS,EAC1B,CACA,MAAOuC,GACH8O,EAAYa,YAAYnB,GDnCHH,ICqCjBG,EAASD,KACTC,EAAOpE,IAAM,eACboE,EAAOoB,OAASnS,EAChBqR,EAAYW,YAAYjB,IAGxBS,EAAOjP,EAEf,CACA,MAAM6P,EAAgB,EAAGpE,WAEjBA,IAAS,GAAGhB,YACZvL,OAAO4Q,oBAAoB,UAAWD,GACtCb,EAAQR,GACZ,EAEJtP,OAAO6Q,iBAAiB,UAAWF,GAAe,EAAM,IC9C5D,MAAMG,GEFS,CAACC,IACZ,IAAIC,GAAS,EACb,MAAO,IAAMD,uBAAoBC,CAAK,EFA3B,GACT,GAAS3Q,OAAO,UA6FtBmD,GAAK,GACL,OA1FA,MAOI,WAAAyN,CAAYrB,EAAasB,GAOrB,GANAlU,KAAKwG,IAAM,CACP2N,WAAW,EACX5F,GAAIuF,KACJxB,YAAQjT,EACR+U,kBAAc/U,KAEZuT,aAAuBzM,SACzB,MAAM,IAAInH,UAAU,iCAExBgB,KAAKkG,QG9Ba,MACtB,MAAMmO,EAAcnC,SAASE,cAAc,OAI3C,OAHAiC,EAAYC,UAAUC,IAAI,0BAC1BF,EAAY7B,MAAM3H,MAAQ,OAC1BwJ,EAAY7B,MAAM9H,OAAS,OACpB2J,CAAW,EHyBC,GACfrU,KAAKwU,uBAAyB9I,QAAQwI,GAClCA,EACAlU,KAAKkU,aAAeA,GAGpBlU,KAAKkU,aIpCY,EAAClC,EAAkBE,YAC5C,MAAMuC,EAAQzC,EAAgBI,cAAc,SAG5C,OAFAqC,EAAMjC,MAAM3H,MAAQ,OACpB4J,EAAMjC,MAAM9H,OAAS,OACd+J,CAAK,EJgCgB,GACpBzU,KAAKkG,QAAQqN,YAAYvT,KAAKkU,eAElCtB,EAAYW,YAAYvT,KAAKkG,QACjC,CAOA,eAAMwO,CAAUxG,EAAK7P,EAAU,CAAC,GAC5B,IAAI8I,EACJ,GAAInH,KAAK2U,cACL,MAAM,IAAIjU,MAAM,uCAEpB,IAAI,OAAE4R,GAAWtS,KAAK,IACjBsS,IACDA,QAAe,GAAatS,KAAKkG,QAASlG,KAAK,IAAQuO,IACvDvO,KAAK,IAAQsS,OAASA,EACtBtS,KAAK4U,iBAAmBtC,EAAOL,eAEnC,MAAMW,EAAoD,QAArCzL,EAAK,GAAmBmL,UAA4B,IAAPnL,OAAgB,EAASA,EAAG0N,KAC9F,MKpDW,EAAC3G,GAAO4G,SAAQ,EAAOC,SAAQ,EAAOvX,OAAMoV,eAAgB,CAAC,KAC5E,IAAK1E,EACD,MAAM,IAAIlP,UAAU,oCAExB,OAAO,IAAI6T,SAAQ,CAACC,EAASC,KACzB,MAAMiC,EAAS9C,SAASE,cAAc,UACtC,IAAI6C,EAAoBrC,EACxBoC,EAAOxX,KAAOA,QAAmCA,EAAO,kBACxDwX,EAAOF,MAAQA,EACfE,EAAOD,MAAQA,EACfC,EAAOE,QAAU,IAAMnC,EAAO,IAAIoC,SAAS,cAAcjH,yBACzD8G,EAAOI,OAAS,IAAMtC,EAAQkC,GACzBC,IACDA,EAAqB/C,SAASmD,cAEtBnD,SAASmD,cAAcC,WACzBpD,SAASqD,MAEnBP,EAAO9G,IAAMA,EACb+G,SAAsEA,EAAkB1B,YAAYyB,EAAO,GAC7G,ELgCS,CAAW9G,EAAKzR,OAAO+N,OAAO,CAAEoI,eAAevU,GAC1D,CAOA,OAAAmX,CAAQ3K,EAAOH,GACX,GAAI1K,KAAK2U,cACL,MAAM,IAAIjU,MAAM,uCAEfV,KAAKyV,cACNzV,KAAKyV,YMxEE,EAAC7C,EAAa/H,EAAOH,KACpC,MAAMgL,EAAOxD,SAASE,cAAc,OAapC,OAZA3V,OAAO+N,OAAOkL,EAAKlD,MAAO,CACtBG,OAAQ,MACRgD,OAAQ,UACRjL,OAAQ,GAAGA,MACXkL,KAAM,MACNnD,OAAQ,MACRC,QAAS,MACTvI,SAAU,WACV0L,IAAK,MACLhL,MAAO,GAAGA,QAEd+H,EAAYW,YAAYmC,GACjBA,CAAI,EN0DgB,CAAW1V,KAAKkG,QAAS2E,EAAOH,GAE3D,CAIA,OAAAoL,GAII,MAAMC,EAAgB,IAAIlD,SAASC,IAC/BnT,YAAW,KACP,IAAIwH,EAC+B,QAAlCA,EAAKnH,KAAKkG,QAAQoP,kBAA+B,IAAPnO,GAAyBA,EAAGsM,YAAYzT,KAAKkG,SACxF4M,GAAS,GACV,IAAK,IAIZ,OAFA9S,KAAKkG,QAAQsM,MAAMwD,OAAS,QAC5BhW,KAAK,IAAQmU,WAAY,EAClB4B,CACX,CAMA,WAAApB,GACI,OAAO3U,KAAK,IAAQmU,SACxB,GOpGJ,MAAM8B,GAAU,CACZ,MAAO,aACPC,IAAK,kBACLC,IAAK,cACLC,KAAM,wBACNC,IAAK,YACLC,IAAK,kBACLC,IAAK,YACLC,IAAK,uBACLC,IAAK,YACLC,GAAI,aACJC,KAAM,aACNC,IAAK,kBAOT,ICdA,GAJgB,CAAC1C,EAAc2C,KAC3B,MAAM,IAAE3I,EAAG,KAAE1Q,GAASqZ,EACtB,OAAO3C,EAAa4C,YAAYtZ,GDWd,CAAC0Q,IACnB,MAAM5M,EAAQ4M,EAAI5M,MAAM,2BAClByV,EAAMzV,GAASA,EAAM,GAC3B,OAAQyV,GAAOd,GAAQc,IAAS,SAAWA,CAAG,ECdN,CAAc7I,GAAO,IAAI,ECHrE,MAAM8I,GAAiBC,IACnB,MAAMpM,EAAQqM,OAAOD,EAAKpM,QAAU,EAC9BH,EAASwM,OAAOD,EAAKvM,SAAW,EAKtC,MAAO,CACHyM,YAFgBzM,EAAS1N,KAAKoa,MAAOvM,EAAQH,EAAU,IAAM,GAAK,EAGlEA,SACAG,QACH,ECRL,MAAMwM,GAA2B,CAACrI,EAAYsI,IDUnB,EAACtI,EAAYsI,KACpC,MAAMC,EAAeP,GAAcM,GAUnC,OAAOtI,EAAW9Q,MAAM,GAAGsZ,MATT,CAACC,EAAYC,KAC3B,MAAMC,EAAmBX,GAAcS,GACjCG,EAAmBZ,GAAcU,GACjCG,EAAc7a,KAAK8a,IAAIP,EAAa1M,MAAQ8M,EAAiB9M,OAC7DkN,EAAc/a,KAAK8a,IAAIP,EAAa1M,MAAQ+M,EAAiB/M,OAGnE,OAF0B7N,KAAK8a,IAAIP,EAAaJ,YAAcQ,EAAiBR,aACrDna,KAAK8a,IAAIP,EAAaJ,YAAcS,EAAiBT,cAC/BU,EAAcE,CAAW,GAEnC,ECpBjB,CAAmB/I,EAAYsI,GAChC,GAQ5B,OANsB,CAACU,EAAU9D,EAAc+D,GAAaC,eAAeb,OACvE,MAAMC,EAAaW,EAAUE,wBACvBnJ,EAAa,GAAcgJ,GAC3BI,EAAsBpJ,aAA+C,EAASA,EAAW3H,QAAQwP,GAAc,GAAQ3C,EAAc2C,KAC3I,OAAOuB,GAAuBF,EAAaE,EAAqBd,EAAW,ECD/E,GAVa,CAACpR,EAASuD,EAAW4O,KAC9B,MAAMC,EAAU,IAAInZ,KAChB+G,EAAQ0N,oBAAoBnK,EAAW6O,GAChCD,KAAYlZ,IAGvB,OADA+G,EAAQ2N,iBAAiBpK,EAAW6O,GAC7B,KACHpS,EAAQ0N,oBAAoBnK,EAAW6O,EAAQ,CAClD,ECNL,MAAQ3T,SAAQ,IAAK,EAWrB,ICLA,GARqB,CAAC4T,EAAUC,IAAW,IAAIrZ,KAC3C,IACIoZ,KAAYpZ,EAChB,CACA,MAAO2E,GACH0U,SAAgDA,EAAO1U,MAAMA,EACjE,GCLJ,MAKQY,WAAU,kBAAgB,kBAAgB,gBAAc,IAAK,ECLrE,MAAQJ,MAAK,UAAQ,IAAK,ECA1B,MAAQO,OAAM,IAAK,ECAnB,MAAQC,KAAI,IAAK,EACX2T,GAA2B,KAC7B,MAAMC,EAAUxG,SAASE,cAAc,UAOvC,OANAsG,EAAQpE,UAAUC,IAAI,yBACtBmE,EAAQlb,KAAO,SACfkb,EAAQC,UAAY,OACpBD,EAAQlG,MAAMrI,SAAW,WACzBuO,EAAQlG,MAAMoG,OAAS,OACvBF,EAAQlG,MAAMqG,MAAQ,OACfH,CAAO,ECTlB,MAAQ5U,MAAK,IAAK,ECIX,MAAMgV,GAAgB,gBAMhBC,GAAS,SAMTC,GAAa,cCflBpV,SAAQ,iBAAe,YAAU,SAAO,iBAAe,IAAK,EAC9DqV,GAAqB,CAACC,EAAazO,IAA4B,IAAdyO,EAAqBzO,EAItE0O,GAAc,CAACD,EAAazO,IAAawO,GAAmBC,EAAazO,IAAa,GCL5F,MAAQpG,KAAI,UAAQ,IAAK,EACnB+U,GAAWlF,GAAiBA,EAAamF,OAAiC,IAAxBnF,EAAaoF,OCFrE,MAAQtV,WAAU,gBAAc,IAAK,EAiBrC,ICXA,GAPsB,CAACuV,EAAKC,KACxB,IAAIC,EAAeC,OAAOH,GAC1B,KAAOE,EAAazY,OAASwY,GACzBC,EAAe,IAAMA,EAEzB,OAAOA,CAAY,ECSvB,GAbwB9U,IACpB,MAAMgV,EAAQ3c,KAAKoa,MAAMzS,EAAW,MAC9BiV,EAAU5c,KAAKoa,MAAOzS,EAAW,IAAe,IAChDkV,EAAU7c,KAAKoa,MAAOzS,EAAW,IAAQ,IACzCmV,EAAKnV,EAAW,IACtB,OAAQ,GAAcgV,EAAO,GACzB,IACA,GAAcC,EAAS,GACvB,IACA,GAAcC,EAAS,GACvB,IACA,GAAcC,EAAI,EAAG,ECV7B,MAAQnV,SAAQ,IAAK,EACfoV,GAAyBF,GAAsB,IAAVA,EAKrCG,GAAU,EAAGlR,SAAQU,UACvB,MAAMyQ,EAAkC,iBAAXnR,GAAuB4C,QAAQ5C,GAL3C,CAACA,GACM,kBACD7K,KAAK6K,KAAYD,MAAMqR,WAAWpR,IAGa,CAAaA,IAC7EqR,EAA4B,iBAAR3Q,GAAoBA,EAAIxI,OAAS,EAC3D,OAAOiZ,GAAiBE,CAAU,EAEhCC,GAAa,CAACtR,EAAQL,IACF,iBAAXK,EACAA,EAEHoR,WAAWpR,GAAU,IAAOL,EChBxC,MAAQ5E,aAAY,IAAK,EACnBwW,GAA4B,KAC9B,MAAMC,EAASpI,SAASE,cAAc,KAOtC,OANAkI,EAAOhG,UAAUC,IAAI,yBACrB+F,EAAO9H,MAAM3H,MAAQ,OACrByP,EAAO9H,MAAM9H,OAAS,OACtB4P,EAAO9H,MAAMrI,SAAW,WACxBmQ,EAAO9H,MAAMoD,KAAO,IACpB0E,EAAO9H,MAAMqD,IAAM,IACZyE,CAAM,ECYjB,OAZiB,CDEM,EAAGpG,eAAchO,WAAWqS,GAAYgC,kBAAiBC,kBAAiB,EAAMC,qBAAqBJ,IAA8B,CAAC,KACvJ,MAAMzH,EAAc1M,GAAWgO,EAAaoB,WACtCgF,EAASG,IACTC,GAAaxI,SAAS2C,KAAK8F,SAASL,GAqB1C,OApBII,GACA9H,EAAYW,YAAY+G,GAExBC,GAAmBD,aAAkBM,oBACrCN,EAAOO,KAAON,EACdD,EAAOQ,OAAS,UAEpBR,EAAOS,QAAWxR,IACdA,EAAMyR,kBACF9G,EAAa+G,QAAUT,GACvBjR,EAAM2R,iBACNhH,EAAaiH,SAGTX,GACAtG,EAAa5P,QAEjBiU,EAAS,IACb,EAEG,KACCmC,GACA9H,EAAYa,YAAY6G,EAC5B,CACH,ERtCW,EAAGpG,gBAAgBqE,KAC/B,MAAM6C,EAAe,KACjB,IAAI5U,EACJ,MAAM6U,EAA2C,QAA7B7U,EAAK0N,EAAapQ,aAA0B,IAAP0C,EAAgBA,OAAKnH,EAC1Egc,GACA5e,OAAOkG,eAAe0Y,EAAY,OAAQ,CACtCxY,IAAK,IAAMU,EAAU+X,qCAG7B/C,EAAS,GAAO8C,EAAW,EAG/B,OADAnH,EAAaL,iBAAiB,QAASuH,GAChC,KACHlH,EAAaN,oBAAoB,QAASwH,EAAa,CAC1D,EJTsB,EAAGlH,gBAAgBqE,KAC1C,MAAMgD,EAAqB,CACvB,yBACA,sBACA,mBACA,sBAEJ,IAAIC,GAAe,EACnB,MAAMC,EAA0B,MAdJvJ,SAASwJ,mBACrCxJ,SAASyJ,yBACTzJ,SAAS0J,sBACT1J,SAAS2J,qBACT,QAWgC3H,GACxBsH,GAAe,EACfjD,EAAS,IACTA,EAAS,KAEJiD,IACLA,GAAe,EACfjD,EAAS,IACTA,EAAS,IACb,EAEJ,IAAK,MAAMhP,KAASgS,EAChBrJ,SAAS2B,iBAAiBtK,EAAOkS,GAErC,MAAO,KACH,IAAK,MAAMlS,KAASgS,EAChBrJ,SAAS0B,oBAAoBrK,EAAOkS,EACxC,CACH,EQhCgB,EAAGvH,gBAAgBqE,KACpC,IAAIuD,GAAU,EACd,MAAMC,EAAoB,KACtB,MAAM7C,EAAchF,EAAagF,aAC5B4C,GAAW5C,EAAc,IAC1B4C,GAAU,EACVvD,EAAS,IACTA,EAAS,IACTrE,EAAaN,oBAAoB,aAAcmI,GACnD,EAGJ,OADA7H,EAAaL,iBAAiB,aAAckI,GACrC,KACH7H,EAAaN,oBAAoB,aAAcmI,EAAkB,CACpE,EPde,EAAG7H,gBAAgBqE,KACnC,IAAIuD,GAAU,EACVb,GAAS,EACb,MAAMe,EAAc,KACXF,EAIIb,IACLA,GAAS,EACT1C,EAAS,MALTuD,GAAU,EACVb,GAAS,EAKb,EAEEgB,EAAe,KACZhB,IACDA,GAAS,EACT1C,EAAS,IACb,EAIJ,OAFArE,EAAaL,iBAAiB,OAAQmI,GACtC9H,EAAaL,iBAAiB,QAASoI,GAChC,KACH/H,EAAaN,oBAAoB,OAAQoI,GACzC9H,EAAaN,oBAAoB,QAASqI,EAAa,CAC1D,EUPc,EAAG/H,gBAAgBqE,GAAY2D,iBAAiB,IAAO,CAAC,KACvE,MAAM,SAAEzR,GAAayJ,EACfzL,EAAesR,GAAsBtP,GAC3C,IAAI0R,EAAW,EACXC,EAAsBrC,GAAsB7F,EAAagF,aACzDmD,EAAgBH,EACf7U,OAAO2S,IACPtY,KAAI,EAAGoH,SAAQU,UAAU,CAC1BV,OAAQsR,GAAWtR,EAAQL,GAC3Be,UAEJ,MAAM8S,EAAkB,KACpB,MAAM,YAAEpD,GAAgBhF,EAClBqI,EAAQvf,KAAK8a,IAAIoB,EAAckD,GACrCD,GAAYpC,GAAsBwC,GAClCH,EAAsBlD,EACtB,MAAM,aAAEsD,EAAY,OAAEC,GAAWJ,EAAcK,QAAO,CAACC,EAAapT,KAChE,MAAM,OAAET,GAAWS,EAOnB,MANsB,iBAAXT,GAAuBqT,GAAYrT,EAC1C6T,EAAYF,OAAOhV,KAAK8B,GAGxBoT,EAAYH,aAAa/U,KAAK8B,GAE3BoT,CAAW,GACnB,CACCH,aAAc,GACdC,OAAQ,KAEZJ,EAAgBG,EAChBC,EAAO1M,SAAQ,EAAGvG,UACd+O,EAAS,GAAU,CACfqE,gBAAiB,GAAeT,GAChCvK,YAAapI,GACf,IAEuB,IAAzB6S,EAAcrb,QACdkT,EAAaN,oBAAoB,aAAc0I,EACnD,EAKJ,OAHID,EAAcrb,OAAS,GACvBkT,EAAaL,iBAAiB,aAAcyI,GAEzC,KACHpI,EAAaN,oBAAoB,aAAc0I,EAAgB,CAClE,ET9DY,EAAGpI,gBAAgBqE,KAChC,IAAIW,EAAchF,EAAagF,YAC/B,MAAM2D,EAAoB,KACtB,MAAMN,EAAQrI,EAAagF,YAAcA,EACrCqD,EAAQ,GAAKvf,KAAK8a,IAAIyE,IAAU,GAChChE,EAAS,IAEbW,EAAchF,EAAagF,WAAW,EAG1C,OADAhF,EAAaL,iBAAiB,aAAcgJ,GACrC,KACH3I,EAAaN,oBAAoB,aAAciJ,EAAkB,CACpE,ECFU,CAACC,EAAkBvE,GAAYlJ,aAAY0N,oBAAoBtE,IAA6B,CAAC,KACxG,IAAKpJ,EACD,MAAO,IAAM,KAEjB,IAAI2N,EACJ,MAAM,aAAE9I,EAAY,QAAEhO,GAAY4W,EAC5BG,EAAc,KAChB,MAAMC,EAA2C,IAA3BhJ,EAAagF,aAC9B8D,GACqB,iBAAf3N,GACP6N,GAAiB7N,IACjB2N,EAAcD,IACdC,EAAYjC,QAAWxR,IACnB,IAAI/C,EAGJ,OAFiC,QAAhCA,EAAK+C,EAAMyR,uBAAoC,IAAPxU,GAAyBA,EAAG7I,KAAK4L,GAC1EgP,EAAS,KACF,CAAK,EAEhBrS,EAAQqN,YAAYyJ,GACpB9I,EAAaN,oBAAoB,aAAcqJ,GACnD,EAGJ,OADA/I,EAAaL,iBAAiB,aAAcoJ,GACrC,KACH/I,EAAaN,oBAAoB,aAAcqJ,GAC3CD,GACA9W,EAAQuN,YAAYuJ,EACxB,CACH,EG/BgB,EAAG9I,gBAAgBqE,KACpC,IAAIuD,GAAU,EACVqB,GAAoB,EACpBC,GAAe,EACfC,GAAoB,EACpBC,GAAY,EAChB,MAAMC,EAAS,CACXxY,MAAO,CACHyY,QAAUtE,IAAiB4C,GAAW5C,EAAc,EACpDX,SAAU,KACNuD,GAAU,EACVvD,EAAS,GAAM,GAGvBxU,cAAe,CACXyZ,QAAS,CAACtE,EAAazO,KAAc0S,GApBrB,EAACjE,EAAazO,IAAawO,GAAmBC,EAAazO,IAAa,GAoB9BgT,CAAoBvE,EAAazO,GAC3F8N,SAAU,KACN4E,GAAoB,EACpB5E,EAAS,GAAc,GAG/BnU,SAAU,CACNoZ,QAAS,CAACtE,EAAazO,KAAc2S,GA1B1B,EAAClE,EAAazO,IAAawO,GAAmBC,EAAazO,IAAa,GA0B9BiT,CAAexE,EAAazO,GACjF8N,SAAU,KACN6E,GAAe,EACf7E,EAAS,GAAS,GAG1BvT,cAAe,CACXwY,QAAS,CAACtE,EAAazO,KAAc4S,GAhCrB,EAACnE,EAAazO,IAAawO,GAAmBC,EAAazO,IAAa,GAgC9BkT,CAAoBzE,EAAazO,GAC3F8N,SAAU,KACN8E,GAAoB,EACpB9E,EAAS,GAAc,GAG/B3U,SAAU,CACN4Z,QAAS,CAACtE,EAAazO,KAAc6S,GAAanE,GAAYD,EAAazO,GAC3E8N,SAAU,KACN+E,GAAY,EACZ/E,EAAS,GAAS,IAIxBqF,EAAoB,KACtB,MAAMnT,EAAWyJ,EAAazJ,SACxByO,EAAchF,EAAagF,YACjC,IAAK,MAAM3P,KAASgU,EAChB,GAAIA,EAAOhU,GAAOiU,QAAQtE,EAAazO,GAAW,CAC9C8S,EAAOhU,GAAOgP,WACd,KACJ,CAEJA,EAASS,GAAW,EAElB6E,EAAe,KACjB,MAAMpT,EAAWyJ,EAAazJ,SACxByO,EAAchF,EAAagF,aAC5BoE,GAAanE,GAAYD,EAAazO,KACvC6S,GAAY,EACZ/E,EAAS,KAEbrE,EAAaN,oBAAoB,QAASiK,GAC1C3J,EAAaN,oBAAoB,aAAcgK,EAAkB,EAIrE,OAFA1J,EAAaL,iBAAiB,aAAc+J,GAC5C1J,EAAaL,iBAAiB,QAASgK,GAChC,KACH3J,EAAaN,oBAAoB,aAAcgK,GAC/C1J,EAAaN,oBAAoB,QAASiK,EAAa,CAC1D,EC1EkB,EAAG3J,gBAAgBqE,KACtC,IAAIuF,EAAW1E,GAAQlF,GACvB,MAAM6J,EAAsB,KACxBxF,EAASO,IACLgF,IAAa1E,GAAQlF,GACrBqE,EAAS,KAEHuF,GAAY1E,GAAQlF,IAC1BqE,EAAS,IAEbuF,EAAW1E,GAAQlF,EAAa,EAGpC,OADAA,EAAaL,iBAAiB,eAAgBkK,GACvC,KACH7J,EAAaN,oBAAoB,eAAgBmK,EAAoB,CACxE,GOHL,GAZ4B,EAAGxN,YAAWuM,mBAAkBkB,QAAOxD,kBAAkBjC,KACjF,MAAMP,EAAWzH,EAAU,GAAGrH,GACxBmG,EAAa2I,GAAY5I,GAAc4I,GACvCuC,EAAkBvC,GAAY,GAAgBA,GAC9CkE,EhBLgB,CAAC3L,GAAcA,EACpC7O,KAAI,EAAGwH,QAASA,IAChBwT,QAAO,CAACuB,EAAa/U,IAEf,IAAI+U,KADK/U,GAAM,EAAwBA,EAAI,KAAc,KAEjE,IACExH,KAAI,EAAGoH,SAAQU,UAAU,CAC1BV,SACAU,UgBHuB,CAAkB+G,GACnChB,EAAO9S,OAAO+N,OAAO,CAAE+P,kBACzBC,iBACA0B,iBACA7M,cAAc2O,GACZE,EAAkB,GAAexc,KAAK4W,GAAY,GAAaA,EAAQwE,EAAkBvE,EAAUhJ,MACzG,MAAO,IAAM2O,EAAgBnO,SAASoO,GAAeA,KAAa,ECXtE,MAAMC,WAAoB1d,MACtB,WAAAuT,CAAYoK,GACRC,MAAMD,GACNre,KAAK2G,KAAO,cACZlK,OAAO8hB,eAAeve,KAAMoe,GAAYvhB,UAC5C,EAEJ,U,qBCVA,GAAemG,OAAOwb,kBAClBxb,OAAOyb,wBACPzb,OAAO0b,oBCAX,MAQMC,GAAO,OACPC,GAAoB,CAAC,QAAS,cAAe,gBAiB7CC,GAAmBxb,OAAO,oBAC1Byb,GAAczb,OAAO,oBAmCrB0b,GAAiB1b,OAAO,kBACxB2b,GAAgB3b,OAAO,iBA2D7B,OArBwB,CAACyX,EAAQvC,GAAY0G,YAAY,IAAO,CAAC,KArGhD,EAACnE,EAAQvC,KACtB,KAAMuC,aAAkB3U,SACpB,MAAM,IAAInH,UAAU,iCAExB,KAAMuZ,aAAoB5b,UACtB,MAAM,IAAIqC,UAAU,6BACxB,EAgGAkgB,CAASpE,EAAQvC,GACjB,MAAM4G,EAAa,EAAG3M,QAAO4M,eAAcC,iBAAkB,CAAC7M,EAAM3H,MAAO2H,EAAM9H,OAAQ2U,EAAaD,GAAcxd,KAAK,KACzH,IAAI0d,EAAWH,EAAWrE,GAC1B,MAOMyE,EAAsB,MAPH,KACrB,MAAMC,EAAcL,EAAWrE,GAC3B0E,IAAgBF,IAChBA,EAAWE,EACXjH,IACJ,GAEmD0G,GACjDQ,EAAyBjB,GArFhB,EAAC1D,EAAQvC,KACxB,IAAI/R,EACJ,IAAKsU,EAAO+D,IAAmB,CAC3B/D,EAAO+D,IAAoB,GAC3B,MAAMa,EAAe,KACjB,IAAIlZ,EACgC,QAAnCA,EAAKsU,EAAO+D,WAAsC,IAAPrY,GAAyBA,EAAGuJ,SAASuI,GAAYA,KAAU,EAE3GwC,EAAOgE,IA1BQ,EAAChE,EAAQvC,KAC5B,MAAMoH,EAAW,IAAInB,IAAkBoB,IACnC,IAAK,IAAIC,EAAQ,EAAGA,EAAQD,EAAU5e,OAAQ6e,IAAS,CACnD,MAAM,cAAEzX,GAAkBwX,EAAUC,GAChCzX,GAAiBwW,GAAkBjb,SAASyE,IAC5CmQ,GAER,KAOJ,OALAoH,EAASG,QAAQhF,EAAQ,CACrB1U,YAAY,EACZ2Z,eAAe,EACfC,WAAW,IAERL,CAAQ,EAYWM,CAAenF,EAAQ4E,EACjD,CAEA,OADoC,QAAnClZ,EAAKsU,EAAO+D,WAAsC,IAAPrY,GAAyBA,EAAGiB,KAAK8Q,GACtE,KACH,IAAI/R,EAAIW,EAAI+Y,EACZpF,EAAO+D,IAAwD,QAAnCrY,EAAKsU,EAAO+D,WAAsC,IAAPrY,OAAgB,EAASA,EAAGa,QAAQiR,GAAYA,IAAYC,IAC1C,KAAhD,QAAnCpR,EAAK2T,EAAO+D,WAAsC,IAAP1X,OAAgB,EAASA,EAAGnG,UAC1C,QAA9Bkf,EAAKpF,EAAOgE,WAAiC,IAAPoB,GAAyBA,EAAG/B,oBAC5DrD,EAAO+D,WACP/D,EAAOgE,IAClB,CACH,EAmEKqB,CAAWrF,EAAQyE,GACnBZ,GACAyB,EAnDO,EAACtF,EAAQvC,KACtB,IAAI/R,EACJ,IAAKsU,EAAOiE,IAAiB,CACzBjE,EAAOiE,IAAkB,GACzB,MAAMW,EAAe,KACjB,IAAIlZ,EAC8B,QAAjCA,EAAKsU,EAAOiE,WAAoC,IAAPvY,GAAyBA,EAAGuJ,SAASuI,GAAYA,KAAU,EAEzGwC,EAAOkE,IAxBa,CAACzG,IACzB,MAAMjG,EAASJ,SAASE,cAAc,UAUtC,OATAE,EAAOC,aAAa,QAAS,mJAC7BD,EAAOC,aAAa,OAAQ,aAC5BD,EAAOC,aAAa,UAAW,SAC/BD,EAAO8C,OAAS,KACR9C,EAAOL,eACPK,EAAOL,cAAc4B,iBAAiB,SAAU0E,EACpD,EAEJjG,EAAOpE,IAAM,cACNoE,CAAM,EAae+N,CAAoBX,GACF,WAAtCY,iBAAiBxF,GAAQ3Q,WACzB2Q,EAAOtI,MAAMrI,SAAW,YAE5B2Q,EAAOvH,YAAYuH,EAAOkE,IAC9B,CAEA,OADkC,QAAjCxY,EAAKsU,EAAOiE,WAAoC,IAAPvY,GAAyBA,EAAGiB,KAAK8Q,GACpE,KACH,IAAI/R,EAAIW,EACR2T,EAAOiE,IAAoD,QAAjCvY,EAAKsU,EAAOiE,WAAoC,IAAPvY,OAAgB,EAASA,EAAGa,QAAQiR,GAAYA,IAAYC,IACxC,KAAhD,QAAjCpR,EAAK2T,EAAOiE,WAAoC,IAAP5X,OAAgB,EAASA,EAAGnG,UACvE8Z,EAAOrH,YAAYqH,EAAOkE,YACnBlE,EAAOiE,WACPjE,EAAOkE,IAClB,CACH,EA4B6BuB,CAASzF,EAAQyE,GAC/C,MAAO,KACHE,IACAW,GAAuB,CAC1B,EC1HL,GAAepd,OAA2B,qBCE1C,MAQM,GAAO,OACPwd,GAAuBnd,OAAO,wBAC9B,GAAcA,OAAO,wBA4B3B,IAAIod,GAAqB,GAkBrBC,GAA0B,GAwC9B,OA5BkC,CAAC5F,EAAQvC,GAAY0G,YAAY,IAAK0B,oBAAoB,IAAQ,CAAC,KAEjG,GAtEa,EAAC7F,EAAQvC,KACtB,KAAMuC,aAAkB3U,SACpB,MAAM,IAAInH,UAAU,iCAExB,KAAMuZ,aAAoB5b,UACtB,MAAM,IAAIqC,UAAU,6BACxB,EA+DA,CAAS8b,EAAQvC,IACZqI,GAGD,OADArI,OAASlZ,GACF,GAEX,IAAIwhB,GAAmB,EACvB,MAYMC,EAAoB,MAZDC,IACrBA,EAAQhR,SAASiR,IACb,GAAIA,EAAMlG,SAAWA,EAAQ,CACzB,MAAMmG,GAAgB/O,SAASgP,QAAUF,EAAMG,kBAAoBR,EAC/DM,IAAiBJ,IACjBA,EAAmBI,EACnB1I,EAAS0I,GAEjB,KAEJP,GAA0BK,CAAO,GAEe9B,GAC9CmC,EA9Ea,EAACtG,EAAQvC,KAC5B,IAAI/R,EAAIW,EACR,IAAK2T,EAAO0F,IAAuB,CAC/B1F,EAAO0F,IAAwB,GAC/B,MAAMd,EAAe,CAACqB,EAASpB,KAC3B,IAAInZ,EACoC,QAAvCA,EAAKsU,EAAO0F,WAA0C,IAAPha,GAAyBA,EAAGuJ,SAASuI,GAAYA,EAAQyI,EAASpB,IAAU,EAE1HthB,EAAU,CACZ7C,KAAM,KACN6lB,WAAY,MACZpC,UAAW,IAAI,IAAIxd,MAAM,KAAKC,KAAI,CAAC4f,EAAOzB,IAAUA,EAAQ,MAEhE/E,EAAO,IAAe,IAAI8F,GAAqBlB,EAAcrhB,GAC9B,QAA9BmI,EAAKsU,EAAO,WAAiC,IAAPtU,GAAyBA,EAAGsZ,QAAQhF,EAC/E,CAEA,OADwC,QAAvC3T,EAAK2T,EAAO0F,WAA0C,IAAPrZ,GAAyBA,EAAGM,KAAK8Q,GAC1E,KACH,IAAI/R,EAAIW,EAAI+Y,EACZpF,EAAO0F,IAAgE,QAAvCha,EAAKsU,EAAO0F,WAA0C,IAAPha,OAAgB,EAASA,EAAGa,QAAQiR,GAAYA,IAAYC,IAC9C,KAAhD,QAAvCpR,EAAK2T,EAAO0F,WAA0C,IAAPrZ,OAAgB,EAASA,EAAGnG,UAC9C,QAA9Bkf,EAAKpF,EAAO,WAAiC,IAAPoF,GAAyBA,EAAG/B,oBAC5DrD,EAAO0F,WACP1F,EAAO,IAClB,CACH,EAqDiCyG,CAAezG,EAAQgG,GACnDU,EAnDiB,EAACC,EAASlJ,KACjC,MAAMmH,EAAe,KACbe,IACAA,GAAmB1Q,SAASuI,GAAYA,KAC5C,EAMJ,OAJAmI,GAAmBhZ,KAAK8Q,GACU,IAA9BkI,GAAmBzf,QACnBkR,SAAS2B,iBAAiB,mBAAoB6L,GAE3C,KACHe,GAAqBA,GAAmBpZ,QAAQiR,GAAYA,IAAYC,IACtC,IAA9BkI,GAAmBzf,QACnBkR,SAAS0B,oBAAoB,mBAAoB8L,EACrD,CACH,EAoCuCgC,CAAmB5G,GAAQ,IAAMgG,EAAkBJ,MAC3F,MAAO,KACHU,IACAI,GAAiC,CACpC,ECLL,GAtFA,MACI,WAAAvN,CAAYuE,GACRxY,KAAKud,OAAS,CAAC,EACfvd,KAAKwY,OAASA,GAAUmJ,OAC5B,CAQA,EAAAC,CAAGnY,EAAW4O,GACV,MAAMkF,EAASvd,KAAKud,OAGpB,OAFuBA,EAAO9T,KAAe8T,EAAO9T,GAAa,KAClDhC,KAAK4Q,GACbrY,IACX,CAQA,cAAA6hB,CAAepY,EAAW4O,GACtB,MAAMkF,EAASvd,KAAKud,OACduE,EAAiBvE,EAAO9T,KAAe8T,EAAO9T,GAAa,IAEjE,OADA8T,EAAO9T,GAAaqY,EAAeza,QAAQ0a,GAAcA,IAAc1J,GAAY0J,EAAUC,IAAM3J,IAC5FrY,IACX,CAOA,kBAAAiiB,CAAmBxY,GAOf,OANIA,SACOzJ,KAAKud,OAAO9T,GAGnBzJ,KAAKud,OAAS,CAAC,EAEZvd,IACX,CASA,IAAAkiB,CAAKzY,EAAW4O,GACZ,MAAMC,EAAU,IAAInZ,KAChBa,KAAK6hB,eAAepY,EAAW6O,GAC/BD,KAAYlZ,EAAK,EAGrB,OADAmZ,EAAQ0J,EAAI3J,EACLrY,KAAK4hB,GAAGnY,EAAW6O,EAC9B,CAQA,IAAA6J,CAAK1Y,KAActK,GACf,MAAMoe,EAASvd,KAAKud,OACduE,EAAiBvE,EAAO9T,KAAe8T,EAAO9T,GAAa,IAC3D2Y,EAAeN,EAAe9gB,OAAS,EAW7C,OAVA8gB,EAAe/R,SAASuI,IACpB,IACIA,KAAWnZ,EACf,CACA,MAAO2E,GACCA,aAAiBpD,OACjBV,KAAKwY,OAAO1U,MAAMA,EAAOA,EAAMue,MAEvC,KAEGD,CACX,GCxFJ,GADoB,EAAGhX,iBAAgBC,eAAcC,kBAAmB,CAAC,IAAMF,GAAkBC,GAAgBC,QAAkBjM,ECEnI,MAAMijB,GAAU,UA6BVC,GAAmBC,GACA,IAAjBA,EAAMxhB,OACCwhB,EAAM,GAXS,CAACA,IAC3B,MAAMC,EAAmBzf,OAAOyf,kBAAoB,EAMpD,OAAOD,EAAMtkB,MAAM,GAAGsZ,MALJ,CAACkL,EAAOC,IACP3lB,KAAK8a,IAAI2K,GAAoBC,EAAM9X,SAAW,IAC9C5N,KAAK8a,IAAI2K,GAAoBE,EAAM/X,SAAW,KAG5B,EAM9BgY,CAAsBJ,GAAO,GAoBxC,OARuBjS,IACnB,MACMiS,EADMjS,EAAU7O,KAAI,EAAGwH,QAASA,IAAI7B,OAAOqE,SAC/BgR,QAAO,CAACC,EAAazT,IAAO,IAAIyT,KAAiB,GAASzT,IAAO,KAAM,IACzF,GAAIsZ,EAAMxhB,OAAS,EAAG,CAClB,MAAM6hB,EArCS,CAACL,GAXT,EAACM,EAAOC,KACnB,MAAMC,EAAO,CAAC,EACd,OAAOF,EAAMzb,QAAQ4b,IACjB,MAAMxgB,EAAMsgB,EAAUE,GACtB,SAAKxgB,GAAOugB,EAAK7f,eAAeV,KAGhCugB,EAAKvgB,IAAO,EACL,GAAI,GACb,EAE4BygB,CAAOV,EAAO,IAqCtBW,CAAeX,GACjC,MAfY,CAACA,IACjB,MAAMY,EAvBkB,CAACZ,GAAUA,EAAM9F,QAAO,CAACC,EAAa0G,KAC9D,IAAI7c,EAAIW,EACR,MAAMwD,EAAkC,QAAvBnE,EAAK6c,EAAK1Y,eAA4B,IAAPnE,EAAgBA,EAAK8b,GAGrE,OAFgC,QAA/Bnb,EAAKwV,EAAYhS,UAA6B,IAAPxD,IAAsBwV,EAAYhS,GAAW,IACrFgS,EAAYhS,GAASlD,KAAK4b,GACnB1G,CAAW,GACnB,CAAC,GAiBkB2G,CAAoBd,GAEtC,OADiB/lB,OAAOqT,KAAKsT,GACb1G,QAAO,CAACC,EAAahS,IAC7BA,IAAY2X,GACL,IAAI3F,KAAgByG,EAAUd,KAElC,IAAI3F,EAAa4F,GAAgBa,EAAUzY,MACnD,GAAG,EAOK4Y,CAAYV,EACvB,GC5BJ,GAxBgB,CAAC3c,EAASqD,KACtB,IACIia,EACAC,EAFAC,GAAU,EAGd,MAAMC,EAAU,IAAI9Q,SAAQ,CAACC,EAASC,KAClCyQ,EAAiB1Q,EACjB2Q,EAAgB1Q,CAAM,IAEpB6Q,EAAa,GAAK1d,EAASqD,GAAO,IAAIpK,KACxCukB,GAAU,EACVF,EAAerkB,EAAK,IASxB,MAAO,CACHe,OARW,KACPwjB,IACAA,GAAU,EACVE,IACAH,EAAc,IAAI/iB,MAAM,yBAC5B,EAIAijB,UACH,ECvBL,MAAME,WAAmBnjB,MACrB,WAAAuT,CAAYoK,GACRC,MAAMD,GACNre,KAAK2G,KAAO,aACZlK,OAAO8hB,eAAeve,KAAM6jB,GAAWhnB,UAC3C,EAqBJ,ICNA,GAnB2B,CAACqR,GAAOgE,WAAU3C,WACzC,MAAM,OAAE7E,EAAM,MAAEG,GAAU0E,EACpBuU,EAAa5R,EAASE,cAAc,OAe1C,OAdIvH,IACAiZ,EAAWtR,MAAM3H,MAAQ,GAAGA,OAE5BH,IACAoZ,EAAWtR,MAAM9H,OAAS,GAAGA,ODGnBoK,OAAOiP,IACrB,MAAMC,QAAiBC,MAAMF,GACvBG,EAAcF,EAASG,QAAQthB,IAAI,gBACzC,GAAImhB,EAASI,QAAU,IAAK,CACxB,MAAMtgB,EAAQ,IAAI+f,GAAWG,EAASK,YAEtC,MADAvgB,EAAMkgB,SAAWA,EACXlgB,CACV,CACA,IAAKogB,IAZkB,CAACA,IACxB,MAAMI,EAAeJ,EAAYtd,cACjC,MAAO,CAAC,aAAc,aAAa2d,MAAMC,GAAgBF,EAAa3gB,SAAS6gB,IAAa,EAUvEC,CAAmBP,GAAc,CAClD,MAAMpgB,EAAQ,IAAI+f,GAAW,yCAAyCK,KAEtE,MADApgB,EAAMkgB,SAAWA,EACXlgB,CACV,CACA,OAAOkgB,EAASjd,MAAM,ECdtB,CAAUmH,GACLwW,MAAMC,IACPb,EAAWnL,UAAYgM,EACvBb,EAAWc,cAAc,IAAIC,YAAY,QAAQ,IAEhDC,OAAM,KACPhB,EAAWc,cAAc,IAAIC,YAAY,SAAS,IAE/Cf,CAAU,ECfrB,MAAMiB,GAAe7S,SAASE,cAAc,OCD5C,MAAM,GAAO,OAkCb,OAjCqB,CAACiR,GAAQnR,WAAUU,iBAAkB,IAAIC,SAAQ,CAACC,EAASC,KAC5E,IACI,MAAMiS,EDDS,EAAC9S,EAAU3C,KAC9B,MAAM,eAAEnE,EAAc,aAAEC,EAAY,eAAEC,GAAmBiE,EACzD,OAAInE,EENqB,EAAC8C,GAAOgE,WAAU3C,WAC3C,MAAM,OAAE7E,EAAM,MAAEG,GAAU0E,EACpB0V,EAAQ/S,EAASE,cAAc,OAQrC,OAPIvH,IACAoa,EAAMpa,MAAQA,GAEdH,IACAua,EAAMva,OAASA,GAEnBua,EAAM/W,IAAMA,EACL+W,CAAK,EFHD,CAAqB7Z,EAAgB,CACxCmE,OACA2C,aAGJ7G,EACO,GAAmBA,EAAc,CACpCkE,OACA2C,aAGJ5G,EGlBqB,EAAC4C,GAAOgE,WAAU3C,WAC3C,MAAM,OAAE7E,EAAM,MAAEG,GAAU0E,EACpBwC,EAAgBG,EAASE,cAAc,UAY7C,OAXAL,EAAcQ,aAAa,UAAW,0CACtCR,EAAcQ,aAAa,UAAW,SAClC1H,IACAkH,EAAclH,MAAQA,EAAM/N,YAE5B4N,IACAqH,EAAcrH,OAASA,EAAO5N,YAElCiV,EAAc7D,IAAMA,EACpB6D,EAAcmT,YAAc,IAC5BnT,EAAcS,MAAMG,OAAS,OACtBZ,CAAa,EHKT,CAAqBzG,EAAgB,CACxCiE,OACA2C,aAGD6S,EAAY,ECnBS,CAAe7S,EAAUmR,GAC3C8B,EAAoB,GAAQH,EAAiB,SAC7CI,EAAmB,GAAQJ,EAAiB,QAC5CK,EAAU,KACRzS,EAAY+H,SAASqK,KACrBpS,EAAYa,YAAYuR,GACxBA,EAAgBxS,MAAMwD,OAAS,IACnC,EAEJmP,EAAkBxB,QACbe,MAAK,KACNU,EAAiBllB,SACjBmlB,IACAtS,EAAO,IAAIrS,MAAM,0BAA0B,IAE1CokB,MAAM,IACXM,EAAiBzB,QACZe,MAAK,KACNS,EAAkBjlB,SAClBmlB,IACAvS,EAAQkS,EAAgB,IAEvBF,MAAM,IAEXE,EAAgBxS,MAAMwD,OAAS,QAC/BpD,EAAYW,YAAYyR,EAC5B,CACA,MAAOlhB,GACHiP,EAAOjP,EACX,KGlCJ,MAAMwhB,GAAgB,EAAG5a,SAAQG,WAAYH,EAASG,EAqBhDgO,GAAQ,EAAGjD,OAAM/K,WAAY+K,EAAO/K,EACpC+K,GAAO,EAAGA,UAAWA,EACrB,GAAM,EAAGC,SAAUA,EACnB+C,GAAS,EAAG/C,MAAKnL,YAAamL,EAAMnL,EAY1C,OANsB,CAAC6a,EAASC,KAC5B,MAAMC,EA9Bc,EAACF,EAASC,KAC9B,MAAM,WAAEE,EAAU,YAAE9S,GAAgB4S,EAC9BG,EAAkBL,GAAc1S,EAAYuF,yBASlD,OARiBmN,GAAcC,GACTG,EAAWhJ,QAAO,CAACC,EAAa0G,KAClD,MAAM,MAAExY,EAAK,OAAEH,GAAW2Y,EAC1B,OAAKxY,GAAUH,EAGRiS,EAAc2I,GAAc,CAAEza,QAAOH,WAFjCiS,CAE0C,GACtD,IACkD,IAAlBgJ,CAAsB,EAmBpCC,CAASL,EAASC,GACjCK,EAlBsB,EAACN,GAAW3S,kBACxC,MAAMkT,EAASlT,EAAYuF,wBAC3B,OAAQoN,EAAQ3P,MAAQ,GACpB2P,EAAQ3P,KAAO2P,EAAQ1a,OAASib,EAAOjb,OACvC0a,EAAQ1P,KAAO,GACf0P,EAAQ1P,IAAM0P,EAAQ7a,QAAUob,EAAOpb,MAAO,EAanBqb,CAAiBR,EAASC,GACnDQ,EAJqB,EAACT,GAAWG,iBAAkBA,EAAWnB,MAAM0B,GAJ9D,EAACV,EAASU,IAAcrQ,GAAK2P,IAAY1M,GAAMoN,IAC3DpN,GAAM0M,IAAY3P,GAAKqQ,IACvBrN,GAAO2M,IAAY,GAAIU,IACvB,GAAIV,IAAY3M,GAAOqN,GACiEC,CAAQX,EAASU,KAIlFE,CAAgBZ,EAASC,GAChD,OAAOC,GAAgBI,GAA0BG,CAAc,EC/BnE,MAAM,GAAO,OAkEb,OAhBmBlR,MAAOuO,EAAMmC,KAC5B,IAAIhf,EACJ,MAAM,YAAEoM,GAAgB4S,EAClBjb,OAjCSuK,OAAOuO,EAAMhlB,KAC5B,IAAKglB,EAAKnd,QAAS,CACf,MAAMkgB,QAAqB,GAAa/C,EAAMhlB,IAC1C+nB,aAAwBC,mBACxBD,aAAwBE,oBACxBF,EAAavb,MAAQ,OACrBub,EAAa1b,OAAS,QAE1B0b,EAAa5T,MAAM9H,OAAS,OAC5B0b,EAAa5T,MAAM3H,MAAQ,OAC3BwY,EAAKnd,QA7BgB,EAACqE,EAAa8Y,GAAQkD,cAAc,IAAS,CAAC,KACvE,MAAMjM,EAASpI,SAASE,cAAc,KAgBtC,OAfIiR,EAAKpX,mBACLqO,EAAOO,KAAOwI,EAAKpX,iBACnBqO,EAAOQ,OAAS,UAGhBuI,EAAK/X,iBACLf,EAAYiI,MAAMgU,cAAgB,QAEtClM,EAAOS,QAAWxR,SAC0BlK,IAApConB,MAAM5pB,UAAUme,iBAChBzR,EAAMyR,kBAEVuL,EAAYlD,EAAK,EAErB/I,EAAO/G,YAAYhJ,GACZ+P,CAAM,EAYMoM,CAAqBN,EAAc/C,EAAMhlB,EAC5D,CACA,OAAOglB,EAAKnd,OAAO,EAqBOygB,CAAWtD,EAAMmC,GACrCoB,EC1CS,EAACvD,EAAM9Y,GAAemb,aAAY9S,kBACjD,MAAMiU,EAAexD,EAAKyD,UACpB7P,EAAO1M,EAAY4N,wBACnB2N,EAASlT,EAAYuF,wBACrBtN,EAAQwY,EAAKxY,OAASoM,EAAKpM,MAC3BH,EAAS2Y,EAAK3Y,QAAUuM,EAAKvM,OAC7BI,EAAYuY,EAAKvY,WAAa,QAC9BC,EAAYsY,EAAKtY,WAAa,MACpC,IAAI6K,EACAC,EACJ,GAzBsB,CAAC/K,IAAe,CAAC,OAAQ,SAASnH,SAAS+V,OAAO5O,GAAWlE,eAyB/EmgB,CAAkBjc,GAClB8K,EAAO9K,MAEN,CACD,MAAM0X,EAAQkD,EAAWre,QAAQ2f,GAAUA,EAAMlc,YAAcA,GAAakc,EAAMjc,YAAcA,IAChG6K,EA5BkB,EAACqR,EAAYC,EAAWxB,EAAYyB,KAC1D,MAAMC,EAAkB1B,EAAWhJ,QAAO,CAACC,EAAa0G,IAAS1G,GAAe0G,EAAKxY,MAAQwY,EAAKxY,MAAQ,EAAI,IAAI,GAClH,MAAmB,SAAfoc,EACOG,EAEJD,EAAUC,EAAkBF,CAAS,EAuBjCG,CAAkBvc,EAAWD,EAAO2X,EAAOsD,EAAOjb,MAC7D,CAtBqB,IAACoc,EAAYK,EAAYC,EARxB,CAACxc,IAAe,CAAC,MAAO,UAAUpH,SAAS+V,OAAO3O,GAAWnE,eA+B/E4gB,CAAkBzc,GAClB8K,EAAM9K,GAxBYkc,EA2BKlc,EA3BOuc,EA2BI5c,EA3BQ6c,EA2BAzB,EAAOpb,OAAjDmL,EA1Be,QAAfoR,EACO,EAEJM,EAAWD,GAyBlB,MAAMR,EAAY,GAAGlR,KAAQC,KAAOhL,KAASH,IAC7C,OAAOjO,OAAO+N,OAAO6Y,EAAM,CACvB3Y,SACAkL,OACAkR,YACAjR,MACA4R,QAASZ,IAAiBC,EAC1Bjc,SACF,EDWkB,CAAWwY,EAAM9Y,EAAaib,GAClD,IAAI,GAAcoB,EAAapB,GAO3B,MADkC,QAAjChf,EAAK+D,EAAY+K,kBAA+B,IAAP9O,GAAyBA,EAAGiN,YAAYlJ,GAC5E,IAAI7J,MAAM,0BAEpB,OARS6J,EAAY+K,aAAcsR,EAAYa,SACvC7U,EAAYW,YAvBE,EAAChJ,EAAa8Y,KACpC,MAAM,OAAE3Y,EAAM,MAAEG,EAAK,KAAE+K,EAAI,IAAEC,EAAG,UAAE9K,GAAcsY,EAahD,OAZA9Y,EAAYiI,MAAMrI,SAAW,WAC7BI,EAAYiI,MAAMoD,KAAO,GAAGA,MAGV,WAAd7K,EACAR,EAAYiI,MAAMoG,OAAS,IAG3BrO,EAAYiI,MAAMqD,IAAM,GAAGA,MAE/BtL,EAAYiI,MAAM9H,OAAS,GAAGA,MAC9BH,EAAYiI,MAAM3H,MAAQ,GAAGA,MACtBN,CAAW,EAScmd,CAAkBnd,EAAaqc,IAOxDA,CAAW,EEhCtB,GAjCoB,CAACpE,GAAS+D,cAAazJ,mBAAkBtE,SAASmJ,YAClE,MAAM,QAAEzb,EAAO,aAAEgO,GAAiB4I,EAC5B4I,EAAa,IACb,YAAEiC,EAAW,WAAEC,GAAepF,EAAM9F,QAAO,CAACC,EAAa0G,KCLhD,EAACA,EAAMnP,KACtB,MAAM2T,EAA6C,IAA3B3T,EAAagF,YAC/B4O,EAA4C,IAAxB5T,EAAazJ,SACjC3B,EAAgC,iBAAhBua,EAAKva,OACrBxM,SAAS+mB,EAAKva,OAAQ,IACtBua,EAAKva,QAAU,EACf2B,EAAW4Y,EAAK5Y,UAAYqd,EAClC,OAAOhf,GAAU+e,GAAmBA,EAAkB/e,GAAU2B,CAAQ,EDDhE,CAAW4Y,EAAMnP,GACjByI,EAAYgL,YAAYlgB,KAAK4b,GAG7B1G,EAAYiL,WAAWngB,KAAK4b,GAEzB1G,IACR,CACCgL,YAAa,GACbC,WAAY,KAMhB,OAJAA,EAAW7X,SAAQ,EAAG7J,QAASqE,MAC3B,IAAI/D,EACwF,QAA3FA,EAAK+D,aAAiD,EAASA,EAAY+K,kBAA+B,IAAP9O,GAAyBA,EAAGiN,YAAYlJ,EAAY,IAErJod,EACFjL,QAAO,CAACiH,EAASN,IAASM,EAC1Be,MAAK,IAAM,GAAWrB,EAAM,CAC7BnR,kBACAwT,aACAa,cACA3T,YAAa1M,MAEZwe,MAAMqD,IACPrC,EAAWje,KAAKsgB,EAAa,IAE5BjD,OAAOhhB,GAAU0U,EAAOwP,IAAIlkB,MAAS+O,QAAQC,WAC7C4R,MAAK,IAAMgB,GAAW,EErB/B,MAAMuC,GAAqB5kB,OAAO,sBAC5B,GAAO,OAkCb,IC/CI,GAAI8D,GD+CR,GAvBiB,CAACqb,EAAOhc,KACrB,IAAI,iBAAEsW,EAAgB,WAAEoL,EAAa,GAAI,YAAE3B,EAAc,IAAS/f,EAAI2hB,EAzBpC,SAAU9mB,EAAG0B,GAC/C,IAAIqlB,EAAI,CAAC,EACT,IAAK,IAAIC,KAAKhnB,EAAO5E,OAAOI,UAAUsG,eAAexF,KAAK0D,EAAGgnB,IAAMtlB,EAAEulB,QAAQD,GAAK,IAC9ED,EAAEC,GAAKhnB,EAAEgnB,IACb,GAAS,MAALhnB,GAAqD,mBAAjC5E,OAAO8rB,sBACtB,KAAIxsB,EAAI,EAAb,IAAgBssB,EAAI5rB,OAAO8rB,sBAAsBlnB,GAAItF,EAAIssB,EAAErnB,OAAQjF,IAC3DgH,EAAEulB,QAAQD,EAAEtsB,IAAM,GAAKU,OAAOI,UAAU2rB,qBAAqB7qB,KAAK0D,EAAGgnB,EAAEtsB,MACvEqsB,EAAEC,EAAEtsB,IAAMsF,EAAEgnB,EAAEtsB,IAF4B,CAItD,OAAOqsB,CACX,CAeiFK,CAAOjiB,EAAI,CAAC,mBAAoB,aAAc,gBAC3H,MAAM,aAAE0N,EAAY,QAAEhO,GAAY4W,EAelC,OAHA0F,EAAMzS,SAASsT,IACXA,EAAK4E,KAAsB,CAAI,IAE5B,CACHS,UAfc5T,UACd,MAAM4Q,QAAmB,GAAYlD,EAAO/lB,OAAO+N,OAAO,CAAE+b,cACxDzJ,oBAAoBqL,IACxBjiB,EAAQ0e,cAAc,IAAIC,YAAY,eACtCa,EAAW3V,SAASsT,IACZA,EAAK4E,MACLC,EAAW7E,GACXA,EAAK4E,KAAsB,EAC/B,GACF,EAOFU,sBAAuB,IA7BD,EAACnG,EAAOtO,KAClC,MAAM2T,EAA6C,IAA3B3T,EAAagF,YAC/B4O,EAA4C,IAAxB5T,EAAazJ,SACjCme,EAAuBpG,EAAMnb,QAAQgc,IAAUA,EAAKva,QAAUua,EAAKva,OAAS+e,IAC5EgB,EAA0BrG,EAAMnb,QAAQgc,GAASA,EAAK5Y,UAAY4Y,EAAK5Y,SAAWqd,IACxF,OAAOc,EAAqB5nB,OAAS,GAAK6nB,EAAwB7nB,OAAS,CAAC,EAwB3C2nB,CAAsBnG,EAAOtO,GAC1D4U,YAAa,IAvBI,CAACtG,GAAUA,EAC/Bnb,QAAO,EAAGnB,aAAcwF,QAAQxF,aAAyC,EAASA,EAAQoP,cAC1FvF,SAAQ,EAAG7J,cAAgB,IAAIM,EAAI,OAAuF,QAA/EA,EAAKN,aAAyC,EAASA,EAAQoP,kBAA+B,IAAP9O,OAAgB,EAASA,EAAGiN,YAAYvN,EAAQ,IAqB5J6iB,CAAiBvG,GACvC,EElCL,GAXiB,CAAC3X,EAAOH,KACrB,MAAMse,EAAShmB,OAAOgmB,OAEtB,OADqBne,EAAQ,IAAMme,EAAOne,OAASH,EAAS,IAAMse,EAAOte,OAE9D,aAEPG,EAAQ,IACD,YAEJ,QAAQ,EDEnB,MAAQ9F,MAAK,YAAU,eAAa,oBAAkB,aAAW,YAAU,IAAK,EAC1EkkB,GAAW5lB,OAAO,YACX6lB,GAAa7lB,OAAO,cA2SjC,GAAK4lB,GAAU9hB,GAAK+hB,GACpB,IEzTI,GFyTJ,GAxSA,cAA0B,GAQtB,WAAAjV,CAAY1D,EAAWuM,GAAkB,YAAEqM,GAAc,EAAK,WAAEC,GAAa,EAAK,OAAE5Q,EAASmJ,QAAO,eAAEnH,GAAiB,GAAS,CAAC,GAC7H8D,MAAM9F,GACNxY,KAAK,IAAM,CACPqpB,SAAU,KACN,IAAKrpB,KAAKwiB,MACN,OAEJ,MAAM,UAAEkG,EAAS,sBAAEC,EAAqB,YAAEG,GAAgB,GAAS9oB,KAAKwiB,MAAO,CAC3EhK,OAAQxY,KAAKwY,OACb+N,YAAclD,GAASrjB,KAAKmiB,KAAK,GAAW,CACxCmH,OAAQtpB,KACRuP,KAAM8T,EACN7lB,KAAM,KAEV0qB,WAAa7E,GAASrjB,KAAKmiB,KAAK,GAAU,CACtCmH,OAAQtpB,KACRuP,KAAM8T,EACN7lB,KAAM,KAEVsf,iBAAkB9c,KAAK8c,mBAE3B9c,KAAKkpB,IAAYR,UAAYA,EAC7B1oB,KAAKkpB,IAAYJ,YAAcA,EAC/B9oB,KAAKkpB,IAAYP,sBAAwBA,EACzC3oB,KAAKkpB,IAAYK,kBAAkB9hB,KAAKqhB,EAAY,EAExDU,wBAAyB,KACrB,IAAIC,EACJ,MAAMC,EAAc,GAA0B1pB,KAAK8c,iBAAiB5W,SAAUyjB,IACtE3pB,KAAK4pB,cAAgB5pB,KAAKkpB,IAAYjlB,WAGnB,kBAAZ0lB,EAIPA,EACAF,EAAYzmB,OAAOrD,WAAWK,KAAKipB,IAAUY,yBAA0B,IAAM,IAG7E1pB,aAAaspB,GAPbzpB,KAAKipB,IAAUY,yBAAyB,IAQ5C,GACD,CAAElJ,kBAAmB,KACxB3gB,KAAKkpB,IAAYK,kBAAkB9hB,MAAK,KACpCiiB,IACAvpB,aAAaspB,GACRzpB,KAAKkpB,IAAYjlB,UAClBjE,KAAKipB,IAAUY,yBAAyB,GAC5C,GACF,EAENA,yBAA2BtgB,IACvBvJ,KAAKkpB,IAAYjlB,SAAWyH,QAAQnC,GACpCvJ,KAAKmiB,KAAK5Y,EAAO,CACb+f,OAAQtpB,KACRxC,KAAM+L,GACR,EAENugB,iBAAkB,KACd,MAAMJ,EAAc,GAA0B1pB,KAAK8c,iBAAiB5W,SAAUyjB,IACtE3pB,KAAK4pB,cAGc,kBAAZD,IACHA,EACA3pB,KAAK4E,SAGL5E,KAAKsE,QAEb,IAEJtE,KAAKkpB,IAAYK,kBAAkB9hB,KAAKiiB,EAAY,EAExDK,gBAAiB,KACb,MAAM,QAAE7jB,GAAYlG,KAAK8c,iBACzB9c,KAAKkpB,IAAYjf,KAAO,CACpBS,OAAQxE,EAAQkZ,aAChB4K,SAAU,GAAS9jB,EAAQmZ,YAAanZ,EAAQkZ,cAChDvU,MAAO3E,EAAQmZ,aAEnB,MAAMqK,EAAc,GAAgBxjB,GAAS,KACzC,GAAIlG,KAAK4pB,aACL,OAEJ,MAAMK,EAAWjqB,KAAKkpB,IAAYjf,KAC5BS,EAASxE,EAAQkZ,aACjBvU,EAAQ3E,EAAQmZ,YAClB3U,KAAYuf,aAA2C,EAASA,EAASvf,SAAWG,KAAWof,aAA2C,EAASA,EAASpf,QAC5J7K,KAAKkqB,OAAOrf,EAAOH,EAAQ,GAASG,EAAOH,GAC/C,IAEJ1K,KAAKkpB,IAAYK,kBAAkB9hB,KAAKiiB,EAAY,GAG5D1pB,KAAKmH,IAAM,CACPgjB,UAAU,EACVrO,SAAS,EACT7X,UAAU,EACVmmB,iBAAkB,GAClBb,kBAAmB,GACnBxQ,OAAQ,KACC/Y,KAAK4pB,eACN5pB,KAAKkpB,IAAYiB,UAAW,EAC5BnqB,KAAKkpB,IAAYK,kBAAkBxZ,SAASwI,GAAaA,MACzDvY,KAAKmiB,KAAKpJ,GAAQ,CACduQ,OAAQtpB,KACRxC,KAAMub,KAEd,EAEJsR,cAAe,KACX,MAAM,IAAI3pB,MAAM,wDAAwD,EAE5E4pB,gBAAiB,KACb,GAAItqB,KAAK4pB,aACL,MAAM,IAAIlpB,MAAM,0BACpB,GAIRV,KAAKuQ,UAAYA,EAEjBvQ,KAAK8c,iBAAmBA,EAExB9c,KAAKwiB,MAAQ,GAAcjS,GAC3BvQ,KAAKwa,eAAiBA,EACtBxa,KAAKkpB,IAAYK,kBAAkB9hB,KGxJb,CAACyM,IAG3B,IAAIqW,EAAe,EACfC,EAAe,EACnB,MAAMC,EAAgB,KAGdvW,EAAazJ,SAAW8f,EANL,IAQnBrW,EAAa5P,QAEb4P,EAAaiH,OACbjH,EAAagF,YAAcqR,EAC/B,EAEEG,EAAgB,KAClB,MAAMxR,EAAchF,EAAagF,YACXlc,KAAK8a,IAAIoB,EAAcqR,GAhBtB,GAkBnBC,GAAgB,EACZA,GAAgB,GAChBtW,EAAa5P,QAEjB4P,EAAagF,YAAcqR,GAG3BA,EAAerR,CACnB,EAIJ,OAFAhF,EAAaL,iBAAiB,aAAc6W,GAC5CxW,EAAaL,iBAAiB,QAAS4W,GAChC,KACHvW,EAAaN,oBAAoB,aAAc8W,GAC/CxW,EAAaN,oBAAoB,QAAS6W,EAAc,CAC3D,EHqH2C,CAAsBzqB,KAAK8c,iBAAiB5I,eACpFlU,KAAKipB,IAAUI,WACY9Y,EAAUgU,MAAK,EAAGrb,QAASA,GAAMwE,GAAYxE,MAEpElJ,KAAKkiB,KAAK,GAAOliB,KAAKipB,IAAUO,yBAEhCL,GACAnpB,KAAKkiB,KAAK,GAAOliB,KAAKipB,IAAUa,kBAEhCV,GACAppB,KAAKkiB,KAAK,GAAOliB,KAAKipB,IAAUc,gBAExC,CAOA,KAAAhlB,GACI/E,KAAKkpB,IAAYmB,eACrB,CAOA,MAAAzlB,GACI5E,KAAKkpB,IAAYmB,eACrB,CAOA,KAAA/lB,GACItE,KAAKkpB,IAAYmB,eACrB,CAOA,IAAAvlB,GACI9E,KAAKkpB,IAAYmB,eACrB,CASA,SAAAM,CAAUC,GACN5qB,KAAKkpB,IAAYmB,eACrB,CASA,SAAAQ,GACI7qB,KAAKkpB,IAAYmB,eACrB,CAMA,MAAAnqB,GACIF,KAAKkpB,IAAYmB,eACrB,CAMA,QAAA5f,GACIzK,KAAKkpB,IAAYmB,eACrB,CAIA,MAAApP,GACIjb,KAAKkpB,IAAYmB,eACrB,CAMA,WAAAnR,GACIlZ,KAAKkpB,IAAYmB,eACrB,CAQA,QAAAS,CAASvS,GACL,GAAwB,mBAAbA,EACP,MAAM,IAAIvZ,UAAU,gCAExBgB,KAAKkpB,IAAYK,kBAAkB9hB,KAAK,GAAa8Q,EAAUvY,KAAKwY,QACxE,CAQA,OAAAuS,CAAQxS,GACJ,GAAwB,mBAAbA,EACP,MAAM,IAAIvZ,UAAU,gCAExBgB,KAAKkpB,IAAYkB,iBAAiB3iB,KAAK,GAAa8Q,EAAUvY,KAAKwY,QACvE,CAIA,UAAAoR,GACI,OAAO5pB,KAAKkpB,IAAYiB,QAC5B,CAIA,SAAAa,GACI,OAAOhrB,KAAKkpB,IAAYpN,OAC5B,CASA,YAAMoO,CAAOrf,EAAOH,EAAQugB,GACxB,IAAI/K,EAAIgL,EAAIC,EAAIC,EAChBprB,KAAKkpB,IAAYjf,KAAO,CACpBS,SACAsf,SAAUiB,EACVpgB,SAEA7K,KAAKgrB,cAAgBhrB,KAAK4pB,cAAgB5pB,KAAKwiB,cACO,QAA9C0I,GAAMhL,EAAKlgB,KAAKkpB,KAAaJ,mBAAgC,IAAPoC,OAAgB,EAASA,EAAGvtB,KAAKuiB,UAC3C,QAA5CkL,GAAMD,EAAKnrB,KAAKkpB,KAAaR,iBAA8B,IAAP0C,OAAgB,EAASA,EAAGztB,KAAKwtB,IAErG,GE7SJ,MAAQvnB,SAAQ,iBAAuB,IAAK,EACtC,GAAWP,OAAO,YAwNxB,GAAK,GACL,OArNA,cAAyB,GAQrB,WAAA4Q,CAAY1D,EAAWuM,EAAkBze,EAAU,CAAC,GAChDigB,MAAM/N,EAAWuM,EAAkBze,GACnC2B,KAAK,IAAM,CACPqrB,aAAc,CAAC9hB,EAAOgG,KAClB,IAAIpI,EACJ,OAAQoC,GACJ,KAAK,GACDvJ,KAAKkpB,IAAYnQ,SACjB,MAEJ,KAAKuS,GACG/b,aAAgB7O,QAChBV,KAAK8D,MAAQyL,EACbvP,KAAKwQ,WACsB,QAArBrJ,EAAKnH,KAAK8D,aAA0B,IAAPqD,OAAgB,EAASA,EAAG1D,OAASD,EAAgBxD,KAAK8D,MAAML,MACzFzD,KAAK8D,MAAML,KACXF,EAAU+X,oCAExBtb,KAAKkpB,IAAYkB,iBAAiBra,SAASwI,GAAaA,EAASvY,KAAK8D,MAAO,CACzEwlB,OAAQtpB,KACRuQ,UAAWvQ,KAAKuQ,cAEpBvQ,KAAKkpB,IAAYnQ,SACjB,MAEJ,KAAK,GACD/Y,KAAKE,SAIbF,KAAKmiB,KAAK5Y,EAAO,CACb+f,OAAQtpB,KACRuP,OACA/R,KAAM+L,GACR,EAENmf,UAAW5T,UACP,IAAI3N,EAAI+Y,EAAIgL,EAAIC,EAChB,IAAInrB,KAAK4pB,qBAG2C,QAA5C1J,GAAM/Y,EAAKnH,KAAKkpB,KAAaR,iBAA8B,IAAPxI,OAAgB,EAASA,EAAGviB,KAAKwJ,KAC/B,QAAxDgkB,GAAMD,EAAKlrB,KAAKkpB,KAAaP,6BAA0C,IAAPwC,OAAgB,EAASA,EAAGxtB,KAAKutB,MAASlrB,KAAK4pB,cAAc,CAC/H,MAAM,aAAE1V,GAAiBlU,KAAK8c,iBAC9B,GAAK5I,EAAc,aAAclU,KAAK,IAAU0oB,UACpD,IAIR1oB,KAAKxC,KAAO,OACZ,MAAM,kBAAE+rB,GAAsBvpB,KAAKkpB,KAC7B,aAAEmC,GAAiBrrB,KAAK,IAC9BA,KAAKge,MAAQ3f,EAAQ2f,OAAS,CAAC,EAC/B,MAAMuN,EAAuB,GAAoB,CAC7CvN,MAAOhe,KAAKge,MACZxD,eAAgBxa,KAAKwa,eACrBjK,UAAWvQ,KAAKuQ,UAChBuM,iBAAkB9c,KAAK8c,kBACxBuO,GACH9B,EAAkB9hB,KAAK8jB,EAC3B,CAOA,WAAMxmB,GAEF,GADA/E,KAAKkpB,IAAYoB,kBACbtqB,KAAKgrB,YACL,MAAM,IAAI,GAAY,8BAE1B,MAAMhT,EAAWhY,KAAKuQ,UAAU,GAAGrH,IAC7B,aAAEgL,EAAY,QAAEhO,GAAYlG,KAAK8c,iBACjC0O,EAAQxT,GAAY,GAAcA,EAAU9D,EAAchO,EAASlG,KAAKge,OAC9E,GAAIwN,EACIxrB,KAAKwiB,aACCxiB,KAAK,IAAU0oB,aAErB8C,aAAqC,EAASA,EAAMtd,OACpDgG,EAAahG,IAAMsd,EAAMtd,IACzBlO,KAAKyrB,SAAWD,EAAMtd,KAE1BgG,EAAaiH,WAEZ,CACD,MAAMuQ,EAAc,IAAI,GAAY,uCACpCA,EAAYjoB,KAAOF,EAAUooB,2BAC7B3rB,KAAK,IAAUqrB,aAAaC,GAAUI,EAC1C,CACA1rB,KAAKkpB,IAAYpN,SAAU,CAC/B,CAOA,MAAAlX,GACI5E,KAAK8c,iBAAiB5I,aAAaiH,MACvC,CAOA,KAAA7W,GACItE,KAAK8c,iBAAiB5I,aAAa5P,OACvC,CAOA,IAAAQ,GACI,MAAMkT,EAAWhY,KAAKuQ,UAAU,GAAGrH,GAC7BmG,EAAa2I,GAAY5I,GAAc4I,GACvCkF,EAAqC,IAArBld,KAAKkZ,cACD,iBAAf7J,GAA2B6N,GAAiB7N,GACnDrP,KAAK,IAAUqrB,aAAa,GAEpC,CAIA,MAAApQ,GACI,OAAOjb,KAAK8c,iBAAiB5I,aAAa+G,MAC9C,CASA,SAAA0P,CAAUrR,GACNtZ,KAAK8c,iBAAiB5I,aAAaoF,OAASA,CAChD,CASA,SAAAuR,GACI,OAAO7qB,KAAK8c,iBAAiB5I,aAAaoF,MAC9C,CAMA,MAAApZ,GACIF,KAAKkpB,IAAYoB,kBACjBtqB,KAAK8c,iBAAiB5I,aAAa5P,QACnCtE,KAAKkpB,IAAYnQ,QACrB,CAMA,QAAAtO,GACI,OAAKzK,KAAKgrB,YAGHhrB,KAAK8c,iBAAiB5I,aAAazJ,SAF/B,CAGf,CAMA,WAAAyO,GACI,OAAKlZ,KAAKgrB,YAGHhrB,KAAK8c,iBAAiB5I,aAAagF,YAF/B,CAGf,CASA,YAAMgR,CAAOrf,EAAOH,EAAQsf,GAExB,SADM1L,MAAM4L,OAAOrf,EAAOH,EAAQsf,GAC9BhqB,KAAKgrB,cAAgBhrB,KAAK4pB,aAAc,CACxC,MAAM5R,EAAWhY,KAAKuQ,UAAU,GAAGrH,IAC7B,aAAEgL,EAAY,QAAEhO,GAAYlG,KAAK8c,iBACjC0O,EAAQxT,GAAY,GAAcA,EAAU9D,EAAchO,EAASlG,KAAKge,OAC1EwN,GAAStX,EAAahG,MAAQsd,EAAMtd,KE3NhC,EAACgG,EAAc2C,KAAc,IAAIhE,SAASC,IAC1D,MAAM8Y,EAAQ,CACV1S,YAAahF,EAAagF,YAC1B2S,SAAU3X,EAAa+G,QAEvB2Q,EAAMC,SACN3X,EAAa5P,QAEbuS,EAAU3I,MACVgG,EAAahG,IAAM2I,EAAU3I,KAEjCgG,EAAa4X,OACb,GAAK5X,EAAc,cAAc,KAC7BA,EAAagF,YAAc0S,EAAM1S,YAC7B0S,EAAMC,SACN3X,EAAaiH,OAEjBrI,GAAS,GACX,GACJ,EFyMc,CAAYoB,EAAcsX,EAElC,CACJ,GGhOG,MAAMO,GAAsB,CAC/B,kBACA,qBACA,qBACA,qBACA,eACA,yBACA,2BACA,kBACA,qBACA,qBACA,qBACA,kBACA,yBACA,4BAGJ,OADoB,EAAGvuB,UAAWuuB,GAAoBxH,MAAMyH,GAAaA,IAAaxuB,IChB/E,MAmBMyuB,GAAa,aAEbC,GAAW,WACXC,GAAY,YACZC,GAAY,YACZC,GAAY,YAEZC,GAAe,eAEfC,GAAmB,mBAEnBC,GAAwB,wBACxBC,GAAiB,iBACjBC,GAAe,eACfC,GAAe,eACfC,GAAuB,uBACvBC,GAAkB,kBAClBC,GAAuB,uBACvBC,GAAkB,kBAClBC,GAAc,cAEdC,GAAyB,yBACzBC,GAAiB,iBACjBC,GAAc,cACdC,GAAW,WACXC,GAAY,YAEZC,GAAU,UACVC,GAAS,CAClBrB,GACAC,GACAC,GACAC,GA1BkC,yBA4BlCC,GA1B0B,iBA4B1BC,GA1B4B,mBA4B5BC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GACAC,GA1ByB,gBA4BzBC,GACAC,GACAC,GACAC,GACAC,GA1BiB,QA4BjBC,ICxDJ,OAjBgB,CAACE,EAAYjkB,EAAOkkB,IAAY,IAAI5a,SAAQ,CAACC,EAASC,KAClE,IAAI0W,EACJ,MAAMnR,EAAU,KACW,iBAAZmV,GACPzqB,OAAO7C,aAAaspB,GAExB+D,EAAW9D,YAAYpR,EAAS/O,GAChCuJ,GAAS,EAEU,iBAAZ2a,IACPhE,EAAYzmB,OAAOrD,YAAW,KAC1B6tB,EAAW9D,YAAYpR,EAAS/O,GAChCwJ,EAAO,IAAIrS,MAAM,8BAA8B6I,MAAU,GAC1DkkB,IAEPD,EAAWE,UAAUpV,EAAS/O,EAAM,ICRxC,GANoB,CAACikB,EAAYG,EAAQpkB,KAAUpK,KAC/C,MAAMyuB,EAAc,GAAQJ,EAAYjkB,EAAO,KACzCskB,EAAiBL,EAAWG,GAElC,OADAE,SAAgEA,EAAevuB,MAAMkuB,EAAYruB,GAC1FyuB,CAAW,ECJtB,MAAME,GAASC,IACX,MAAMC,EAAQD,EAAQE,MAAM,KAC5B,OAAO3xB,SAAS0xB,EAAM,GAAI,GAAG,EAgBjC,ICnBI,GAaJ,MAAQpqB,SAAQ,QAAM,UAAQ,QAAM,SAAO,iBAAe,SAAO,UAAQ,cAAY,YAAU,iBAAe,gBAAc,SAAS,GAAUwB,YAAW,gBAAc,IAAK,EAEvK8oB,GAAeX,GAAOlmB,QAAQkC,GAAUA,IAAU2iB,KAClD,GAAW7oB,OAAO,YAiaxB,GAAK,GACL,OAvZA,cAA0B,GAQtB,WAAA4Q,CAAY1D,EAAWuM,EAAkBze,EAAU,CAAC,GAChDigB,MAAM/N,EAAWuM,EAAkBze,GACnC2B,KAAK,IAAM,CACPmuB,WAAY,CACR,CAACnB,IAAc,CAACoB,EAAKC,EAAKC,KAClBA,GACAtuB,KAAK,IAAUuuB,mBAAmBH,GAEtCpuB,KAAKmiB,KAAK,GAAc,CACpBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAAC+uB,IAAmB,KAChBvsB,KAAKmiB,KAAKnJ,GAAY,CAClBsQ,OAAQtpB,KACRxC,KAAMwb,IACR,EAEN,CAACsU,IAAWkB,IACRxuB,KAAK8D,MAtCC,CAAC0qB,IACvB,MAAM1qB,EAAQ0qB,aAAmB9tB,MAAQ8tB,EAAU,IAAI,GAAY,uBAInE,OAHK1qB,EAAML,MAASD,EAAgBM,EAAML,QACtCK,EAAML,KAAOF,EAAUkrB,aAEpB3qB,CAAK,EAiCiB4qB,CAAkBF,GAC/BxuB,KAAKwQ,UAAYxQ,KAAK8D,MAAML,KAC5BzD,KAAKkpB,IAAYkB,iBAAiBra,SAASwI,GAAaA,EAASvY,KAAK8D,MAAO,CACzEwlB,OAAQtpB,KACRuQ,UAAWvQ,KAAKuQ,cAEpBvQ,KAAKkpB,IAAYnQ,SACjB/Y,KAAKmiB,KAAK,GAAU,CAChBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAACkvB,IAAe,KAEP1sB,KAAK,IAAU2uB,YAChB3uB,KAAK,IAAU4uB,iBAAiBjC,IAEpC3sB,KAAKmiB,KAAK,GAAY,CAClBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAAC4vB,IAAW,KACRptB,KAAK,IAAUib,QAAS,EACxBjb,KAAKmiB,KAAK,GAAO,CACbmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAAC6vB,IAAY,KACTrtB,KAAK,IAAUib,QAAS,EACxBjb,KAAKmiB,KAAK,GAAQ,CACdmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAACgvB,IAAwB,KACrBxsB,KAAKmiB,KAAKnJ,GAAY,CAClBsQ,OAAQtpB,KACRxC,KAAMwb,IACR,EAEN,CAACqT,IAAY,KACTrsB,KAAKE,SACLF,KAAKmiB,KAAK,GAAM,CACZmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAAC2uB,IAAY,KACTnsB,KAAKmiB,KAAK,GAAc,CACpBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAAC4uB,IAAY,KACTpsB,KAAKmiB,KAAKiK,GAAW,CACjB9C,OAAQtpB,KACRxC,KAAM4uB,KAEVpsB,KAAKkpB,IAAYnQ,QAAQ,EAE7B,CAACkU,IAAyB,KACtBjtB,KAAKmiB,KAAK3c,EAAkB,CACxB8jB,OAAQtpB,KACRxC,KAAMgI,GACR,EAEN,CAAC2nB,IAAc,KACXntB,KAAKmiB,KAAK,GAAa,CACnBmH,OAAQtpB,KACRxC,KAAM,KAEVwC,KAAKkpB,IAAYnQ,QAAQ,EAE7B,CAACmU,IAAiB,KACdltB,KAAKmiB,KAAK1c,EAAY,CAClB6jB,OAAQtpB,KACRxC,KAAMiI,GACR,EAEN,CAACsnB,IAAkB,KACf/sB,KAAKmiB,KAAK,GAAU,CAChBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAACovB,IAAuB,KACpB5sB,KAAKmiB,KAAK,GAAe,CACrBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAACqvB,IAAkB,KACf7sB,KAAKmiB,KAAK,GAAU,CAChBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAACmvB,IAAe,KACP3sB,KAAK,IAAU2uB,aAChB3uB,KAAK,IAAU2uB,YAAa,EAC5B3uB,KAAK,IAAUib,QAAS,EACxBjb,KAAKmiB,KAAK,GAAO,CACbmH,OAAQtpB,KACRxC,KAAM,KAEd,EAEJ,CAACsvB,IAAuB,KACpB9sB,KAAKmiB,KAAK,GAAe,CACrBmH,OAAQtpB,KACRxC,KAAM,IACR,EAEN,CAACivB,IAAiB,KACd,MAAMnT,EAAStZ,KAAK6qB,YACpB7qB,KAAKmiB,KAAKrJ,GAAe,CACrBwQ,OAAQtpB,KACRxC,KAAMsb,KAEK,IAAXQ,GAAiBtZ,KAAK,IAAUqZ,QAChCrZ,KAAK,IAAUqZ,OAAQ,EACvBrZ,KAAKmiB,KAAK,GAAM,CACZmH,OAAQtpB,KACRxC,KAAM,MAGV8b,EAAS,GAAKtZ,KAAK,IAAUqZ,QAC7BrZ,KAAK,IAAUqZ,OAAQ,EACvBrZ,KAAKmiB,KAAK,GAAQ,CACdmH,OAAQtpB,KACRxC,KAAM,KAEd,GAGRoxB,iBAAkB,CAACrlB,KAAUpK,KACzB,MAAMmZ,EAAUtY,KAAK,IAAUmuB,WAAW5kB,GACtC+O,GACAA,KAAWnZ,GAEfa,KAAKmiB,KAAK5Y,EAAO,CACb+f,OAAQtpB,KACRxC,KAAM+L,GACR,EAENglB,mBAAqBH,IACjB,GAAIpuB,KAAKib,UAAYjb,KAAKwa,eAEtB,YADAxa,KAAK4E,SAGT,MAAMoT,EAAWhY,KAAKuQ,UAAU,GAAGrH,GAC7BqR,EAAiC,iBAAR6T,GAAoBA,EAAIptB,OAAS,EAC1DotB,EACApW,GAAY,GAAgBA,GAC9BhY,KAAKwa,gBACLxa,KAAKsE,QAELiW,GACAvX,OAAO6rB,KAAKtU,EAAiB,SACjC,EAEJuU,SAAU,KACN,IAAI3nB,EACJ,GAA+B,QAA1BA,EAAKnH,KAAKwtB,kBAA+B,IAAPrmB,OAAgB,EAASA,EAAG8kB,IAC/D,IACSjsB,KAAKwtB,WAAWvB,cACVjsB,KAAKwiB,KAEpB,CACA,MAAO1e,UACI9D,KAAKwiB,KAChB,CACJ,EAEJkG,UAAW5T,UACP,IAAI3N,EAAI+Y,EAAIgL,EAAIC,EACZnrB,KAAK4pB,qBAG2C,QAA5C1J,GAAM/Y,EAAKnH,KAAKkpB,KAAaR,iBAA8B,IAAPxI,OAAgB,EAASA,EAAGviB,KAAKwJ,KAC/B,QAAxDgkB,GAAMD,EAAKlrB,KAAKkpB,KAAaP,6BAA0C,IAAPwC,OAAgB,EAASA,EAAGxtB,KAAKutB,MAASlrB,KAAK4pB,cACjHjqB,WAAWK,KAAK,IAAU0oB,UAAW,KACzC,EAEJrP,OAAO,EACP4B,QAAQ,GAGZjb,KAAKxC,KAAO,QACZwC,KAAK,IAAU+uB,oBCpPFja,OAAOvE,EAAWuM,KACnC,MAAM7T,GAAasH,EAAU,GAAGrH,IAAM,GAAoBqH,EAAU,GAAGrH,KACnE,IAAI7B,OAAO,IAAa,GAC5B,IAAK4B,IAAaA,EAASiF,IACvB,MAAM,IAAIlP,UAAU,yDAExB,MAAM,IAAEkP,EAAG,KAAE1Q,GAASyL,EAGtB,aAFM6T,EAAiBpI,UAAUxG,EAAK,CAAE1Q,SACxBsf,EAAiBlI,iBAClBoa,YAAY,ED2Oc,CAAaze,EAAWuM,EACjE,CAOA,WAAM/X,GAEF,GADA/E,KAAKkpB,IAAYoB,kBACbtqB,KAAKgrB,YACL,MAAM,IAAItqB,MAAM,+BAEpB,IACIV,KAAKwtB,iBAAoBxtB,KAAK,IACzB+uB,oBACL,MAAME,EAAkB,GAAQjvB,KAAKwtB,WAAYtB,IACjD,IAAK,MAAMgD,KAAehB,GACtBluB,KAAKwtB,WAAWE,UAAU1tB,KAAK,IAAU4uB,iBAAiBO,KAAKnvB,KAAMkvB,GAAcA,GAOvF,GALAlvB,KAAK,IAAU8uB,WD9PT,EAACtB,EAAY4B,KAC3B,MAAMC,EAAkB7B,EAA2B,iBAAE4B,GACrD,IATgB,EAACA,EAAkBC,KACnC,MAAMC,EAAmBxB,GAAMuB,GAC/B,QAAIC,EAAmB,IAGhBA,GAAoBxB,GAAMsB,EAAiB,EAI7C,CAAYA,EAAkBC,GAC/B,MAAM,IAAI3uB,MAAM,qBAAqB2uB,mBAEnB,EC0Pd,CAAUrvB,KAAKwtB,WAAY,OEzQxB,EAACA,EAAY1Q,EAAkBvM,KAC1C,MAAM,MAAE1F,EAAK,OAAEH,GAAWoS,EAAiB5W,QAAQiS,wBAC7C8S,EAAO,GAASpgB,EAAOH,GAEvB6kB,E5EoYqB,CAACC,IAC5B,MAAMC,EAtBe,CAACD,IACtB,MACM/wB,EADc,8BACOoD,KAAK2tB,GAChC,OAAO/wB,aAAuC,EAASA,EAAO,EAAE,EAmB1CixB,CAAiBF,GACjCG,EAAeF,GAlBM,CAACD,IAC5B,MACM/wB,EADc,qDACOoD,KAAK2tB,GAChC,OAAQ/wB,aAAuC,EAASA,EAAO,GAAGV,QAAQ,4BAA6B,IAAIA,QAAQ,uBAAwB,IAAIA,QAAQ,wBAAyB,OAAOiJ,MAAO,EAexJ4oB,CAAuBH,GACvDI,IAAaJ,GAdI,CAACD,IACxB,MACM/wB,EADkB,2CACOoD,KAAK2tB,GACpC,MAAuE,UAA/D/wB,aAAuC,EAASA,EAAO,GAAc,EAW1CqxB,CAAmBL,GACtD,MAAO,CACHE,eACAE,aACH,E4E3YoB,CAAgBtf,EAAU,GAAGwf,KAClDjT,EAAiBtH,QAAQ3K,EAAOH,GAChC,MAAMslB,EAAkB,CACpBta,KAAMoH,EAAiBrH,YACvBwa,UAAWnT,EAAiB5I,aAC5Bgc,qBAAsBpT,EAAiBtI,wBAE3CgZ,EAAW2C,OAAOtlB,EAAOH,EAAQugB,GART,EAQ+BsE,EAAcS,EAAgB,EF+P7E,CAAOhwB,KAAKwtB,WAAYxtB,KAAK8c,iBAAkB9c,KAAKuQ,iBAC9C0e,GAEDjvB,KAAK8c,iBAAiBnI,cACvB,IACI,MAAM,aAAET,GAAiBlU,KAAK8c,iBAC1B5I,EAAamF,OACbrZ,KAAK,IAAUqZ,OAAQ,EACvBrZ,KAAK2qB,UAAU,IAGf3qB,KAAK2qB,UAAUzW,EAAaoF,cAE1B,GAAYtZ,KAAKwtB,WJtRpB,UIsRyCrB,IACxCnsB,KAAKwiB,aACCxiB,KAAK,IAAU0oB,YAEzB1oB,KAAKkpB,IAAYpN,SAAU,CAC/B,CACA,MAAOhY,GACH9D,KAAKE,QACT,CAER,CACA,MAAO4D,GAEH,MADA9D,KAAK,IAAU4uB,iBAAiBtB,GAASxpB,GACnCA,CACV,CACJ,CAOA,MAAAc,GACI,IAAIuC,EACuB,QAA1BA,EAAKnH,KAAKwtB,kBAA+B,IAAPrmB,GAAyBA,EAAW,UAC3E,CAOA,KAAA7C,GACI,IAAI6C,EACuB,QAA1BA,EAAKnH,KAAKwtB,kBAA+B,IAAPrmB,GAAyBA,EAAU,SAC1E,CAOA,IAAArC,GACI,IAAIqC,EACuB,QAA1BA,EAAKnH,KAAKwtB,kBAA+B,IAAPrmB,GAAyBA,EAAS,QACzE,CAIA,MAAA8T,GACI,OAAOjb,KAAK4pB,cAAgB5pB,KAAK,IAAUib,MAC/C,CASA,SAAA0P,CAAUrR,GACN,IAAInS,EACuB,QAA1BA,EAAKnH,KAAKwtB,kBAA+B,IAAPrmB,GAAyBA,EAAc,YAAEmS,EAChF,CASA,SAAAuR,GACI,OAAK7qB,KAAKwtB,WAGHxtB,KAAKwtB,WAAsB,cAFvB,CAGf,CAMA,YAAMttB,GACF,IAAIiH,EACJnH,KAAKkpB,IAAYoB,kBACjB,IACI,MAAM8F,EAAmBpwB,KAAKwtB,YAAc,GAAQxtB,KAAKwtB,WAAYpB,GAAW,KACrD,QAA1BjlB,EAAKnH,KAAKwtB,kBAA+B,IAAPrmB,GAAyBA,EAAS,eAC/DipB,CACV,CACA,MAAOtsB,GACH9D,KAAKkpB,IAAYnQ,QACrB,CACJ,CAQA,QAAAtO,GACI,IAAKzK,KAAKwtB,WACN,OAAO,EAEX,MAAM/iB,EAAWzK,KAAKwtB,WAAwB,gBAC9C,OAAI/iB,EAAW,EACJ,EAEJA,CACX,CAQA,WAAAyO,GACI,IAAKlZ,KAAKwtB,WACN,OAAO,EAEX,MAAM6C,EAAgBrwB,KAAKwtB,WAA6B,qBACxD,OAAI6C,EAAgB,EACT,EAEJrwB,KAAKyK,WAAa4lB,CAC7B,CASA,YAAMnG,CAAOrf,EAAOH,EAAQsf,GAExB,SADM1L,MAAM4L,OAAOrf,EAAOH,EAAQsf,GAC7BhqB,KAAKwtB,WAAV,CAGA,GAAIxtB,KAAKgrB,cAAgBhrB,KAAK4pB,aAAc,CACxC,MAAMlU,EAAO1V,KAAK8c,iBAAiBrH,YAC/BC,IACAA,EAAKlD,MAAM9H,OAAS,GAAGA,MACvBgL,EAAKlD,MAAM3H,MAAQ,GAAGA,MAE9B,CACA,OAAO,GAAY7K,KAAKwtB,WJ5aR,WI4a8BlB,GAAczhB,EAAOH,EAAQsf,EAR3E,CASJ,GGrZJ,GAvBA,SAA2BzZ,EAAWuM,EAAkBze,GACpD,MAAM,QAAEoS,EAAO,KAAEjT,GAASa,EACpBirB,EAAkB,UAAT9rB,EACT,IAAI,GAAY+S,EAAWuM,EAAkBze,GAC7C,IAAI,GAAWkS,EAAWuM,EAAkBze,GAiBlD,OAhBA5B,OAAOiH,OAAO,GAAcqM,SAASugB,GAAgBhH,EAAO1H,GAAG0O,GAAc/mB,IACzE,MAAQ/L,KAAM+yB,EAAO,KAAEhhB,GAAShG,EAC1BilB,EAAU,CACZjf,OACAiB,UAAW8Y,EAAO9Y,UAClBC,WxE4Ca,EAAClH,EAAOgH,GAAahB,OAAMiB,YAAWC,UAAU,GAAc+H,SAASmJ,YAC5F,MAAM6O,EAAgBnf,GAAe9H,GACjCinB,EACAA,EAAcjgB,EAAW,CACrBhB,KAAM9S,OAAO+N,OAAO/N,OAAO+N,OAAO,CAAC,EAAG+E,GAAO,CAAEiB,cAC/CA,YACAC,YAIJ+H,EAAO1U,MAAM,UAAUyF,uBAC3B,EwErDI,CAAiBgnB,EAAShgB,EAAWie,EAAQ,MAEjD/xB,OAAOiH,OAAO,GAAiBqM,SAAS0gB,GAAmBnH,EAAO1H,GAAG6O,GAAiBlnB,IAClF,MAAMilB,EAAU,CACZjf,KAAMhG,EAAMgG,KACZkB,WpEHgB,EAAClH,EAAOgH,GAAahB,OAAMkB,UAAU,GAAc+H,SAASmJ,YACpF,MAAM6O,EAAgB,GAAejnB,GACjCinB,EACAA,EAAcjgB,EAAW,CACrBhB,KAAM9S,OAAO+N,OAAO,CAAC,EAAG+E,GACxBkB,YAIJ+H,EAAO1U,MAAM,UAAUyF,uBAC3B,EoELI,CAAoBA,EAAM/L,KAAM+S,EAAWie,EAAQ,MAEhDlF,CACX,ECzBA,MAAMoH,WAAkBhwB,MACpB,WAAAuT,CAAYoK,GACRC,MAAMD,GACNre,KAAK2G,KAAO,YACZlK,OAAO8hB,eAAeve,KAAM0wB,GAAU7zB,UAC1C,EAEJ,UCCA,MAgBM8zB,GAAc,CAACrH,GAAUsH,eAAgB,IAAI/d,SAAQ,CAACC,EAASC,KACjE,MAAM8d,EAAuBtnB,GAAU,IAAMwJ,EAAO,IAAIrS,MAAM,wCAAwC6I,OACtG+f,EAAOyB,QAAQhY,GACfuW,EAAO1H,GAAG7c,GAAO,IAAM+N,EAAQwW,KAC/BA,EAAO1H,GAAGuL,GAAa0D,EAAoB1D,KAC3C7D,EAAO1H,GAAGxc,EAAayrB,EAAoBzrB,IAC3CkkB,EAAO1H,GAAGwK,GAAWyE,EAAoBzE,KACzCwE,EAAUtH,GACVA,EAAOvkB,OAAO,IA6BlB,OAbqB+P,MAAOvE,EAAWuM,EAAkBze,KAxCxC,EAACkS,EAAWuM,KACzB,IAAKrb,MAAM6L,QAAQiD,IAAmC,IAArBA,EAAUvP,OACvC,MAAM,IAAIhC,UAAU,qBAExB,KAAM8d,aAA4B,IAC9B,MAAM,IAAI9d,UAAU,2BACxB,EAmCA,CAASuR,EAAWuM,GACpB,IACI,YAjBkB,EAACvM,EAAWuM,EAAkBze,KACpD,MAAM2Z,EAAWzH,EAAU,GAAGrH,GAC9B,IAAK8O,IApBwBtM,QAAQ,GAoBFsM,IAAW,CAC1C,MAAMlU,EAAQ,IAAI,GAAU,oDAE5B,MADAA,EAAML,KAAOF,EAAUutB,0BACjBhtB,CACV,CACA,MAAMwlB,EAAS,GAAkB/Y,EAAWuM,EAAkBrgB,OAAO+N,OAAO/N,OAAO+N,OAAO,CAAC,EAAGnM,GAAU,CAAEb,KAAM,WAChH,OAAOmzB,GAAYrH,EAAQjrB,EAAQ,EASlB0yB,CAAkBxgB,EAAWuM,EAAkBze,EAChE,CACA,MAAOyF,GACH,MAAMkU,EAAWzH,EAAU,GAAGrH,GAC9B,GAAI8O,GAtCY,EAAC9O,EAAIgL,KACzB,MAAMlF,EAAa,GAAc9F,GACjC,QAAI8F,GACOA,EAAWuV,MAAM1N,GAAc,GAAQ3C,EAAc2C,IAEpD,EAiCQma,CAAgBhZ,EAAU8E,EAAiB5I,cACvD,MAZQ,EAAC3D,EAAWuM,EAAkBze,KAC9C,MAAMirB,EAAS,GAAkB/Y,EAAWuM,EAAkBrgB,OAAO+N,OAAO/N,OAAO+N,OAAO,CAAC,EAAGnM,GAAU,CAAEb,KAAM,UAChH,OAAOmzB,GAAYrH,EAAQjrB,EAAQ,EAUpB4yB,CAAY1gB,EAAWuM,EAAkBze,GAEpD,MAAMyF,CACV,GCDJ,GA9CYgR,MAAOvE,EAAWqC,EAAavU,KACvC,IAAIye,EACJ,IACI,MAAM,QAAE2Q,GAAYpvB,EACpBye,ECNuB,EAAClK,EAAasB,KACzC,IAAKtB,EACD,MAAM,IAAI5T,UAAU,2BAExB,OAAO,IAAI,GAAiB4T,EAAasB,EAAa,EDE/B,CAAuBtB,EAAavU,EAAQ6V,cAC/D,IAAIgd,EAAgB,GAAa3gB,EAAWuM,EAAkBze,GAC9D,GAAuB,iBAAZovB,EAAsB,CAC7B,IACIhE,EADA0H,GAAW,EAEf,MAAMC,EAAiB,IAAIve,SAAQ,CAACwe,EAAUte,KAC1C0W,EAAYzmB,OAAOrD,YAAW,KAC1B,MAAM,QAAE8Q,GAAYpS,EACpB,GAAWkS,EAAW,CAClBC,UAAWjN,EAAU+tB,wBACrB7gB,YAEJ0gB,GAAW,EACXpe,EAAO,IAAIrS,MAAM,iCAAiC,GACnDrC,EAAQovB,QAAQ,IAEvByD,EAAgBre,QAAQ0e,KAAK,CACzBL,EAAcxM,MAAM8M,IACZL,EACIK,EAAUxG,aACVwG,EAAUtxB,SAIdC,aAAaspB,GAEV+H,KAEXJ,GAER,CACA,MAAM9H,QAAe4H,EAIrB,OAHA5H,EAAOwB,UAAS,KACZhO,SAAoEA,EAAiBhH,SAAS,IAE3FwT,CACX,CACA,MAAOxlB,GAEH,MADAgZ,SAAoEA,EAAiBhH,UAC/EhS,CACV,GExDJ,MAAM,WAAmBpD,MACrB,WAAAuT,CAAYoK,GACRC,MAAMD,GACNre,KAAK2G,KAAO,aACZlK,OAAO8hB,eAAeve,KAAM,GAAWnD,UAC3C,ECLJ,MAAM40B,GAAYpuB,OAAO,aACZquB,GAAqBxoB,IAC9BA,EAAGuoB,KAAa,CAAI,ECyBlBE,GAAgBnC,IAClB,IACI,MC3BO,EAACnnB,EAAQupB,KACpB,MAAMC,EAASxpB,EAAOypB,gBAAgBF,EAAS,mBAE/C,OADA,mBAA2BC,GACpB,EAAUA,EAAO,E3FKS,CAAOxpB,E0FmBpBmnB,EACpB,CACA,MAAO1rB,GAEH,MADAA,EAAML,KAAOF,EAAUwuB,uBACjBjuB,CACV,GAgDEkuB,GAAYld,MAAOmd,EAAO5zB,EAASkS,EAAY,MACjD,IAAI/J,EACJ,MAAM0rB,EAAiB,CACnBC,WAAYF,GAEhB,IAAIG,EACA3E,EACJ,IACI,MAAM4E,EAvBK,EAAC9hB,EAAWlS,KAC3B,MAAMi0B,EAAW/hB,EAAU,GAErBgiB,EADoB7mB,QAAQ4mB,IAAaA,EAASppB,IAAM,GAAUopB,EAASppB,KACrCopB,EAASppB,GpFoExB,CAACA,IAC9B,MAAMsE,EAAiB,EAAItE,EAAI,WACzB7K,EAAU,CAAC,EACjB,GAAImP,EAAgB,CAChB,MAAM,iBAAEglB,EAAgB,eAAEC,EAAc,yBAAEC,GAA6BvqB,EAAcqF,GACjFglB,IACAn0B,EAAQm0B,iBAAmBpmB,GAAgBomB,IAE3CC,IACAp0B,EAAQo0B,eAAiBrmB,GAAgBqmB,IAEzCC,IACAr0B,EAAQq0B,yBAA2BtmB,GAAgBsmB,GAE3D,CACA,OAAOr0B,CAAO,EoFnF4Cs0B,CAAkBL,EAASppB,IAAM,CAAC,EAC5F,OAAOzM,OAAO+N,OAAO/N,OAAO+N,OAAO,CAAC,EAAG+nB,GAAiBl0B,EAAQ,EAmBtCu0B,CAAWriB,EAAWlS,GApF9B,EAACkS,GAAasiB,eAAe,MAC/C,GAAItiB,EAAUvP,OAAS6xB,EAAc,CACjC,MAAM/uB,EAAQ,IAAI,GAAU,yBAE5B,MADAA,EAAML,KAAOF,EAAUuvB,wBACjBhvB,CACV,GAgFIivB,CAAcxiB,EAAW8hB,GACzB,IAAIW,EA/EOle,OAAOmd,EAAO5zB,KAC7B,IAAImI,EACJ,IAAIwd,EACJ,IACIA,OFVMlP,OAAOiP,EAAU1lB,EAAU,CAAC,KACtC,MAGM40B,EAAex2B,OAAO+N,OAAO,CAAC,EAHnB,CACb0oB,YAAa,WAEgC70B,GAC3C2lB,QAAiBhhB,OAAOihB,MAAMF,EAAUkP,GAC9C,GAAIjP,EAASI,QAAU,IAAK,CACxB,MAAMtgB,EAAQ,IAAI,GAAWkgB,EAASK,YAEtC,MADAvgB,EAAMkgB,SAAWA,EACXlgB,CACV,CACA,OAAOkgB,CAAQ,EEDM,CAAMiO,EAAO5zB,GAC9B,MAAM0xB,QAAY/L,EAASjd,OAC3B,MAAO,CAAEid,WAAU+L,MACvB,CACA,MAAOjsB,GAGH,MAFAA,EAAML,KAAOF,EAAU4vB,8BACG,QAAzB3sB,EAAK1C,EAAMkgB,gBAA6B,IAAPxd,IAAsB1C,EAAMkgB,SAAWA,GACnElgB,CACV,GAmEuBsvB,CAAWnB,EAAOI,GACA,iBAA1BA,EAAc5E,UACrBA,EAAU4E,EAAc5E,QACxB2E,EAAQ/0B,KAAKD,MACb41B,EAAengB,QAAQ0e,KAAK,CACxByB,EACA,IAAIngB,SAAQ,CAACwe,EAAUte,KACnBpT,YAAW,KACP,MAAMmE,EAAQ,IAAI,GAAU,qBAC5BA,EAAML,KAAOF,EAAU8vB,kBACvBtgB,EAAOjP,EAAM,GACd2pB,EAAQ,OAIvB,MAAM,SAAEzJ,EAAQ,IAAE+L,SAAciD,EAMhC,OALAd,EAAelO,SAAWA,EAC1BkO,EAAenC,IAAMA,EACrBmC,EAAexhB,UAAYihB,GAAaO,EAAenC,KACvDmC,EAAehpB,GA3ET,CAACwH,IACX,IACI,MAAMxH,EpF4DY,CAAC4D,IACvB,MAAME,EAAMH,GAAOC,GACnB,GAAIrL,MAAM6L,QAAQN,IAAQA,EAAIhM,OAAS,EACnC,OAAIqM,GAASP,GACFE,EAAI3F,OAAO+F,IAASoK,KAAKlL,IAAmB,GAEhDU,EAAI,EACf,EoFnEesmB,CAAW5iB,GACtB,GAAIxH,EAEA,OADAwoB,GAAkBxoB,GACXA,EAEX,MAAM,IAAIxI,MAAM,QACpB,CACA,MAAOoD,GAEH,MADAA,EAAML,KAAOF,EAAUgwB,0BACjBzvB,CACV,GA+DwB0vB,CAAMtB,EAAexhB,WA7DxB,GAAGxH,KAAIwH,cAAe8hB,oBAAmB,EAAME,4BAA2B,MAC/F,IAAK,GAAUxpB,KpFqEK,CAACA,GAAOwC,QAAQ,EAAIxC,GAAM,CAAC,EAAG,WoFrE3B,CAASA,GAAK,CACjC,MAAMpF,EAAQ,IAAI,GAAU,wDAE5B,MADAA,EAAML,KAAOF,EAAUkwB,6BACjB3vB,CACV,CACA,GAAIuJ,GAASqD,KAAe8hB,EAAkB,CAC1C,MAAM1uB,EAAQ,IAAI,GAAU,gCAE5B,MADAA,EAAML,KAAOF,EAAUmwB,2BACjB5vB,CACV,CACA,GAAI,GAAUoF,KAAQwpB,EAA0B,CAC5C,MAAM5uB,EAAQ,IAAI,GAAU,gDAE5B,MADAA,EAAML,KAAOF,EAAUowB,wBACjB7vB,CACV,GA+CI8vB,CAAiB1B,EAAgBG,GAC7B,GAAUH,EAAehpB,KACrBkpB,GAAS3E,IACTA,GAAWpwB,KAAKD,MAAQg1B,GAErBJ,GAAUzkB,GAAgB2kB,EAAehpB,IAAKzM,OAAO+N,OAAO/N,OAAO+N,OAAO,CAAC,EAAG6nB,GAAgB,CAAE5E,YAAY,CAACyE,KAAmB3hB,KAEpI,CAAC2hB,KAAmB3hB,EAC/B,CACA,MAAOzM,GAQH,OANKN,EAAgBM,EAAML,QACvBK,EAAML,KAAOF,EAAUswB,eAE3B3B,EAAe1hB,UAAY1M,EAAML,KACjCyuB,EAAepuB,MAAQA,EACY,QAAlC0C,EAAK0rB,EAAelO,gBAA6B,IAAPxd,IAAsB0rB,EAAelO,SAAWlgB,EAAMkgB,UAC1F,CAACkO,KAAmB3hB,EAC/B,GAEJ,UEhIA,MAgBMujB,GAAgB,CAACvjB,EAAWlS,KAhBZ,CAACkS,IACnB,IAAK9O,MAAM6L,QAAQiD,GACf,MAAM,IAAIvR,UAAU,sBAExB,GAAyB,IAArBuR,EAAUvP,OACV,MAAM,IAAIN,MAAM,wBACpB,EAWA,CAAc6P,GACd,MAAMwjB,EAAexjB,EAAU,GACzByjB,ECjBQ,GAAG9qB,KAAIwH,cAAe+hB,kBAAiB,EAAMwB,eAAc,MACzE,MACMC,EADMrnB,GAAO6D,GACMrJ,QAAQ8sB,IJDH,CAACjrB,GAAOwC,QAAQxC,EAAGuoB,KICE2C,CAAmBD,KACtE,IAAIH,EAYJ,OAXI3mB,GAASqD,IACLujB,IACAD,EAASE,EAAa7sB,QAAQ8sB,IAAkB/mB,GAAQ+mB,KAAe,IAEvEjrB,IAAO8qB,IACPA,EAbO,EAACK,EAAYrnB,KAC5B,MAAMsnB,GAAmBrnB,GAAiBonB,IAAe,GAAK,EAC9D,OAAOrnB,EAAInF,MAAMqB,GAAO+D,GAAiB/D,KAAQorB,GAAgB,EAWhDC,CAAWrrB,EAAIgrB,KAGvBA,EAAalzB,OAAS,GAAKyxB,IAChCuB,EAASE,EAAa,IAEnBF,CAAM,EDEE,CAAUD,EAAc11B,GACvC,GAAI21B,EAAQ,CACR,MAGMQ,EAAe,CAHG/3B,OAAO+N,OAAO,CAAC,EAAGupB,EAAc,CACpD7qB,GAAI8qB,OAEkCzjB,EAAUrS,MAAM,IAE1D,OADAwzB,GAAkBsC,GACd,GAAUA,GACH,GAAUzmB,GAAgBymB,GAAS31B,EAASm2B,GAEhD3hB,QAAQC,QAAQ0hB,EAC3B,CACA,OAAOV,GAAcvjB,EAAUrS,MAAM,GAAIG,EAAQ,EAErD,UEpBA,MAoBMo2B,GAAmBlc,GAAa,IAAIpZ,KACd,mBAAboZ,GACPA,KAAYpZ,EAChB,EAqBEu1B,GAAY5f,MAAO6f,EAAgB/hB,EAAapM,EAAIouB,KACtD,IAAIv2B,EA9D8B,SAAUgD,EAAG0B,GAC/C,IAAIqlB,EAAI,CAAC,EACT,IAAK,IAAIC,KAAKhnB,EAAO5E,OAAOI,UAAUsG,eAAexF,KAAK0D,EAAGgnB,IAAMtlB,EAAEulB,QAAQD,GAAK,IAC9ED,EAAEC,GAAKhnB,EAAEgnB,IACb,GAAS,MAALhnB,GAAqD,mBAAjC5E,OAAO8rB,sBACtB,KAAIxsB,EAAI,EAAb,IAAgBssB,EAAI5rB,OAAO8rB,sBAAsBlnB,GAAItF,EAAIssB,EAAErnB,OAAQjF,IAC3DgH,EAAEulB,QAAQD,EAAEtsB,IAAM,GAAKU,OAAOI,UAAU2rB,qBAAqB7qB,KAAK0D,EAAGgnB,EAAEtsB,MACvEqsB,EAAEC,EAAEtsB,IAAMsF,EAAEgnB,EAAEtsB,IAF4B,CAItD,OAAOqsB,CACX,CAoDkB,CAAO5hB,EAAI,IACzB,IAAI+J,EACAskB,EACAvL,EACJ,MAAM,UAAEwL,EAAS,QAAE/J,EAAO,YAAEgK,GAAgB12B,EAC5C,IAKI,GAJ+B,iBAApBA,EAAQovB,UACfoH,EAAWx3B,KAAKD,OAEpBmT,QAAkBokB,IACdC,IAEA,YADAG,IAGJ,GAAI12B,EAAQovB,SAAWoH,EAAU,CAC7B,MAAMG,EAAW33B,KAAKD,MACtBiB,EAAQovB,SAAWuH,EAAWH,EAC9BA,EAAWG,CACf,CAGA,GAjEkB,EAACzkB,EAAWlS,KAClC,IAAImI,EACJ,IAAK+J,GAAkC,IAArBA,EAAUvP,OACxB,MAAM,IAAIN,MAAM,qBAEpB,MAAMu0B,EAAmB1kB,EAAU,GACnC,IAAKlS,EAAQ62B,cAPD,CAAC3kB,GAAc7E,QAAQ6E,EAAU,GAAGrH,IAAM,GAAoBqH,EAAU,GAAGrH,KAO1DisB,CAAQ5kB,GAAY,CAC7C,MAAMzM,EAAQ,IAAI,GAAU,qDAC5BA,EAAML,KAAOF,EAAUowB,wBACvBsB,EAAiBzkB,UAAYjN,EAAUowB,wBACvCsB,EAAiBnxB,MAAQA,CAC7B,CACA,GAAImxB,EAAiBnxB,MACjB,MAAMmxB,EAAiBnxB,MAEwE,mBAA9D,QAAxB0C,EAAKnI,EAAQ2f,aAA0B,IAAPxX,OAAgB,EAASA,EAAG4uB,uBACrE/2B,EAAQ2f,MAAMoX,qBAAqB7kB,EACvC,EA8CI8kB,CAAkB9kB,EAAWlS,GAC7BirB,QAAe,GAxCO,EAAC/Y,GAAayN,WACmD,mBAA/EA,aAAqC,EAASA,EAAMsX,uBACrDtX,EAAMsX,sBAAsB/kB,GAEhCA,EAoCgB+kB,CAAsB/kB,EAAWlS,GAAUuU,EAAanW,OAAO+N,OAAO,CAAC,EAAGnM,IACzFu2B,IAGA,OAFAtL,EAAOppB,cACP60B,IAGJzL,EAAOyB,QAAQA,GACfzB,EAAOwB,SAASiK,GAChBD,EAAUxL,EACd,CACA,MAAOxlB,GAMH,GAlDgB,EAACA,EAAOyM,EAAWE,KACvC,IAAIjK,EACJ,IAAIgK,GAA2F,QAA7EhK,EAAK+J,aAA6C,EAASA,EAAU,UAAuB,IAAP/J,OAAgB,EAASA,EAAGgK,aAAe1M,aAAqC,EAASA,EAAML,MAClM8M,GAAaC,IACRhN,EAAgBgN,KACjBA,EAAYjN,EAAUswB,eAE1B,GAAWtjB,EAAW,CAClBC,YACAC,YAER,EAkCI8kB,CAAgBzxB,EAAOyM,EAAWlS,EAAQoS,SAC1Csa,EAAQjnB,EAAO,CACXwlB,SACA/Y,eAECA,GAAaqkB,IAEd,YADAG,IAMJ,GAHI12B,EAAQovB,SAAWoH,IACnBx2B,EAAQovB,SAAWpwB,KAAKD,MAAQy3B,GAEhCA,GAAYx2B,EAAQovB,SAAWpvB,EAAQovB,SAAW,EAElD,YADAsH,IAGJL,IAAU,IAAM,GAAcnkB,EAAWlS,IAAUuU,EAAanW,OAAO+N,OAAO,CAAC,EAAGnM,GAAUu2B,EAChG,GAgCJ,OAtBqB,CAAC3C,EAAOrf,EAAavU,KACtC,IACIirB,EADAkM,GAAW,EAEf,MACMC,EAAmBhB,GAAgBp2B,EAAQy2B,WAK3CzC,EAAgB51B,OAAO+N,OAAO/N,OAAO+N,OAAO,CAAE0qB,cAAc,GAAQ72B,GAAU,CAAEuyB,UAAW6D,GAAgBp2B,EAAQuyB,WAAYkE,UAJlHtD,IACflI,EAASkI,EACTiE,EAAiBnM,EAAO,EAEoHyB,QAAS0J,GAAgBp2B,EAAQ0sB,SAAUgK,YAAaN,GAAgBp2B,EAAQ02B,eAMhO,OAJI12B,EAAQ6V,cAAgB7V,EAAQ6V,aAAa+G,QCnIjC,mBAAmBhd,KAAKy3B,UAAUC,aAAe3yB,OAAO4yB,UDoIpEv3B,EAAQ6V,aAAa4X,OAEzB4I,IAAU,IAAM,GAAUzC,EAAOI,IAAgBzf,EAAayf,GAX3C,IAAMmD,IAYlB,KACHA,GAAW,EACPlM,IAAWA,EAAOM,cAClBN,EAAOppB,QACX,CACH,EE1ILgS,SAAS2B,iBAAiB,oBAAoB,KAC1C,MAAMgiB,EAAW3jB,SAAS4jB,cAAc,UAClCC,EAAU7jB,SAAS4jB,cAAc,kBACjC5hB,EAAehC,SAAS4jB,cAAc,qBACtChZ,EAAmB5K,SAAS4jB,cAAc,uBAChD,IAAIxM,EACJ,MAAMsH,EAAaY,IACflI,EAASkI,EACT7P,QAAQqG,IAAI,gBAAiBsB,GAC7B,MAAM0M,EAAgBzsB,IAClBoY,QAAQqG,IAAI,OAAOze,EAAM/L,OAAQ+L,EAAM+f,OAAO,EAElD,CACI,QACA,SACA,SACA,aACA,QACA,OACA,gBACA,WACA,gBACA,YACFvZ,SAASkmB,IACP3M,EAAO1H,GAAGqU,EAAWD,EAAa,GACpC,EAEAE,EAAe,KACjB,MAAMjE,EAAQ4D,EAASt4B,MACjB2Q,EAAMgG,EAAahG,IACnBioB,EAAgB,KAClBjiB,EAAaiH,OACbjH,EAAaN,oBAAoB,wBAAyBuiB,GAC1DjiB,EAAaN,oBAAoB,UAAWuiB,EAAc,EAkB9DrZ,EAAiBxI,UAAUC,IAAI,UAC/BL,EAAa5P,QACb4P,EAAagF,YAAc,EAC3ByI,QAAQqG,IAAI,YAAaiK,GACzB,GAAaA,EAAOnV,EAAkB,CAClC8T,YACA7F,QAtBajnB,IACb6d,QAAQqG,IAAI,cAAelkB,EAAM,EAsBjCixB,YApBgB,KAChBpT,QAAQqG,IAAI,mBACZlL,EAAiBxI,UAAU8hB,OAAO,UAC9BliB,EAAahG,MAAQA,EACrBgG,EAAaiH,QAGbjH,EAAaL,iBAAiB,wBAAyBsiB,GACvDjiB,EAAaL,iBAAiB,UAAWsiB,GACzCjiB,EAAahG,IAAMA,EACnBgG,EAAa4X,OACjB,EAUA2B,QAAS,KACTvZ,eACAgf,YAAa,QACf,EAEN2C,EAAShiB,iBAAiB,UAAU,KAClBgiB,EAASt4B,OAEnBw4B,EAAQzhB,UAAUC,IAAI,UACtBwhB,EAAQliB,iBAAiB,QAASqiB,KAGlCH,EAAQzhB,UAAU8hB,OAAO,UACzBL,EAAQniB,oBAAoB,QAASsiB,GACzC,GACF,G","sources":["webpack:///video-ad-sdk/webpack/universalModuleDefinition","webpack:///video-ad-sdk/./node_modules/lodash.debounce/index.js","webpack:///video-ad-sdk/./node_modules/sane-domparser-error/index.js","webpack:///video-ad-sdk/webpack/bootstrap","webpack:///video-ad-sdk/webpack/runtime/compat get default export","webpack:///video-ad-sdk/webpack/runtime/define property getters","webpack:///video-ad-sdk/webpack/runtime/global","webpack:///video-ad-sdk/webpack/runtime/hasOwnProperty shorthand","webpack:///video-ad-sdk/webpack/runtime/make namespace object","webpack:///video-ad-sdk/./src/tracker/errorCode.ts","webpack:///video-ad-sdk/./src/tracker/linearEvents.ts","webpack:///video-ad-sdk/./src/tracker/nonLinearEvents.ts","webpack:///video-ad-sdk/./src/types/xml.ts","webpack:///video-ad-sdk/./src/xml/helpers/xmlToJson.ts","webpack:///video-ad-sdk/./src/xml/helpers/xmlSelectors.ts","webpack:///video-ad-sdk/./src/xml/index.ts","webpack:///video-ad-sdk/./src/vastSelectors/helpers/parseTime.ts","webpack:///video-ad-sdk/./src/vastSelectors/helpers/parseOffset.ts","webpack:///video-ad-sdk/./src/vastSelectors/helpers/getLinearCreative.ts","webpack:///video-ad-sdk/./src/vastSelectors/getLinearTrackingEvents.ts","webpack:///video-ad-sdk/./src/vastSelectors/getIcons.ts","webpack:///video-ad-sdk/./src/vastSelectors/index.ts","webpack:///video-ad-sdk/./src/tracker/helpers/parseMacro.ts","webpack:///video-ad-sdk/./src/tracker/helpers/pixelTracker.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackError.ts","webpack:///video-ad-sdk/./src/tracker/helpers/createVastEventTracker.ts","webpack:///video-ad-sdk/./src/tracker/trackLinearEvent.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackIconClick.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackIconView.ts","webpack:///video-ad-sdk/./src/tracker/helpers/trackProgress.ts","webpack:///video-ad-sdk/./src/tracker/trackNonLinearEvent.ts","webpack:///video-ad-sdk/./src/vastSelectors/getNonLinearTrackingEvents.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/getContentDocument.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/supportsSrcdoc.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createIframe.ts","webpack:///video-ad-sdk/./src/adContainer/VideoAdContainer.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/getOrigin.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/unique.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createAdContainer.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createAdVideoElement.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/loadScript.ts","webpack:///video-ad-sdk/./src/adContainer/helpers/createSlot.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/guessMimeType.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/canPlay.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/sortMediaByBestFit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/findBestMedia.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/once.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/progress/getProgressEvents.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/safeCallback.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onFullscreenChange.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onPlayPause.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onRewind.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onSkip.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onError.ts","webpack:///video-ad-sdk/./src/adUnit/adUnitEvents.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onTimeUpdate.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onVolumeChange.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onImpression.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/progress/toFixedDigits.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/progress/formatProgress.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onProgress.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/onClickThrough.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/handlers/index.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/metrics/setupMetricHandlers.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/adUnitError.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/helpers/MutationObserver.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/onElementResize.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/helpers/IntersectionObserver.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/elementObservers/onElementVisibilityChange.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/Emitter/index.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/getResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/retrieveIcons.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/waitFor.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/fetch/fetchHtml.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createHtmlResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/loadResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createStaticResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/resources/createIframeResource.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/canBeRendered.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/renderIcon.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/updateIcon.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/renderIcons.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/canBeShown.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/icons/addIcons.ts","webpack:///video-ad-sdk/./src/adUnit/VideoAdUnit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/viewmode.ts","webpack:///video-ad-sdk/./src/adUnit/VastAdUnit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/dom/preventManualProgress.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/media/updateMedia.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/isSupported.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/api.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/waitFor.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/callAndWait.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/handshake.ts","webpack:///video-ad-sdk/./src/adUnit/VpaidAdUnit.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/loadCreative.ts","webpack:///video-ad-sdk/./src/adUnit/helpers/vpaid/initAd.ts","webpack:///video-ad-sdk/./src/adUnit/createVideoAdUnit.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/vastError.ts","webpack:///video-ad-sdk/./src/runner/helpers/startVideoAd.ts","webpack:///video-ad-sdk/./src/runner/run.ts","webpack:///video-ad-sdk/./src/adContainer/createVideoAdContainer.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/fetch.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/adUtils.ts","webpack:///video-ad-sdk/./src/vastRequest/requestAd.ts","webpack:///video-ad-sdk/./src/xml/helpers/xml2js.ts","webpack:///video-ad-sdk/./src/vastRequest/requestNextAd.ts","webpack:///video-ad-sdk/./src/vastRequest/helpers/getNextAd.ts","webpack:///video-ad-sdk/./src/runner/runWaterfall.ts","webpack:///video-ad-sdk/./src/utils/isIOS.ts","webpack:///video-ad-sdk/./demo/index.ts"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse {\n\t\tvar a = factory();\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(self, function() {\nreturn ","/**\n * lodash (Custom Build) <https://lodash.com/>\n * Build: `lodash modularize exports=\"npm\" -o ./`\n * Copyright jQuery Foundation and other contributors <https://jquery.org/>\n * Released under MIT license <https://lodash.com/license>\n * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>\n * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors\n */\n\n/** Used as the `TypeError` message for \"Functions\" methods. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar objectToString = objectProto.toString;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        result = wait - timeSinceLastCall;\n\n    return maxing ? nativeMin(result, maxWait - timeSinceLastInvoke) : result;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\n/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return !!value && (type == 'object' || type == 'function');\n}\n\n/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return !!value && typeof value == 'object';\n}\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && objectToString.call(value) == symbolTag);\n}\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = debounce;\n","'use strict';\n\nvar innerXML = function (node) {\n    var s = new XMLSerializer();\n    return Array.prototype.map.call(node.childNodes, function (node) {\n        return s.serializeToString(node);\n    }).join('');\n};\n\nvar getParseError = function (doc) {\n    // Firefox\n    if (doc.documentElement.tagName === 'parsererror' &&\n        doc.documentElement.namespaceURI === 'http://www.mozilla.org/newlayout/xml/parsererror.xml') {\n        return doc.documentElement;\n    }\n\n    // Chrome, Safari\n    if ((doc.documentElement.tagName === 'xml' || doc.documentElement.tagName === 'html') &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0];\n    }\n\n    // PhantomJS\n    if (doc.documentElement.tagName === 'html' &&\n        doc.documentElement.childNodes &&\n        doc.documentElement.childNodes.length > 0 &&\n        doc.documentElement.childNodes[0].nodeName === 'body' &&\n        doc.documentElement.childNodes[0].childNodes &&\n        doc.documentElement.childNodes[0].childNodes.length &&\n        doc.documentElement.childNodes[0].childNodes[0].nodeName === 'parsererror') {\n        return doc.documentElement.childNodes[0].childNodes[0];\n    }\n\n    return undefined;\n};\n\nvar errorMessagePatterns = [\n    // Chrome, Safari, PhantomJS\n    new RegExp('^<h3[^>]*>This page contains the following errors:<\\/h3><div[^>]*>(.+?)\\n?<\\/div>'),\n    // Firefox\n    new RegExp('^(.+)\\n')\n];\n\nvar extractParseError = function (errorNode) {\n    var content = innerXML(errorNode);\n    var i, match;\n\n    for(i = 0; i < errorMessagePatterns.length; i++) {\n        match = errorMessagePatterns[i].exec(content);\n\n        if (match) {\n            return match[1];\n        }\n    }\n    return undefined;\n};\n\nvar failOnParseError = function (doc) {\n    var errorMessage;\n\n    if (doc === null) {\n        throw new Error('Parse error');\n    }\n\n    var parseError = getParseError(doc);\n    if (parseError !== undefined) {\n        errorMessage = extractParseError(parseError) || 'Parse error';\n        throw new Error(errorMessage);\n    }\n};\n\nexports.failOnParseError = function (doc) {\n    failOnParseError(doc);\n\n    return doc;\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","export var ErrorCode;\n(function (ErrorCode) {\n    ErrorCode[ErrorCode[\"VAST_XML_PARSING_ERROR\"] = 100] = \"VAST_XML_PARSING_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_SCHEMA_VALIDATION_ERROR\"] = 101] = \"VAST_SCHEMA_VALIDATION_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_UNSUPPORTED_VERSION\"] = 102] = \"VAST_UNSUPPORTED_VERSION\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_AD_TYPE\"] = 200] = \"VAST_UNEXPECTED_AD_TYPE\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_LINEARITY\"] = 201] = \"VAST_UNEXPECTED_LINEARITY\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_DURATION_ERROR\"] = 202] = \"VAST_UNEXPECTED_DURATION_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_UNEXPECTED_MEDIA_FILE\"] = 203] = \"VAST_UNEXPECTED_MEDIA_FILE\";\n    ErrorCode[ErrorCode[\"VAST_WRAPPER_ERROR\"] = 300] = \"VAST_WRAPPER_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_LOAD_TIMEOUT\"] = 301] = \"VAST_LOAD_TIMEOUT\";\n    ErrorCode[ErrorCode[\"VAST_TOO_MANY_REDIRECTS\"] = 302] = \"VAST_TOO_MANY_REDIRECTS\";\n    ErrorCode[ErrorCode[\"VAST_NO_ADS_AFTER_WRAPPER\"] = 303] = \"VAST_NO_ADS_AFTER_WRAPPER\";\n    ErrorCode[ErrorCode[\"VIDEO_PLAY_ERROR\"] = 400] = \"VIDEO_PLAY_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_MEDIA_FILE_NOT_FOUND\"] = 401] = \"VAST_MEDIA_FILE_NOT_FOUND\";\n    ErrorCode[ErrorCode[\"VAST_MEDIA_LOAD_TIMEOUT\"] = 402] = \"VAST_MEDIA_LOAD_TIMEOUT\";\n    ErrorCode[ErrorCode[\"VAST_LINEAR_ASSET_MISMATCH\"] = 403] = \"VAST_LINEAR_ASSET_MISMATCH\";\n    ErrorCode[ErrorCode[\"VAST_PROBLEM_DISPLAYING_MEDIA_FILE\"] = 405] = \"VAST_PROBLEM_DISPLAYING_MEDIA_FILE\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_PLAYING_FAILED\"] = 500] = \"VAST_NONLINEAR_PLAYING_FAILED\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_DIMENSIONS_ERROR\"] = 501] = \"VAST_NONLINEAR_DIMENSIONS_ERROR\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_LOADING_FAILED\"] = 502] = \"VAST_NONLINEAR_LOADING_FAILED\";\n    ErrorCode[ErrorCode[\"VAST_NONLINEAR_ASSET_MISMATCH\"] = 503] = \"VAST_NONLINEAR_ASSET_MISMATCH\";\n    ErrorCode[ErrorCode[\"UNKNOWN_ERROR\"] = 900] = \"UNKNOWN_ERROR\";\n    ErrorCode[ErrorCode[\"VPAID_ERROR\"] = 901] = \"VPAID_ERROR\";\n})(ErrorCode || (ErrorCode = {}));\nexport const isVastErrorCode = (code) => Object.values(ErrorCode).includes(code);\n","/**\n * Interface for classes that may emit linear VAST events.\n *\n * @interface LinearEvents\n */\n/**\n * Fires when the the creative was played to the end at normal speed so that 100% of the creative was played.\n *\n * @event LinearEvents#complete\n */\nexport const complete = 'complete';\n/**\n * Fires when a user clicks the ad.\n *\n * @event LinearEvents#clickThrough\n */\nexport const clickThrough = 'clickThrough';\n/**\n * Fires when there was an error with the linear creative.\n *\n * @event LinearEvents#error\n */\nexport const error = 'error';\n/**\n * Fires when the creative played continuously for at least 25% of the total duration at normal speed.\n *\n * @event LinearEvents#firstQuartile\n */\nexport const firstQuartile = 'firstQuartile';\n/**\n * Fires when there was an impression of the linear creative.\n *\n * @event LinearEvents#impression\n */\nexport const impression = 'impression';\n/**\n * Fires when more than 50% of the creative is visible.\n *\n * @event LinearEvents#viewable\n */\nexport const viewable = 'viewable';\n/**\n * Fires when less than 50% of the creative is visible.\n *\n * @event LinearEvents#notViewable\n */\nexport const notViewable = 'notViewable';\n/**\n * Fires when there is no way to determine visibility of the creative.\n *\n * @event LinearEvents#viewUndetermined\n */\nexport const viewUndetermined = 'viewUndetermined';\n/**\n * Fires when the creative played continuously for at least 50% of the total duration at normal speed.\n *\n * @event LinearEvents#midpoint\n */\nexport const midpoint = 'midpoint';\n/**\n * Fires when the user activated the mute control and muted the creative.\n *\n * @event LinearEvents#mute\n */\nexport const mute = 'mute';\n/**\n * Optional metric that can capture all other user interactions under one metric such a s hover-overs, or custom clicks. It should NOT replace clickthrough events or other existing events like mute, unmute, pause, etc.\n *\n * @event LinearEvents#otherAdInteraction\n */\nexport const otherAdInteraction = 'otherAdInteraction';\n/**\n * Fires when the user clicked the pause control and stopped the creative.\n *\n * @event LinearEvents#pause\n */\nexport const pause = 'pause';\n/**\n * Fires when the user activated a control to reduce player to a smaller size. This event replaces the exitFullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerCollapse\n */\nexport const playerCollapse = 'playerCollapse';\n/**\n * Fires when the user activated a control to reduce player to a smaller size.\n *\n * @event LinearEvents#exitFullscreen\n */\nexport const exitFullscreen = 'exitFullscreen';\n/**\n * Fires when the user activated a control to extend the player to a larger size. This event replaces the fullscreen event per the 2014 Digital Video In-Stream Ad Metric Definitions.\n *\n * @event LinearEvents#playerExpand\n */\nexport const playerExpand = 'playerExpand';\n/**\n * Fires when the user activated a control to extend the player to a larger size. Only for VAST 3.\n *\n * @event LinearEvents#fullscreen\n */\nexport const fullscreen = 'fullscreen';\n/**\n * Fires when the creative played for a duration at normal speed that is equal to or greater than the value provided in an additional offset attribute for the <Tracking> element under Linear ads. Values can be time in the format HH:MM:SS or HH:MM:SS.mmm or a percentage value in the format n%.\n *\n * @event LinearEvents#progress\n */\nexport const progress = 'progress';\n/**\n * Fires when the user activated the resume control after the creative had been stopped or paused.\n *\n * @event LinearEvents#resume\n */\nexport const resume = 'resume';\n/**\n * Fires when the user activated the rewind control to access a previous point in the creative timeline.\n *\n * @event LinearEvents#rewind\n */\nexport const rewind = 'rewind';\n/**\n * Fires when the user activated a skip control to skip the creative.\n *\n * @event LinearEvents#skip\n */\nexport const skip = 'skip';\n/**\n * This event is used to indicate that an individual creative within the ad was loaded and playback began. As with creativeView, this event is another way of tracking creative playback.\n *\n * @event LinearEvents#start\n */\nexport const start = 'start';\n/**\n * Fires when the creative played continuously for at least 75% of the duration at normal speed.\n *\n * @event LinearEvents#thirdQuartile\n */\nexport const thirdQuartile = 'thirdQuartile';\n/**\n * Amount of video viewed at normal speed in seconds or other appropriate time-based units. If a rewind event occurs during play, time spent viewing may be calculated on total amount of video viewed at normal speed, which may include additional amounts of video viewed after rewinding. The offset attribute for the <Tracking> element under Linear ads may be used to track when time spent viewing meets the threshold. Otherwise, a macro may be provided so that the player may return a time value. VAST does not provide a standard macro for this value, so the involved parties must establish these parameters if this metric is to be used.\n *\n * @event LinearEvents#timeSpentViewing\n */\nexport const timeSpentViewing = 'timeSpentViewing';\n/**\n * Fires when the user activated the mute control and unmuted the creative.\n *\n * @event LinearEvents#unmute\n */\nexport const unmute = 'unmute';\n/**\n * Fires when the user clicked the creative icon.\n *\n * @event LinearEvents#iconClick\n */\nexport const iconClick = 'iconClick';\n/**\n * Fires when the user viewed the creative icon.\n *\n * @event LinearEvents#iconView\n */\nexport const iconView = 'iconView';\n/**\n * The viewer has chosen to close the linear ad unit. This is currently inuse by some of the largest mobile SDKs to mark the dismissal of the end card companion that follows the video, as well as a close of the video itself, if applicable\n *\n * @event LinearEvents#closeLinear\n */\nexport const closeLinear = 'closeLinear';\n/**\n * Not to be confused with an impression, this event indicates that an individual creative portion of the ad was viewed.\n *\n * @event LinearEvents#creativeView\n */\nexport const creativeView = 'creativeView';\nconst linearEvents = {\n    clickThrough,\n    closeLinear,\n    complete,\n    creativeView,\n    error,\n    exitFullscreen,\n    firstQuartile,\n    fullscreen,\n    iconClick,\n    iconView,\n    impression,\n    midpoint,\n    mute,\n    notViewable,\n    otherAdInteraction,\n    pause,\n    playerCollapse,\n    playerExpand,\n    progress,\n    resume,\n    rewind,\n    skip,\n    start,\n    thirdQuartile,\n    timeSpentViewing,\n    unmute,\n    viewable,\n    viewUndetermined\n};\nexport default linearEvents;\n","/**\n * Interface for classes that may emit non linear VAST events.\n *\n * @interface NonLinearEvents\n */\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the players viewable area or takes-over the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#acceptInvitation\n */\nexport const acceptInvitation = 'acceptInvitation';\n/**\n * Fires when the user clicked or otherwise activated a control used to pause streaming content, which either expands the ad within the players viewable area or takes-over the streaming content area by launching an additional portion of the ad.\n *\n * @event NonLinearEvents#adCollapse\n */\nexport const adCollapse = 'adCollapse';\n/**\n * Fires when the user clicked or otherwise activated a control for removing the ad.\n *\n * @event NonLinearEvents#close\n */\nexport const close = 'close';\nconst nonLinearEvents = {\n    acceptInvitation,\n    adCollapse,\n    close\n};\nexport default nonLinearEvents;\n","/**\n * XML node type\n */\nexport var NodeType;\n(function (NodeType) {\n    NodeType[\"CDATA\"] = \"cdata\";\n    NodeType[\"DOCUMENT\"] = \"document\";\n    NodeType[\"ELEMENT\"] = \"element\";\n    NodeType[\"TEXT\"] = \"text\";\n})(NodeType || (NodeType = {}));\n","import { NodeType } from '../../types';\nconst getNodeType = (node) => {\n    switch (node.nodeType) {\n        case 1:\n            return NodeType.ELEMENT;\n        case 3:\n        case 4:\n            return NodeType.TEXT;\n        case 9:\n            return NodeType.DOCUMENT;\n        default:\n            throw new Error('Unsupported element type');\n    }\n};\nconst getNodeAttributes = (node) => node.attributes.length === 0\n    ? undefined\n    : Object.fromEntries(Array.from(node.attributes).map((attribute) => {\n        var _a;\n        return [\n            attribute.nodeName,\n            (_a = attribute.nodeValue) !== null && _a !== void 0 ? _a : undefined\n        ];\n    }));\nconst getNodeText = (node) => { var _a; return (_a = node.nodeValue) === null || _a === void 0 ? void 0 : _a.replace('<![CDATA[', '').replace(']]>', '').trim(); };\nconst getNodeChildren = (node) => {\n    var _a, _b;\n    if (!node.hasChildNodes()) {\n        return;\n    }\n    const childNodes = Array.from(node.childNodes).filter((childNode) => [1, 3, 4].includes(childNode.nodeType));\n    const elements = [];\n    for (const childNode of childNodes) {\n        const childElement = xmlToJson(childNode);\n        if (!(childNode instanceof Text) || ((_b = (_a = childElement.text) === null || _a === void 0 ? void 0 : _a.length) !== null && _b !== void 0 ? _b : 0) > 0) {\n            elements.push(childElement);\n        }\n    }\n    return elements;\n};\nconst xmlToJson = (node) => {\n    const type = getNodeType(node);\n    const element = {\n        type\n    };\n    if (node instanceof Element) {\n        const attributes = getNodeAttributes(node);\n        if (attributes) {\n            element.attributes = attributes;\n        }\n        element.name = node.nodeName.toLowerCase();\n    }\n    else if (node instanceof Text || node instanceof CDATASection) {\n        element.text = getNodeText(node);\n    }\n    const children = getNodeChildren(node);\n    if (children) {\n        element.elements = children;\n    }\n    return element;\n};\nexport default xmlToJson;\n","const getChildren = (element) => { var _a; return (_a = element.elements) !== null && _a !== void 0 ? _a : []; };\nconst findChildByName = (element, childName) => getChildren(element).find(({ name = '' }) => name.toUpperCase() === childName.toUpperCase());\nconst filterChildrenByName = (element, childrenName) => getChildren(element).filter(({ name = '' }) => name.toUpperCase() === childrenName.toUpperCase());\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @param element Parsed xml element object.\n * @param childName Child element name\n * @returns The first child element with the passed name or undefined if not found.\n */\nexport const get = findChildByName;\n/**\n * Get all the children elements of the passed parsed xml element filtered by the passed child name if passed.\n *\n * @param element Parsed xml element object.\n * @param childName Child element name.\n * @returns Array of child elements or an empty array.\n */\nexport const getAll = (element, childName) => {\n    if (typeof childName === 'string') {\n        return filterChildrenByName(element, childName);\n    }\n    return getChildren(element);\n};\n/**\n * Get the first child element from the passed parsed xml element.\n *\n * @returns The first child element or undefined if there are non.\n */\nexport const getFirstChild = (element) => getChildren(element)[0];\n/**\n * Get the text value of the passed parsed xml element.\n *\n * @returns Text of the element\n */\nexport const getText = (element) => {\n    const firstChild = element && getFirstChild(element);\n    return firstChild && firstChild.text;\n};\n/**\n * Get all the attributes of the passed parsed xml element.\n *\n * @returns Object with the element attributes.\n */\nexport const getAttributes = (element) => { var _a; return (_a = element.attributes) !== null && _a !== void 0 ? _a : {}; };\n/**\n * Get the attribute with the passed name of the passed parsed xml element.\n *\n * @returns Attribute value or undefined.\n */\nexport const getAttribute = (element, attributeName) => getAttributes(element)[attributeName];\n","import xml2js from './helpers/xml2js';\nimport { get, getAll, getFirstChild, getText, getAttributes, getAttribute } from './helpers/xmlSelectors';\nconst parser = new DOMParser();\n/**\n * Parses the passed xml text.\n *\n * @throws if there is an error parsing the xml.\n * @param xmlText XML text to be parsed.\n * @returns Returns the parsed xml document as a js object.\n */\nexport const parseXml = (xmlText) => xml2js(parser, xmlText);\nexport { get, getAll, getFirstChild, getText, getAttributes, getAttribute };\n","const parseHoursToMs = (hourStr) => parseInt(hourStr, 10) * 60 * 60 * 1000;\nconst parseMinToMs = (minStr) => parseInt(minStr, 10) * 60 * 1000;\nconst parseSecToMs = (secStr) => parseInt(secStr, 10) * 1000;\nconst parseTime = (durationStr) => {\n    if (typeof durationStr === 'string') {\n        const durationRegex = /(\\d\\d):(\\d\\d):(\\d\\d)(\\.(\\d\\d\\d))?/;\n        const match = durationStr.match(durationRegex);\n        if (match) {\n            const durationInMs = parseHoursToMs(match[1]) +\n                parseMinToMs(match[2]) +\n                parseSecToMs(match[3]) +\n                (match[5] ? parseInt(match[5], 10) : 0);\n            if (!isNaN(durationInMs)) {\n                return durationInMs;\n            }\n        }\n    }\n};\nexport default parseTime;\n","import parseTime from './parseTime';\nconst isPercentage = (offset) => {\n    const percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n    return percentageRegex.test(offset);\n};\nconst parseOffset = (offset) => {\n    if (isPercentage(offset)) {\n        return offset;\n    }\n    return parseTime(offset);\n};\nexport default parseOffset;\n","import { get, getAll, getFirstChild } from '../../xml';\nconst hasLinear = (creative) => get(creative, 'linear');\nconst getLinearCreative = (ad) => {\n    const adTypeElement = getFirstChild(ad);\n    const creativesElement = adTypeElement && get(adTypeElement, 'creatives');\n    return creativesElement && getAll(creativesElement).find(hasLinear);\n};\nexport default getLinearCreative;\n","import { get, getAll, getText, getAttributes } from '../xml';\nimport parseOffset from './helpers/parseOffset';\nimport getLinearCreative from './helpers/getLinearCreative';\nconst getTrackingEvent = (trackingEventElement) => {\n    const { event, offset } = getAttributes(trackingEventElement);\n    const uri = getText(trackingEventElement);\n    return {\n        event,\n        offset: offset && parseOffset(offset),\n        uri\n    };\n};\n/**\n * Gets the Linear tracking events from the Vast Ad\n *\n * @param ad VAST ad object.\n * @param eventName If provided it will filter-out the array events against it.\n * @returns Array of Tracking event definitions\n */\nconst getLinearTrackingEvents = (ad, eventName) => {\n    const creativeElement = ad && getLinearCreative(ad);\n    const linearElement = creativeElement && get(creativeElement, 'Linear');\n    const trackingEventsElement = linearElement && get(linearElement, 'TrackingEvents');\n    const trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n    if (trackingEventElements && trackingEventElements.length > 0) {\n        const trackingEvents = trackingEventElements.map(getTrackingEvent);\n        if (!eventName) {\n            return trackingEvents;\n        }\n        const filteredEvents = trackingEvents.filter(({ event }) => event === eventName);\n        if (filteredEvents.length > 0) {\n            return filteredEvents;\n        }\n    }\n};\nexport default getLinearTrackingEvents;\n","import { get, getAll, getText, getAttributes } from '../xml';\nimport getLinearCreative from './helpers/getLinearCreative';\nimport parseTime from './helpers/parseTime';\nconst formatSize = (size) => {\n    const match = `${size}`.match(/\\d+/g);\n    return parseInt((match === null || match === void 0 ? void 0 : match[0]) || '', 10);\n};\nconst formatPosition = (position) => {\n    const isNumberString = /\\d+/.test(position);\n    if (isNumberString) {\n        return formatSize(position);\n    }\n    return position;\n};\nconst getIconAttributes = (iconElement) => {\n    const { duration, height, offset, program, pxratio, width, xPosition = 'right', yPosition = 'top' } = getAttributes(iconElement);\n    return {\n        duration: (duration && parseTime(duration)) || undefined,\n        height: (height && formatSize(height)) || undefined,\n        offset: (offset && parseTime(offset)) || undefined,\n        program,\n        pxratio: (pxratio && parseInt(pxratio, 10)) || undefined,\n        width: (width && formatSize(width)) || undefined,\n        xPosition: xPosition && formatPosition(xPosition),\n        yPosition: yPosition && formatPosition(yPosition)\n    };\n};\nconst getIconResource = (iconElement) => {\n    const staticResourceElement = get(iconElement, 'StaticResource');\n    const htmlResourceElement = get(iconElement, 'HTMLResource');\n    const iFrameResourceElement = get(iconElement, 'IFrameResource');\n    if (staticResourceElement) {\n        return { staticResource: getText(staticResourceElement) };\n    }\n    if (htmlResourceElement) {\n        return { htmlResource: getText(htmlResourceElement) };\n    }\n    if (iFrameResourceElement) {\n        return { iFrameResource: getText(iFrameResourceElement) };\n    }\n    return {\n        staticResource: getText(iconElement)\n    };\n};\nconst getIconViewTracking = (iconElement) => {\n    const iconTrackingElements = getAll(iconElement, 'IconViewTracking')\n        .map((iconViewTrackingElement) => getText(iconViewTrackingElement))\n        .filter(Boolean);\n    if (iconTrackingElements.length === 0) {\n        return {};\n    }\n    return {\n        iconViewTracking: iconTrackingElements\n    };\n};\nconst getIconClicks = (iconElement) => {\n    const iconClicksElement = get(iconElement, 'IconClicks');\n    const iconClickThroughElement = iconClicksElement && get(iconClicksElement, 'IconClickThrough');\n    const iconClickTrackingElements = iconClicksElement &&\n        getAll(iconClicksElement, 'IconClickTracking')\n            .map((iconClickTrackingElement) => getText(iconClickTrackingElement))\n            .filter(Boolean);\n    return {\n        iconClickThrough: iconClickThroughElement && getText(iconClickThroughElement),\n        iconClickTracking: iconClickTrackingElements && iconClickTrackingElements.length > 0\n            ? iconClickTrackingElements\n            : undefined\n    };\n};\n/**\n * Gets the Vast Icon definitions from the Vast Ad.\n *\n * @param ad VAST ad object.\n * @returns Array of VAST icon definitions\n */\nconst getIcons = (ad) => {\n    const linearCreativeElement = ad && getLinearCreative(ad);\n    const linearElement = linearCreativeElement && get(linearCreativeElement, 'linear');\n    const iconsElement = linearElement && get(linearElement, 'Icons');\n    const iconElements = iconsElement && getAll(iconsElement, 'Icon');\n    if (iconElements && iconElements.length > 0) {\n        return iconElements.map((iconElement) => (Object.assign(Object.assign(Object.assign(Object.assign({}, getIconAttributes(iconElement)), getIconResource(iconElement)), getIconViewTracking(iconElement)), getIconClicks(iconElement))));\n    }\n};\nexport default getIcons;\n","import { get, getAll, getFirstChild, getText, getAttributes, getAttribute } from '../xml';\nimport parseOffset from './helpers/parseOffset';\nimport getLinearCreative from './helpers/getLinearCreative';\nimport getLinearTrackingEvents from './getLinearTrackingEvents';\nimport getNonLinearTrackingEvents from './getNonLinearTrackingEvents';\nimport getIcons from './getIcons';\nconst getBooleanValue = (val) => {\n    if (typeof val === 'string') {\n        return val === 'true';\n    }\n    return Boolean(val);\n};\nconst compareBySequence = (itemA, itemB) => {\n    const itemASequenceString = getAttribute(itemA, 'sequence');\n    const itemBSequenceString = getAttribute(itemB, 'sequence');\n    const itemASequence = itemASequenceString && parseInt(itemASequenceString, 10);\n    const itemBSequence = itemBSequenceString && parseInt(itemBSequenceString, 10);\n    if (typeof itemASequence !== 'string' || typeof itemBSequence !== 'string') {\n        return 0;\n    }\n    if (itemASequence < itemBSequence) {\n        return -1;\n    }\n    if (itemASequence > itemBSequence) {\n        return 1;\n    }\n    return 0;\n};\n/**\n * Selects the ads of the passed VAST.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns Array of ads or empty array.\n */\nexport const getAds = (parsedVast) => {\n    const vastElement = parsedVast && get(parsedVast, 'VAST');\n    const ads = vastElement && getAll(vastElement, 'Ad');\n    if (ads && ads.length > 0) {\n        return ads;\n    }\n    return [];\n};\n/**\n * Gets the Error URI of the passed parsed VAST xml.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns array of the Vast Error URI\n */\nexport const getVastErrorURI = (parsedVast) => {\n    const vastElement = parsedVast && get(parsedVast, 'VAST');\n    const errors = vastElement && getAll(vastElement, 'Error');\n    if (errors && errors.length > 0) {\n        return errors.map((error) => { var _a; return (_a = getText(error)) !== null && _a !== void 0 ? _a : ''; }).filter(Boolean);\n    }\n};\n/**\n * Gets the sequence of the pod ad.\n *\n * @param ad Parsed ad definition object.\n * @returns The pod ad sequence number.\n */\nexport const getPodAdSequence = (ad) => {\n    const sequenceString = getAttribute(ad, 'sequence');\n    const sequence = sequenceString && parseInt(sequenceString, 10);\n    if (typeof sequence === 'number' && !isNaN(sequence)) {\n        return sequence;\n    }\n};\n/**\n * Checks if the passed ad definition is a pod ad.\n *\n * @param ad Parsed ad definition object.\n * @returns Returns true if there the ad is a pod ad and false otherwise.\n */\nexport const isPodAd = (ad) => Boolean(getPodAdSequence(ad));\n/**\n * Checks if the passed array of ads have an ad pod.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns Returns true if there is an ad pod in the array and false otherwise.\n */\nexport const hasAdPod = (parsedVast) => {\n    const ads = getAds(parsedVast);\n    return Array.isArray(ads) && ads.filter(isPodAd).length > 1;\n};\n/**\n * Returns true if the passed vastChain has an ad pod or false otherwise.\n *\n * @param vastChain Array of VAST responses. See `load` or `requestAd` for more info.\n * @returns True if the vastChain contains an ad pod and false otherwise.\n */\nexport const isAdPod = (vastChain = []) => vastChain.map(({ parsedXML }) => parsedXML).some(hasAdPod);\n/**\n * Selects the first ad of the passed VAST. If the passed VAST response contains an ad pod it will return the first ad in the ad pod sequence.\n *\n * @param parsedVast Parsed VAST xml.\n * @returns First ad of the VAST xml.\n */\nexport const getFirstAd = (parsedVast) => {\n    const ads = getAds(parsedVast);\n    if (Array.isArray(ads) && ads.length > 0) {\n        if (hasAdPod(parsedVast)) {\n            return ads.filter(isPodAd).sort(compareBySequence)[0];\n        }\n        return ads[0];\n    }\n};\n/**\n * Checks if the passed ad is a Wrapper.\n *\n * @param ad VAST ad object.\n * @returns `true` if the ad contains a wrapper and `false` otherwise.\n */\nexport const isWrapper = (ad) => Boolean(get(ad || {}, 'Wrapper'));\n/**\n * Checks if the passed ad is an Inline.\n *\n * @param ad VAST ad object.\n * @returns Returns `true` if the ad contains an Inline or `false` otherwise.\n */\nexport const isInline = (ad) => Boolean(get(ad || {}, 'Inline'));\n/**\n * Returns the VASTAdTagURI from the wrapper ad.\n *\n * @param ad VAST ad object.\n * @returns Returns the VASTAdTagURI from the wrapper ad.\n */\nexport const getVASTAdTagURI = (ad) => {\n    const wrapperElement = get(ad, 'Wrapper');\n    const vastAdTagURIElement = wrapperElement && get(wrapperElement, 'VastAdTagUri');\n    return vastAdTagURIElement && getText(vastAdTagURIElement);\n};\n/**\n * Returns the options from the wrapper ad.\n *\n * @param ad VAST ad object.\n * @returns Returns the options from the wrapper ad.\n */\nexport const getWrapperOptions = (ad) => {\n    const wrapperElement = get(ad, 'Wrapper');\n    const options = {};\n    if (wrapperElement) {\n        const { allowMultipleAds, fallbackOnNoAd, followAdditionalWrappers } = getAttributes(wrapperElement);\n        if (allowMultipleAds) {\n            options.allowMultipleAds = getBooleanValue(allowMultipleAds);\n        }\n        if (fallbackOnNoAd) {\n            options.fallbackOnNoAd = getBooleanValue(fallbackOnNoAd);\n        }\n        if (followAdditionalWrappers) {\n            options.followAdditionalWrappers = getBooleanValue(followAdditionalWrappers);\n        }\n    }\n    return options;\n};\n/**\n * Gets the Error URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad Error URI.\n */\nexport const getAdErrorURI = (ad) => {\n    const adTypeElement = ad && getFirstChild(ad);\n    const errors = adTypeElement && getAll(adTypeElement, 'Error');\n    if (errors && errors.length > 0) {\n        return errors.map((error) => { var _a; return (_a = getText(error)) !== null && _a !== void 0 ? _a : ''; }).filter(Boolean);\n    }\n};\n/**\n * Gets array of the Impression URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad Impression URI.\n */\nexport const getImpression = (ad) => {\n    const adTypeElement = ad && getFirstChild(ad);\n    const impressions = adTypeElement && getAll(adTypeElement, 'Impression');\n    if (impressions && impressions.length > 0) {\n        return impressions\n            .map((impression) => { var _a; return (_a = getText(impression)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets array of the Viewable URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad Viewable URI.\n */\nexport const getViewable = (ad) => {\n    const adTypeElement = ad && getFirstChild(ad);\n    const viewableImpression = adTypeElement && get(adTypeElement, 'ViewableImpression');\n    const viewableElements = viewableImpression && getAll(viewableImpression, 'Viewable');\n    if (viewableElements && viewableElements.length > 0) {\n        return viewableElements\n            .map((element) => { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets array of the NotViewable URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad NotViewable URI.\n */\nexport const getNotViewable = (ad) => {\n    const adTypeElement = ad && getFirstChild(ad);\n    const viewableImpression = adTypeElement && get(adTypeElement, 'ViewableImpression');\n    const notViewableElements = viewableImpression && getAll(viewableImpression, 'NotViewable');\n    if (notViewableElements && notViewableElements.length > 0) {\n        return notViewableElements\n            .map((element) => { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets array of the ViewUndetermined URI of the passed ad.\n *\n * @param ad VAST ad object.\n * @returns array of the Vast ad ViewUndetermined URI.\n */\nexport const getViewUndetermined = (ad) => {\n    const adTypeElement = ad && getFirstChild(ad);\n    const viewableImpression = adTypeElement && get(adTypeElement, 'ViewableImpression');\n    const viewUndeterminedElements = viewableImpression && getAll(viewableImpression, 'ViewUndetermined');\n    if (viewUndeterminedElements && viewUndeterminedElements.length > 0) {\n        return viewUndeterminedElements\n            .map((element) => { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets the ad's MediaFiles.\n *\n * @param ad VAST ad object.\n * @returns array of media files\n */\nexport const getMediaFiles = (ad) => {\n    const creativeElement = ad && getLinearCreative(ad);\n    const universalAdIdElement = creativeElement && get(creativeElement, 'UniversalAdId');\n    const universalAdId = universalAdIdElement && getText(universalAdIdElement);\n    const linearElement = creativeElement && get(creativeElement, 'Linear');\n    const mediaFilesElement = linearElement && get(linearElement, 'MediaFiles');\n    const mediaFileElements = mediaFilesElement && getAll(mediaFilesElement, 'MediaFile');\n    if (mediaFileElements && mediaFileElements.length > 0) {\n        return mediaFileElements.map((mediaFileElement) => {\n            const src = getText(mediaFileElement);\n            const { apiFramework, bitrate, codec, delivery, height, id, maintainAspectRatio, maxBitrate, minBitrate, scalable, type, width } = getAttributes(mediaFileElement);\n            return {\n                apiFramework,\n                bitrate,\n                codec,\n                delivery,\n                height,\n                id,\n                maintainAspectRatio,\n                maxBitrate,\n                minBitrate,\n                scalable,\n                src,\n                type,\n                universalAdId,\n                width\n            };\n        });\n    }\n};\n/**\n * Gets the ad's InteractiveFiles. That were added with the `InteractiveCreativeFile` tag.\n *\n * @param ad VAST ad object.\n * @returns array of media files.\n */\nexport const getInteractiveCreativeFiles = (ad) => {\n    const creativeElement = ad && getLinearCreative(ad);\n    const linearElement = creativeElement && get(creativeElement, 'Linear');\n    const mediaFilesElement = linearElement && get(linearElement, 'MediaFiles');\n    const interactiveElements = mediaFilesElement && getAll(mediaFilesElement, 'InteractiveCreativeFile');\n    if (interactiveElements && interactiveElements.length > 0) {\n        return interactiveElements.map((interactiveElement) => {\n            const { apiFramework, type } = getAttributes(interactiveElement);\n            const src = getText(interactiveElement);\n            return {\n                apiFramework,\n                src,\n                type\n            };\n        });\n    }\n};\n/**\n * Gets all the ad's InteractiveFiles.\n *\n * @param ad VAST ad object.\n * @returns array of media files\n */\nexport const getInteractiveFiles = (ad) => {\n    let interactiveFiles = getInteractiveCreativeFiles(ad);\n    if (interactiveFiles) {\n        return interactiveFiles;\n    }\n    const mediaFiles = getMediaFiles(ad);\n    if (mediaFiles) {\n        interactiveFiles = mediaFiles\n            .filter(({ apiFramework = '' }) => (apiFramework === null || apiFramework === void 0 ? void 0 : apiFramework.toLowerCase()) === 'vpaid')\n            .map(({ apiFramework, src, type }) => ({\n            apiFramework,\n            src,\n            type\n        }));\n        if (interactiveFiles.length > 0) {\n            return interactiveFiles;\n        }\n    }\n};\nconst getVideoClicksElement = (ad) => {\n    const creativeElement = ad && getLinearCreative(ad);\n    const linearElement = creativeElement && get(creativeElement, 'Linear');\n    return linearElement && get(linearElement, 'VideoClicks');\n};\n/**\n * Gets the click through {@link VastMacro}.\n *\n * @param ad VAST ad object.\n * @returns clickthrough macro\n */\nexport const getClickThrough = (ad) => {\n    const videoClicksElement = getVideoClicksElement(ad);\n    const clickThroughElement = videoClicksElement && get(videoClicksElement, 'ClickThrough');\n    return clickThroughElement && getText(clickThroughElement);\n};\n/**\n * Gets the click through {@link VastMacro}.\n *\n * @param ad VAST ad object.\n * @returns click tracking macro\n */\nexport const getClickTracking = (ad) => {\n    const videoClicksElement = ad && getVideoClicksElement(ad);\n    const clickTrackingElements = videoClicksElement && getAll(videoClicksElement, 'ClickTracking');\n    if (clickTrackingElements && clickTrackingElements.length > 0) {\n        return clickTrackingElements\n            .map((element) => { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets the custom click {@link VastMacro}.\n *\n * @param ad VAST ad object.\n * @returns click tracking macro\n */\nexport const getCustomClick = (ad) => {\n    const videoClicksElement = getVideoClicksElement(ad);\n    const customClickElements = videoClicksElement && getAll(videoClicksElement, 'CustomClick');\n    if (customClickElements && customClickElements.length > 0) {\n        return customClickElements\n            .map((element) => { var _a; return (_a = getText(element)) !== null && _a !== void 0 ? _a : ''; })\n            .filter(Boolean);\n    }\n};\n/**\n * Gets the skipoffset.\n *\n * @param ad VAST ad object.\n * @returns the time offset in milliseconds or a string with the percentage\n */\nexport const getSkipOffset = (ad) => {\n    const creativeElement = ad && getLinearCreative(ad);\n    const linearElement = creativeElement && get(creativeElement, 'Linear');\n    const skipoffset = linearElement && getAttribute(linearElement, 'skipoffset');\n    return skipoffset && parseOffset(skipoffset);\n};\nconst getLinearContent = (xml) => {\n    const linearRegex = /<Linear([\\s\\S]*)<\\/Linear/gm;\n    const result = linearRegex.exec(xml);\n    return result === null || result === void 0 ? void 0 : result[1];\n};\nconst getAdParametersContent = (xml) => {\n    const paramsRegex = /<AdParameters[\\s\\w=\"]*>([\\s\\S]*)<\\/AdParameters>/gm;\n    const result = paramsRegex.exec(xml);\n    return (result === null || result === void 0 ? void 0 : result[1].replace(/[\\n\\s]*<!\\[CDATA\\[[\\n\\s]*/, '').replace(/[\\n\\s]*\\]\\]>[\\n\\s]*$/, '').replace(/\\]\\]\\]\\]><!\\[CDATA\\[>/, ']]>').trim());\n};\nconst getXmlEncodedValue = (xml) => {\n    const xmlEncodedRegex = /<AdParameters[\\s]*xmlEncoded=\"(.*?)\">/gim;\n    const result = xmlEncodedRegex.exec(xml);\n    return (result === null || result === void 0 ? void 0 : result[1]) === 'true';\n};\n/**\n * Gets the creative data.\n *\n * @param xml VAST XML text.\n * @returns with `AdParameters` as they come in the XML and a flag `xmlEncoded` to indicate if the ad parameters are xml encoded.\n */\nexport const getCreativeData = (xml) => {\n    const linearContent = getLinearContent(xml);\n    const AdParameters = linearContent && getAdParametersContent(linearContent);\n    const xmlEncoded = linearContent ? getXmlEncodedValue(linearContent) : false;\n    return {\n        AdParameters,\n        xmlEncoded\n    };\n};\nexport { getIcons, getLinearTrackingEvents, getNonLinearTrackingEvents };\n","const toUpperKeys = (map) => {\n    const upperKeysMap = {};\n    Object.keys(map).forEach((key) => {\n        upperKeysMap[key.toUpperCase()] = map[key];\n    });\n    return upperKeysMap;\n};\n/**\n * Parses the passed macro with the passed data and returns the resulting parsed Macro.\n * If no CACHEBUSTING property is passed in the data it will generate a random one on its own.\n * If no TIMESTAMP property is passed in the data it will generate a one on its own.\n *\n * @param macro The string macro to be parsed.\n * @param data The data used by the macro.\n * @returns The parsed macro.\n */\nconst parseMacro = (macro, data = {}) => {\n    let parsedMacro = macro;\n    const macroData = toUpperKeys(data);\n    if (!macroData.CACHEBUSTING) {\n        macroData.CACHEBUSTING = Math.round(Math.random() * 1.0e10);\n    }\n    if (!macroData.TIMESTAMP) {\n        macroData.TIMESTAMP = new Date().toISOString();\n    }\n    Object.keys(macroData).forEach((key) => {\n        const value = encodeURIComponent(macroData[key]);\n        parsedMacro = parsedMacro.replace(\n        // eslint-disable-next-line security/detect-non-literal-regexp\n        new RegExp('\\\\[' + key + '\\\\]', 'gm'), value);\n    });\n    return parsedMacro;\n};\nexport default parseMacro;\n","import parseMacro from './parseMacro';\n/**\n * Creates a tracking image with the passed URL macro.\n *\n * @param urlMacro URL Macro that need to be tracked.\n * @param data Data Object with the macros's variables.\n * @returns Image element whose source is the parsed URL Macro.\n */\nconst pixelTracker = (urlMacro, data) => {\n    const img = new Image();\n    img.src = parseMacro(urlMacro, data);\n    return img;\n};\nexport default pixelTracker;\n","import { getAdErrorURI, getVastErrorURI } from '../../vastSelectors';\nimport pixelTracker from './pixelTracker';\n/**\n * Tracks an error.\n *\n * @param vastChain the ad VAST Chain.\n * @param options Options Map\n */\nconst trackError = (vastChain, { errorCode, tracker = pixelTracker }) => {\n    vastChain.forEach(({ ad, parsedXML }) => {\n        const errorURIs = (ad && getAdErrorURI(ad)) || getVastErrorURI(parsedXML);\n        if (errorURIs) {\n            errorURIs.map((uri) => uri && tracker(uri, { errorCode }));\n        }\n    });\n};\nexport default trackError;\n","import pixelTracker from './pixelTracker';\nconst createVastEventTracker = (trackingEventSelector) => (vastChain, { data = {}, tracker = pixelTracker }) => {\n    vastChain.forEach(({ ad }) => {\n        const value = ad && trackingEventSelector(ad);\n        if (!value) {\n            return;\n        }\n        if (value && typeof value === 'string') {\n            tracker(value, data);\n            return;\n        }\n        if (Array.isArray(value)) {\n            value.map(({ uri }) => uri && tracker(uri, data));\n        }\n    });\n};\nexport default createVastEventTracker;\n","import { getClickTracking, getCustomClick, getImpression, getViewable, getNotViewable, getViewUndetermined, getLinearTrackingEvents } from '../vastSelectors';\nimport pixelTracker from './helpers/pixelTracker';\nimport trackError from './helpers/trackError';\nimport trackIconView from './helpers/trackIconView';\nimport trackIconClick from './helpers/trackIconClick';\nimport trackProgress from './helpers/trackProgress';\nimport createVastEventTracker from './helpers/createVastEventTracker';\nimport { clickThrough, closeLinear, complete, error, exitFullscreen, firstQuartile, fullscreen, iconClick, iconView, impression, viewable, notViewable, viewUndetermined, midpoint, mute, pause, playerCollapse, playerExpand, progress, resume, rewind, skip, start, thirdQuartile, unmute, creativeView } from './linearEvents';\nconst eventSelector = (...selectors) => (ad) => {\n    const trackingURIs = [];\n    if (selectors.length > 0) {\n        selectors.forEach((getElements) => {\n            const elements = getElements(ad);\n            /* istanbul ignore else */\n            if (Array.isArray(elements) && elements.length > 0) {\n                trackingURIs.push(...elements.map((uri) => ({ uri })));\n            }\n        });\n    }\n    return trackingURIs;\n};\nconst linearTrackingEventSelector = (event) => (ad) => getLinearTrackingEvents(ad, event);\nconst linearTrackers = {\n    [clickThrough]: createVastEventTracker(eventSelector(getClickTracking, getCustomClick)),\n    [closeLinear]: createVastEventTracker(linearTrackingEventSelector(closeLinear)),\n    [complete]: createVastEventTracker(linearTrackingEventSelector(complete)),\n    [creativeView]: createVastEventTracker(linearTrackingEventSelector(creativeView)),\n    [error]: trackError,\n    [exitFullscreen]: createVastEventTracker(linearTrackingEventSelector(exitFullscreen)),\n    [firstQuartile]: createVastEventTracker(linearTrackingEventSelector(firstQuartile)),\n    [fullscreen]: createVastEventTracker(linearTrackingEventSelector(fullscreen)),\n    [iconClick]: trackIconClick,\n    [iconView]: trackIconView,\n    [impression]: createVastEventTracker(eventSelector(getImpression)),\n    [midpoint]: createVastEventTracker(linearTrackingEventSelector(midpoint)),\n    [mute]: createVastEventTracker(linearTrackingEventSelector(mute)),\n    [notViewable]: createVastEventTracker(eventSelector(getNotViewable)),\n    [pause]: createVastEventTracker(linearTrackingEventSelector(pause)),\n    [playerCollapse]: createVastEventTracker(linearTrackingEventSelector(playerCollapse)),\n    [playerExpand]: createVastEventTracker(linearTrackingEventSelector(playerExpand)),\n    [progress]: trackProgress,\n    [resume]: createVastEventTracker(linearTrackingEventSelector(resume)),\n    [rewind]: createVastEventTracker(linearTrackingEventSelector(rewind)),\n    [skip]: createVastEventTracker(linearTrackingEventSelector(skip)),\n    [start]: createVastEventTracker(linearTrackingEventSelector(start)),\n    [thirdQuartile]: createVastEventTracker(linearTrackingEventSelector(thirdQuartile)),\n    [unmute]: createVastEventTracker(linearTrackingEventSelector(unmute)),\n    [viewable]: createVastEventTracker(eventSelector(getViewable)),\n    [viewUndetermined]: createVastEventTracker(eventSelector(getViewUndetermined))\n};\n/**\n * Tracks the passed linear event.\n *\n * @param event name of the linear event we need to track. @see LinearEvents\n * @param vastChain the ad VAST Chain.\n * @param options Options Map. The allowed properties are:\n */\nconst trackLinearEvent = (event, vastChain, { data, errorCode, tracker = pixelTracker, logger = console }) => {\n    const linearTracker = linearTrackers[event];\n    if (linearTracker) {\n        linearTracker(vastChain, {\n            data: Object.assign(Object.assign({}, data), { errorCode }),\n            errorCode,\n            tracker\n        });\n    }\n    else {\n        logger.error(`Event '${event}' cannot be tracked`);\n    }\n};\nexport default trackLinearEvent;\n","import pixelTracker from './pixelTracker';\nconst trackIconClick = (_vastChain, { data = {}, tracker = pixelTracker }) => {\n    const { iconClickTracking } = data;\n    if (Array.isArray(iconClickTracking)) {\n        for (const trackUrl of iconClickTracking) {\n            tracker(trackUrl, Object.assign({}, data));\n        }\n    }\n};\nexport default trackIconClick;\n","import pixelTracker from './pixelTracker';\nconst trackIconView = (_vastChain, { data = {}, tracker = pixelTracker }) => {\n    const { iconViewTracking } = data;\n    if (Array.isArray(iconViewTracking)) {\n        for (const trackUrl of iconViewTracking) {\n            tracker(trackUrl, Object.assign({}, data));\n        }\n    }\n};\nexport default trackIconView;\n","import pixelTracker from './pixelTracker';\nconst trackProgress = (_vastChain, { data = {}, tracker = pixelTracker }) => {\n    const { progressUri } = data;\n    if (progressUri) {\n        tracker(progressUri, Object.assign({}, data));\n    }\n};\nexport default trackProgress;\n","import { getNonLinearTrackingEvents } from '../vastSelectors';\nimport createVastEventTracker from './helpers/createVastEventTracker';\nimport pixelTracker from './helpers/pixelTracker';\nimport { acceptInvitation, adCollapse, close } from './nonLinearEvents';\nconst trackingEventSelector = (event) => (ad) => getNonLinearTrackingEvents(ad, event);\nconst linearTrackers = {\n    [acceptInvitation]: createVastEventTracker(trackingEventSelector(acceptInvitation)),\n    [adCollapse]: createVastEventTracker(trackingEventSelector(adCollapse)),\n    [close]: createVastEventTracker(trackingEventSelector(close))\n};\n/**\n * Tracks the passed non linear event.\n *\n * @param event name of the linear event we need to track. @see LinearEvents\n * @param vastChain the ad VAST Chain.\n * @param options Options Map.\n */\nconst trackNonLinearEvent = (event, vastChain, { data, tracker = pixelTracker, logger = console }) => {\n    const linearTracker = linearTrackers[event];\n    if (linearTracker) {\n        linearTracker(vastChain, {\n            data: Object.assign({}, data),\n            tracker\n        });\n    }\n    else {\n        logger.error(`Event '${event}' cannot be tracked`);\n    }\n};\nexport default trackNonLinearEvent;\n","import { get, getAll, getText, getAttributes } from '../xml';\nimport getLinearCreative from './helpers/getLinearCreative';\n/**\n * Gets the Non Linear tracking events from the Vast Ad\n *\n * @param ad VAST ad object.\n * @param eventName If provided it will filter-out the array events against it.\n * @returns Array of Tracking event definitions\n */\nconst getNonLinearTrackingEvents = (ad, eventName) => {\n    const creativeElement = ad && getLinearCreative(ad);\n    const nonLinearAdsElement = creativeElement && get(creativeElement, 'NonLinearAds');\n    const trackingEventsElement = nonLinearAdsElement && get(nonLinearAdsElement, 'TrackingEvents');\n    const trackingEventElements = trackingEventsElement && getAll(trackingEventsElement, 'Tracking');\n    if (trackingEventElements && trackingEventElements.length > 0) {\n        const trackingEvents = trackingEventElements.map((trackingEventElement) => {\n            const { event } = getAttributes(trackingEventElement);\n            const uri = getText(trackingEventElement);\n            return {\n                event,\n                uri\n            };\n        });\n        if (!eventName) {\n            return trackingEvents;\n        }\n        const filteredEvents = trackingEvents.filter(({ event }) => event === eventName);\n        if (filteredEvents.length > 0) {\n            return filteredEvents;\n        }\n    }\n};\nexport default getNonLinearTrackingEvents;\n","const getContentDocument = (iframeElement) => iframeElement.contentDocument ||\n    /* istanbul ignore next */\n    (iframeElement.contentWindow && iframeElement.contentWindow.document);\nexport default getContentDocument;\n","const supported = 'srcdoc' in document.createElement('iframe');\nconst supportsSrcdoc = () => supported;\nexport default supportsSrcdoc;\n","import getContentDocument from './getContentDocument';\nimport getOrigin from './getOrigin';\nimport supportsSrcdoc from './supportsSrcdoc';\nconst iframeContent = (id, targetOrigin) => `<!DOCTYPE html>\n<html>\n  <head><meta charset='UTF-8'></head>\n  <body style='margin:0;padding:0'>\n  <script type='text/javascript'>window.parent.postMessage('${id}_ready', '${targetOrigin}');</script>\n  </body>\n</html>`;\nconst createBaseIframe = () => {\n    const iframe = document.createElement('iframe');\n    iframe.setAttribute('sandbox', 'allow-forms allow-popups allow-scripts allow-same-origin');\n    iframe.setAttribute('loading', 'eager');\n    iframe.style.margin = '0';\n    iframe.style.padding = '0';\n    iframe.style.border = 'none';\n    iframe.style.width = '0';\n    iframe.style.height = '0';\n    iframe.style.position = 'absolute';\n    return iframe;\n};\nconst createIframe = (placeholder, id) => new Promise((resolve, reject) => {\n    const content = iframeContent(id, getOrigin());\n    let iframe = createBaseIframe();\n    // NOTE: favor about:blank instead of srcdoc because some browsers\n    try {\n        iframe.src = 'about:blank';\n        placeholder.appendChild(iframe);\n        const contentDocument = getContentDocument(iframe);\n        if (!contentDocument) {\n            throw new TypeError('iframe content document is not a Document');\n        }\n        contentDocument.write(content);\n    }\n    catch (error) {\n        placeholder.removeChild(iframe);\n        if (supportsSrcdoc()) {\n            iframe = createBaseIframe();\n            iframe.src = 'about:srcdoc';\n            iframe.srcdoc = content;\n            placeholder.appendChild(iframe);\n        }\n        else {\n            reject(error);\n        }\n    }\n    const handleMessage = ({ data }) => {\n        /* istanbul ignore else */\n        if (data === `${id}_ready`) {\n            window.removeEventListener('message', handleMessage);\n            resolve(iframe);\n        }\n    };\n    window.addEventListener('message', handleMessage, false);\n});\nexport default createIframe;\n","var _a;\nimport loadScript from './helpers/loadScript';\nimport createAdVideoElement from './helpers/createAdVideoElement';\nimport createAdContainer from './helpers/createAdContainer';\nimport createIframe from './helpers/createIframe';\nimport createSlot from './helpers/createSlot';\nimport getContentDocument from './helpers/getContentDocument';\nimport unique from './helpers/unique';\nconst nextId = unique('videoAdContainer');\nconst hidden = Symbol('hidden');\n/**\n * This class provides everything necessary to contain and create a video ad within a given placeholder Element.\n */\nclass VideoAdContainer {\n    /**\n     * Creates a VideoAdContainer.\n     *\n     * @param placeholder DIV that will contain the ad.\n     * @param videoElement optional videoElement that will be used to play the ad.\n     */\n    constructor(placeholder, videoElement) {\n        this[_a] = {\n            destroyed: false,\n            id: nextId(),\n            iframe: undefined,\n            readyPromise: undefined\n        };\n        if (!(placeholder instanceof Element)) {\n            throw new TypeError('placeholder is not an Element');\n        }\n        this.element = createAdContainer();\n        this.isOriginalVideoElement = Boolean(videoElement);\n        if (videoElement) {\n            this.videoElement = videoElement;\n        }\n        else {\n            this.videoElement = createAdVideoElement();\n            this.element.appendChild(this.videoElement);\n        }\n        placeholder.appendChild(this.element);\n    }\n    /**\n     * Adds the passed script to the ad container.\n     *\n     * @param src script source uri.\n     * @param options Options map.\n     */\n    async addScript(src, options = {}) {\n        var _b;\n        if (this.isDestroyed()) {\n            throw new Error('VideoAdContainer has been destroyed');\n        }\n        let { iframe } = this[hidden];\n        if (!iframe) {\n            iframe = await createIframe(this.element, this[hidden].id);\n            this[hidden].iframe = iframe;\n            this.executionContext = iframe.contentWindow;\n        }\n        const placeholder = (_b = getContentDocument(iframe)) === null || _b === void 0 ? void 0 : _b.body;\n        return loadScript(src, Object.assign({ placeholder }, options));\n    }\n    /**\n     * Adds the slot to the ad container.\n     *\n     * @param width - Slot width.\n     * @param height - Slot height.\n     */\n    addSlot(width, height) {\n        if (this.isDestroyed()) {\n            throw new Error('VideoAdContainer has been destroyed');\n        }\n        if (!this.slotElement) {\n            this.slotElement = createSlot(this.element, width, height);\n        }\n    }\n    /**\n     * Destroys the VideoAdContainer.\n     */\n    destroy() {\n        // NOTE: calling destroy immediately terminates the iframe and cancels\n        //       tracking requests from vpaid script, so destroying should\n        //       immediately hides and remove the iframe from dom after timeout\n        const removePromise = new Promise((resolve) => {\n            setTimeout(() => {\n                var _b;\n                (_b = this.element.parentNode) === null || _b === void 0 ? void 0 : _b.removeChild(this.element);\n                resolve();\n            }, 1000);\n        });\n        this.element.style.zIndex = '-9999';\n        this[hidden].destroyed = true;\n        return removePromise;\n    }\n    /**\n     * Checks if the container is destroyed.\n     *\n     * @returns true if the container is destroyed and false otherwise.\n     */\n    isDestroyed() {\n        return this[hidden].destroyed;\n    }\n}\n_a = hidden;\nexport default VideoAdContainer;\n","const getOrigin = () => {\n    const location = window.location;\n    /* istanbul ignore else */\n    if (location.origin) {\n        return location.origin;\n    }\n    else {\n        return (location.protocol +\n            '//' +\n            location.hostname +\n            (location.port ? ':' + location.port : ''));\n    }\n};\nexport default getOrigin;\n","/**\n * unique will create a unique string every time is called, sequentially and namespaced\n *\n * @ignore\n * @param namespace\n */\nconst unique = (namespace) => {\n    let count = -1;\n    return () => namespace + '_' + ++count;\n};\nexport default unique;\n","const createAdContainer = () => {\n    const adContainer = document.createElement('div');\n    adContainer.classList.add('mol-video-ad-container');\n    adContainer.style.width = '100%';\n    adContainer.style.height = '100%';\n    return adContainer;\n};\nexport default createAdContainer;\n","const createAdVideoElement = (contentDocument = document) => {\n    const video = contentDocument.createElement('video');\n    video.style.width = '100%';\n    video.style.height = '100%';\n    return video;\n};\nexport default createAdVideoElement;\n","/**\n * Loads the script source.\n *\n * @ignore\n * @param src The script source.\n * @param options The allowed options\n */\nconst loadScript = (src, { async = false, defer = false, type, placeholder } = {}) => {\n    if (!src) {\n        throw new TypeError('Missing required \"src\" parameter');\n    }\n    return new Promise((resolve, reject) => {\n        const script = document.createElement('script');\n        let scriptPlaceholder = placeholder;\n        script.type = type !== null && type !== void 0 ? type : 'text/javascript';\n        script.async = async;\n        script.defer = defer;\n        script.onerror = () => reject(new URIError(`The script ${src} is not accessible.`));\n        script.onload = () => resolve(script);\n        if (!scriptPlaceholder) {\n            scriptPlaceholder = (document.currentScript\n                ? /* istanbul ignore next */\n                    document.currentScript.parentNode\n                : document.head);\n        }\n        script.src = src;\n        scriptPlaceholder === null || scriptPlaceholder === void 0 ? void 0 : scriptPlaceholder.appendChild(script);\n    });\n};\nexport default loadScript;\n","const createSlot = (placeholder, width, height) => {\n    const slot = document.createElement('DIV');\n    Object.assign(slot.style, {\n        border: '0px',\n        cursor: 'pointer',\n        height: `${height}px`,\n        left: '0px',\n        margin: '0px',\n        padding: '0px',\n        position: 'absolute',\n        top: '0px',\n        width: `${width}px`\n    });\n    placeholder.appendChild(slot);\n    return slot;\n};\nexport default createSlot;\n","const mimeMap = {\n    '3gp': 'video/3gpp',\n    avi: 'video/x-msvideo',\n    flv: 'video/x-flv',\n    m3u8: 'application/x-mpegURL',\n    m4v: 'video/mp4',\n    mov: 'video/quicktime',\n    mp4: 'video/mp4',\n    mpd: 'application/dash+xml',\n    ogv: 'video/ogg',\n    ts: 'video/MP2T',\n    webm: 'video/webm',\n    wmv: 'video/x-ms-wmv'\n};\nconst guessMimeType = (src) => {\n    const match = src.match(/\\.([^./?]+)(\\?[^/]+)?$/i);\n    const ext = match && match[1];\n    return (ext && mimeMap[ext]) || 'video/' + ext;\n};\nexport default guessMimeType;\n","import guessMimeType from './guessMimeType';\nconst canPlay = (videoElement, mediaFile) => {\n    const { src, type } = mediaFile;\n    return videoElement.canPlayType(type || guessMimeType(src || ''));\n};\nexport default canPlay;\n","const getRectParams = (rect) => {\n    const width = Number(rect.width) || 0;\n    const height = Number(rect.height) || 0;\n    // NOTE: leaving 1 digit after the decimal point to handle\n    //       approximately equal ratios, because aspect ratio\n    //       of 480p (854x480) don't strict equal to 360p (640x360)\n    const aspectRatio = height ? Math.floor((width / height) * 10) / 10 : 0;\n    return {\n        aspectRatio,\n        height,\n        width\n    };\n};\nconst sortMediaByBestFit = (mediaFiles, screenRect) => {\n    const screenParams = getRectParams(screenRect);\n    const compareTo = (mediaFileA, mediaFileB) => {\n        const mediaFileAParams = getRectParams(mediaFileA);\n        const mediaFileBParams = getRectParams(mediaFileB);\n        const widthDeltaA = Math.abs(screenParams.width - mediaFileAParams.width);\n        const widthDeltaB = Math.abs(screenParams.width - mediaFileBParams.width);\n        const aspectRatioDeltaA = Math.abs(screenParams.aspectRatio - mediaFileAParams.aspectRatio);\n        const aspectRatioDeltaB = Math.abs(screenParams.aspectRatio - mediaFileBParams.aspectRatio);\n        return aspectRatioDeltaA - aspectRatioDeltaB || widthDeltaA - widthDeltaB;\n    };\n    return mediaFiles.slice(0).sort(compareTo);\n};\nexport default sortMediaByBestFit;\n","import { getMediaFiles } from '../../../vastSelectors';\nimport canPlay from './canPlay';\nimport sortMediaByBestFit from './sortMediaByBestFit';\nconst getMediaByDefaultBestFit = (mediaFiles, screenRect) => {\n    const sortedMediaFiles = sortMediaByBestFit(mediaFiles, screenRect);\n    return sortedMediaFiles[0];\n};\nconst findBestMedia = (inlineAd, videoElement, container, { getMediaFile = getMediaByDefaultBestFit }) => {\n    const screenRect = container.getBoundingClientRect();\n    const mediaFiles = getMediaFiles(inlineAd);\n    const supportedMediaFiles = mediaFiles === null || mediaFiles === void 0 ? void 0 : mediaFiles.filter((mediaFile) => canPlay(videoElement, mediaFile));\n    return supportedMediaFiles && getMediaFile(supportedMediaFiles, screenRect);\n};\nexport default findBestMedia;\n","const once = (element, eventName, listener) => {\n    const handler = (...args) => {\n        element.removeEventListener(eventName, handler);\n        return listener(...args);\n    };\n    element.addEventListener(eventName, handler);\n    return () => {\n        element.removeEventListener(eventName, handler);\n    };\n};\nexport default once;\n","import { getLinearTrackingEvents } from '../../../vastSelectors';\nimport { linearEvents } from '../../../tracker';\nconst { progress } = linearEvents;\nconst getProgressEvents = (vastChain) => vastChain\n    .map(({ ad }) => ad)\n    .reduce((accumulated, ad) => {\n    const events = (ad && getLinearTrackingEvents(ad, progress)) || [];\n    return [...accumulated, ...events];\n}, [])\n    .map(({ offset, uri }) => ({\n    offset,\n    uri\n}));\nexport default getProgressEvents;\n","const safeCallback = (callback, logger) => (...args) => {\n    try {\n        callback(...args);\n    }\n    catch (error) {\n        logger === null || logger === void 0 ? void 0 : logger.error(error);\n    }\n};\nexport default safeCallback;\n","import { linearEvents } from '../../../../tracker';\nconst fullscreenElement = () => document.fullscreenElement ||\n    document.webkitFullscreenElement ||\n    document.mozFullScreenElement ||\n    document.msFullscreenElement ||\n    null;\nconst { fullscreen, exitFullscreen, playerCollapse, playerExpand } = linearEvents;\nconst onFullscreenChange = ({ videoElement }, callback) => {\n    const fullscreenEvtNames = [\n        'webkitfullscreenchange',\n        'mozfullscreenchange',\n        'fullscreenchange',\n        'MSFullscreenChange'\n    ];\n    let fullscreenOn = false;\n    const fullscreenchangeHandler = () => {\n        if (fullscreenElement() === videoElement) {\n            fullscreenOn = true;\n            callback(playerExpand);\n            callback(fullscreen);\n        }\n        else if (fullscreenOn) {\n            fullscreenOn = false;\n            callback(playerCollapse);\n            callback(exitFullscreen);\n        }\n    };\n    for (const event of fullscreenEvtNames) {\n        document.addEventListener(event, fullscreenchangeHandler);\n    }\n    return () => {\n        for (const event of fullscreenEvtNames) {\n            document.removeEventListener(event, fullscreenchangeHandler);\n        }\n    };\n};\nexport default onFullscreenChange;\n","import { linearEvents } from '../../../../tracker';\nconst { pause, resume } = linearEvents;\nconst onPlayPause = ({ videoElement }, callback) => {\n    let started = false;\n    let paused = true;\n    const playHandler = () => {\n        if (!started) {\n            started = true;\n            paused = false;\n        }\n        else if (paused) {\n            paused = false;\n            callback(resume);\n        }\n    };\n    const pauseHandler = () => {\n        if (!paused) {\n            paused = true;\n            callback(pause);\n        }\n    };\n    videoElement.addEventListener('play', playHandler);\n    videoElement.addEventListener('pause', pauseHandler);\n    return () => {\n        videoElement.removeEventListener('play', playHandler);\n        videoElement.removeEventListener('pause', pauseHandler);\n    };\n};\nexport default onPlayPause;\n","import { linearEvents } from '../../../../tracker';\nconst { rewind } = linearEvents;\nconst onRewind = ({ videoElement }, callback) => {\n    let currentTime = videoElement.currentTime;\n    const timeupdateHandler = () => {\n        const delta = videoElement.currentTime - currentTime;\n        if (delta < 0 && Math.abs(delta) >= 1) {\n            callback(rewind);\n        }\n        currentTime = videoElement.currentTime;\n    };\n    videoElement.addEventListener('timeupdate', timeupdateHandler);\n    return () => {\n        videoElement.removeEventListener('timeupdate', timeupdateHandler);\n    };\n};\nexport default onRewind;\n","import { linearEvents } from '../../../../tracker';\nconst { skip } = linearEvents;\nconst createDefaultSkipControl = () => {\n    const skipBtn = document.createElement('button');\n    skipBtn.classList.add('mol-vast-skip-control');\n    skipBtn.type = 'button';\n    skipBtn.innerHTML = 'skip';\n    skipBtn.style.position = 'absolute';\n    skipBtn.style.bottom = '15px';\n    skipBtn.style.right = '15px';\n    return skipBtn;\n};\nconst onSkip = (videoAdContainer, callback, { skipoffset, createSkipControl = createDefaultSkipControl } = {}) => {\n    if (!skipoffset) {\n        return () => null;\n    }\n    let skipControl;\n    const { videoElement, element } = videoAdContainer;\n    const skipHandler = () => {\n        const currentTimeMs = videoElement.currentTime * 1000;\n        if (!skipControl &&\n            typeof skipoffset === 'number' &&\n            currentTimeMs >= skipoffset) {\n            skipControl = createSkipControl();\n            skipControl.onclick = (event) => {\n                var _a;\n                (_a = event.stopPropagation) === null || _a === void 0 ? void 0 : _a.call(event);\n                callback(skip);\n                return false;\n            };\n            element.appendChild(skipControl);\n            videoElement.removeEventListener('timeupdate', skipHandler);\n        }\n    };\n    videoElement.addEventListener('timeupdate', skipHandler);\n    return () => {\n        videoElement.removeEventListener('timeupdate', skipHandler);\n        if (skipControl) {\n            element.removeChild(skipControl);\n        }\n    };\n};\nexport default onSkip;\n","import { linearEvents, ErrorCode } from '../../../../tracker';\nconst { error } = linearEvents;\nconst onError = ({ videoElement }, callback) => {\n    const errorHandler = () => {\n        var _a;\n        const mediaError = (_a = videoElement.error) !== null && _a !== void 0 ? _a : undefined;\n        if (mediaError) {\n            Object.defineProperty(mediaError, 'code', {\n                get: () => ErrorCode.VAST_PROBLEM_DISPLAYING_MEDIA_FILE\n            });\n        }\n        callback(error, mediaError);\n    };\n    videoElement.addEventListener('error', errorHandler);\n    return () => {\n        videoElement.removeEventListener('error', errorHandler);\n    };\n};\nexport default onError;\n","/**\n * Fires when the adUnit's volume has changed.\n *\n * @event VideoAdUnit#volumeChanged\n */\nexport const volumeChanged = 'volumeChanged';\n/**\n * Fires when the adUnit's has finished.\n *\n * @event VideoAdUnit#finish\n */\nexport const finish = 'finish';\n/**\n * fires on ad progress.\n *\n * @event VideoAdUnit#adProgress\n */\nexport const adProgress = 'adProgress';\nconst adUnitEvents = {\n    adProgress,\n    finish,\n    volumeChanged\n};\nexport default adUnitEvents;\n","import { linearEvents } from '../../../../tracker';\nimport { adProgress } from '../../../adUnitEvents';\nconst { complete, firstQuartile, midpoint, start, thirdQuartile } = linearEvents;\nconst percentageProgress = (currentTime, duration) => (currentTime * 100) / duration;\nconst isPassFirstQuartile = (currentTime, duration) => percentageProgress(currentTime, duration) >= 25;\nconst isPassMidPoint = (currentTime, duration) => percentageProgress(currentTime, duration) >= 50;\nconst isPassThirdQuartile = (currentTime, duration) => percentageProgress(currentTime, duration) >= 75;\nconst isCompleted = (currentTime, duration) => percentageProgress(currentTime, duration) >= 99;\n// TODO: implement logic to track `timeSpentViewing` linear event\nconst onTimeUpdate = ({ videoElement }, callback) => {\n    let started = false;\n    let passFirstQuartile = false;\n    let passMidPoint = false;\n    let passThirdQuartile = false;\n    let completed = false;\n    const events = {\n        start: {\n            isFired: (currentTime) => !started && currentTime > 0,\n            callback: () => {\n                started = true;\n                callback(start);\n            }\n        },\n        firstQuartile: {\n            isFired: (currentTime, duration) => !passFirstQuartile && isPassFirstQuartile(currentTime, duration),\n            callback: () => {\n                passFirstQuartile = true;\n                callback(firstQuartile);\n            }\n        },\n        midpoint: {\n            isFired: (currentTime, duration) => !passMidPoint && isPassMidPoint(currentTime, duration),\n            callback: () => {\n                passMidPoint = true;\n                callback(midpoint);\n            }\n        },\n        thirdQuartile: {\n            isFired: (currentTime, duration) => !passThirdQuartile && isPassThirdQuartile(currentTime, duration),\n            callback: () => {\n                passThirdQuartile = true;\n                callback(thirdQuartile);\n            }\n        },\n        complete: {\n            isFired: (currentTime, duration) => !completed && isCompleted(currentTime, duration),\n            callback: () => {\n                completed = true;\n                callback(complete);\n            }\n        }\n    };\n    const timeUpdateHandler = () => {\n        const duration = videoElement.duration;\n        const currentTime = videoElement.currentTime;\n        for (const event in events) {\n            if (events[event].isFired(currentTime, duration)) {\n                events[event].callback();\n                break;\n            }\n        }\n        callback(adProgress);\n    };\n    const endedHandler = () => {\n        const duration = videoElement.duration;\n        const currentTime = videoElement.currentTime;\n        if (!completed && isCompleted(currentTime, duration)) {\n            completed = true;\n            callback(complete);\n        }\n        videoElement.removeEventListener('ended', endedHandler);\n        videoElement.removeEventListener('timeupdate', timeUpdateHandler);\n    };\n    videoElement.addEventListener('timeupdate', timeUpdateHandler);\n    videoElement.addEventListener('ended', endedHandler);\n    return () => {\n        videoElement.removeEventListener('timeupdate', timeUpdateHandler);\n        videoElement.removeEventListener('ended', endedHandler);\n    };\n};\nexport default onTimeUpdate;\n","import { linearEvents } from '../../../../tracker';\nimport { volumeChanged } from '../../../adUnitEvents';\nconst { mute, unmute } = linearEvents;\nconst isMuted = (videoElement) => videoElement.muted || videoElement.volume === 0;\nconst onVolumeChange = ({ videoElement }, callback) => {\n    let wasMuted = isMuted(videoElement);\n    const volumechangeHandler = () => {\n        callback(volumeChanged);\n        if (wasMuted && !isMuted(videoElement)) {\n            callback(unmute);\n        }\n        else if (!wasMuted && isMuted(videoElement)) {\n            callback(mute);\n        }\n        wasMuted = isMuted(videoElement);\n    };\n    videoElement.addEventListener('volumechange', volumechangeHandler);\n    return () => {\n        videoElement.removeEventListener('volumechange', volumechangeHandler);\n    };\n};\nexport default onVolumeChange;\n","import { linearEvents } from '../../../../tracker';\nconst { impression, creativeView } = linearEvents;\nconst onImpression = ({ videoElement }, callback) => {\n    let started = false;\n    const impressionHandler = () => {\n        const currentTime = videoElement.currentTime;\n        if (!started && currentTime > 0) {\n            started = true;\n            callback(impression);\n            callback(creativeView);\n            videoElement.removeEventListener('timeupdate', impressionHandler);\n        }\n    };\n    videoElement.addEventListener('timeupdate', impressionHandler);\n    return () => {\n        videoElement.removeEventListener('timeupdate', impressionHandler);\n    };\n};\nexport default onImpression;\n","const toFixedDigits = (num, digits) => {\n    let formattedNum = String(num);\n    while (formattedNum.length < digits) {\n        formattedNum = '0' + formattedNum;\n    }\n    return formattedNum;\n};\nexport default toFixedDigits;\n","import toFixedDigits from './toFixedDigits';\nconst formatProgress = (progress) => {\n    const hours = Math.floor(progress / (60 * 60 * 1000));\n    const minutes = Math.floor((progress / (60 * 1000)) % 60);\n    const seconds = Math.floor((progress / 1000) % 60);\n    const ms = progress % 1000;\n    return (toFixedDigits(hours, 2) +\n        ':' +\n        toFixedDigits(minutes, 2) +\n        ':' +\n        toFixedDigits(seconds, 2) +\n        '.' +\n        toFixedDigits(ms, 3));\n};\nexport default formatProgress;\n","import { linearEvents } from '../../../../tracker';\nimport formatProgress from '../../progress/formatProgress';\nconst { progress } = linearEvents;\nconst secondsToMilliseconds = (seconds) => seconds * 1000;\nconst isPercentage = (offset) => {\n    const percentageRegex = /^\\d+(\\.\\d+)?%$/g;\n    return percentageRegex.test(offset) && !isNaN(parseFloat(offset));\n};\nconst isValid = ({ offset, uri }) => {\n    const offsetIsValid = typeof offset === 'number' || Boolean(offset && isPercentage(offset));\n    const uriIsValid = typeof uri === 'string' && uri.length > 0;\n    return offsetIsValid && uriIsValid;\n};\nconst offsetToMs = (offset, durationInMs) => {\n    if (typeof offset === 'number') {\n        return offset;\n    }\n    return (parseFloat(offset) / 100) * durationInMs;\n};\nconst onProgress = ({ videoElement }, callback, { progressEvents = [] } = {}) => {\n    const { duration } = videoElement;\n    const durationInMs = secondsToMilliseconds(duration);\n    let playedMs = 0;\n    let previousCurrentTime = secondsToMilliseconds(videoElement.currentTime);\n    let pendingEvents = progressEvents\n        .filter(isValid)\n        .map(({ offset, uri }) => ({\n        offset: offsetToMs(offset, durationInMs),\n        uri\n    }));\n    const progressHandler = () => {\n        const { currentTime } = videoElement;\n        const delta = Math.abs(currentTime - previousCurrentTime);\n        playedMs += secondsToMilliseconds(delta);\n        previousCurrentTime = currentTime;\n        const { stillPending, toCall } = pendingEvents.reduce((accumulator, event) => {\n            const { offset } = event;\n            if (typeof offset === 'number' && playedMs >= offset) {\n                accumulator.toCall.push(event);\n            }\n            else {\n                accumulator.stillPending.push(event);\n            }\n            return accumulator;\n        }, {\n            stillPending: [],\n            toCall: []\n        });\n        pendingEvents = stillPending;\n        toCall.forEach(({ uri }) => {\n            callback(progress, {\n                contentplayhead: formatProgress(playedMs),\n                progressUri: uri\n            });\n        });\n        if (pendingEvents.length === 0) {\n            videoElement.removeEventListener('timeupdate', progressHandler);\n        }\n    };\n    if (pendingEvents.length > 0) {\n        videoElement.addEventListener('timeupdate', progressHandler);\n    }\n    return () => {\n        videoElement.removeEventListener('timeupdate', progressHandler);\n    };\n};\nexport default onProgress;\n","import { linearEvents } from '../../../../tracker';\nconst { clickThrough } = linearEvents;\nconst createDefaultClickControl = () => {\n    const anchor = document.createElement('a');\n    anchor.classList.add('mol-vast-clickthrough');\n    anchor.style.width = '100%';\n    anchor.style.height = '100%';\n    anchor.style.position = 'absolute';\n    anchor.style.left = '0';\n    anchor.style.top = '0';\n    return anchor;\n};\nconst onClickThrough = ({ videoElement, element }, callback, { clickThroughUrl, pauseOnAdClick = true, createClickControl = createDefaultClickControl } = {}) => {\n    const placeholder = element || videoElement.parentNode;\n    const anchor = createClickControl();\n    const isVirtual = !document.body.contains(anchor);\n    if (isVirtual) {\n        placeholder.appendChild(anchor);\n    }\n    if (clickThroughUrl && anchor instanceof HTMLAnchorElement) {\n        anchor.href = clickThroughUrl;\n        anchor.target = '_blank';\n    }\n    anchor.onclick = (event) => {\n        event.stopPropagation();\n        if (videoElement.paused && pauseOnAdClick) {\n            event.preventDefault();\n            videoElement.play();\n        }\n        else {\n            if (pauseOnAdClick) {\n                videoElement.pause();\n            }\n            callback(clickThrough);\n        }\n    };\n    return () => {\n        if (isVirtual) {\n            placeholder.removeChild(anchor);\n        }\n    };\n};\nexport default onClickThrough;\n","import onFullscreenChange from './onFullscreenChange';\nimport onPlayPause from './onPlayPause';\nimport onRewind from './onRewind';\nimport onSkip from './onSkip';\nimport onError from './onError';\nimport onTimeUpdate from './onTimeUpdate';\nimport onVolumeChange from './onVolumeChange';\nimport onImpression from './onImpression';\nimport onProgress from './onProgress';\nimport onClickThrough from './onClickThrough';\nconst handlers = [\n    onClickThrough,\n    onError,\n    onFullscreenChange,\n    onImpression,\n    onPlayPause,\n    onProgress,\n    onRewind,\n    onSkip,\n    onTimeUpdate,\n    onVolumeChange\n];\nexport default handlers;\n","import { getClickThrough, getSkipOffset } from '../../../vastSelectors';\nimport getProgressEvents from '../progress/getProgressEvents';\nimport safeCallback from '../safeCallback';\nimport metricHandlers from './handlers';\nconst setupMetricHandlers = ({ vastChain, videoAdContainer, hooks, pauseOnAdClick }, callback) => {\n    const inlineAd = vastChain[0].ad;\n    const skipoffset = inlineAd && getSkipOffset(inlineAd);\n    const clickThroughUrl = inlineAd && getClickThrough(inlineAd);\n    const progressEvents = getProgressEvents(vastChain);\n    const data = Object.assign({ clickThroughUrl,\n        pauseOnAdClick,\n        progressEvents,\n        skipoffset }, hooks);\n    const stopHandlersFns = metricHandlers.map((handler) => safeCallback(handler(videoAdContainer, callback, data)));\n    return () => stopHandlersFns.forEach((disconnect) => disconnect());\n};\nexport default setupMetricHandlers;\n","/**\n * Ad unit error\n */\nclass AdUnitError extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'AdUnitError';\n        Object.setPrototypeOf(this, AdUnitError.prototype);\n    }\n}\nexport default AdUnitError;\n","export default window.MutationObserver ||\n    window.WebKitMutationObserver ||\n    window.MozMutationObserver;\n","import debounce from 'lodash.debounce';\nimport MutationObserver from './helpers/MutationObserver';\nconst validate = (target, callback) => {\n    if (!(target instanceof Element)) {\n        throw new TypeError('Target is not an Element node');\n    }\n    if (!(callback instanceof Function)) {\n        throw new TypeError('Callback is not a function');\n    }\n};\nconst noop = () => { };\nconst sizeMutationAttrs = ['style', 'clientWidth', 'clientHeight'];\nconst createResizeMO = (target, callback) => {\n    const observer = new MutationObserver((mutations) => {\n        for (let index = 0; index < mutations.length; index++) {\n            const { attributeName } = mutations[index];\n            if (attributeName && sizeMutationAttrs.includes(attributeName)) {\n                callback();\n            }\n        }\n    });\n    observer.observe(target, {\n        attributes: true,\n        characterData: false,\n        childList: true\n    });\n    return observer;\n};\nconst mutationHandlers = Symbol('mutationHandlers');\nconst observerKey = Symbol('mutationObserver');\nconst onMutation = (target, callback) => {\n    var _a;\n    if (!target[mutationHandlers]) {\n        target[mutationHandlers] = [];\n        const execHandlers = () => {\n            var _a;\n            (_a = target[mutationHandlers]) === null || _a === void 0 ? void 0 : _a.forEach((handler) => handler());\n        };\n        target[observerKey] = createResizeMO(target, execHandlers);\n    }\n    (_a = target[mutationHandlers]) === null || _a === void 0 ? void 0 : _a.push(callback);\n    return () => {\n        var _a, _b, _c;\n        target[mutationHandlers] = (_a = target[mutationHandlers]) === null || _a === void 0 ? void 0 : _a.filter((handler) => handler !== callback);\n        if (((_b = target[mutationHandlers]) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n            (_c = target[observerKey]) === null || _c === void 0 ? void 0 : _c.disconnect();\n            delete target[mutationHandlers];\n            delete target[observerKey];\n        }\n    };\n};\nconst createResizeElement = (callback) => {\n    const iframe = document.createElement('iframe');\n    iframe.setAttribute('style', 'display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; border: 0; overflow: hidden; pointer-events: none; z-index: -1;');\n    iframe.setAttribute('type', 'text/html');\n    iframe.setAttribute('loading', 'eager');\n    iframe.onload = () => {\n        if (iframe.contentWindow) {\n            iframe.contentWindow.addEventListener('resize', callback);\n        }\n    };\n    iframe.src = 'about:blank';\n    return iframe;\n};\nconst resizeHandlers = Symbol('resizeHandlers');\nconst resizeElement = Symbol('resizeElement');\n// Original code http://www.backalleycoder.com/2013/03/18/cross-browser-event-based-element-resize-detection/\nconst onResize = (target, callback) => {\n    var _a;\n    if (!target[resizeHandlers]) {\n        target[resizeHandlers] = [];\n        const execHandlers = () => {\n            var _a;\n            (_a = target[resizeHandlers]) === null || _a === void 0 ? void 0 : _a.forEach((handler) => handler());\n        };\n        target[resizeElement] = createResizeElement(execHandlers);\n        if (getComputedStyle(target).position === 'static') {\n            target.style.position = 'relative';\n        }\n        target.appendChild(target[resizeElement]);\n    }\n    (_a = target[resizeHandlers]) === null || _a === void 0 ? void 0 : _a.push(callback);\n    return () => {\n        var _a, _b;\n        target[resizeHandlers] = (_a = target[resizeHandlers]) === null || _a === void 0 ? void 0 : _a.filter((handler) => handler !== callback);\n        if (((_b = target[resizeHandlers]) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n            target.removeChild(target[resizeElement]);\n            delete target[resizeHandlers];\n            delete target[resizeElement];\n        }\n    };\n};\n/**\n * Helper function to know if an element has been resized.\n *\n * @ignore\n *\n * @param target The element that we want to observe.\n * @param callback The callback that handles the resize.\n * @param options Options Map.\n *\n * @returns Unsubscribe function.\n */\nconst onElementResize = (target, callback, { threshold = 20 } = {}) => {\n    validate(target, callback);\n    const makeSizeId = ({ style, clientHeight, clientWidth }) => [style.width, style.height, clientWidth, clientHeight].join('.');\n    let lastSize = makeSizeId(target);\n    const checkElementSize = () => {\n        const currentSize = makeSizeId(target);\n        if (currentSize !== lastSize) {\n            lastSize = currentSize;\n            callback();\n        }\n    };\n    const checkElementHandler = debounce(checkElementSize, threshold);\n    const stopObservingMutations = MutationObserver\n        ? onMutation(target, checkElementHandler)\n        : noop;\n    const stopListeningToResize = onResize(target, checkElementHandler);\n    return () => {\n        stopObservingMutations();\n        stopListeningToResize();\n    };\n};\nexport default onElementResize;\n","export default window.IntersectionObserver;\n","import debounce from 'lodash.debounce';\nimport IntersectionObserver from './helpers/IntersectionObserver';\nconst validate = (target, callback) => {\n    if (!(target instanceof Element)) {\n        throw new TypeError('Target is not an Element node');\n    }\n    if (!(callback instanceof Function)) {\n        throw new TypeError('Callback is not a function');\n    }\n};\nconst noop = () => { };\nconst intersectionHandlers = Symbol('intersectionHandlers');\nconst observerKey = Symbol('intersectionObserver');\nconst onIntersection = (target, callback) => {\n    var _a, _b;\n    if (!target[intersectionHandlers]) {\n        target[intersectionHandlers] = [];\n        const execHandlers = (entries, observer) => {\n            var _a;\n            (_a = target[intersectionHandlers]) === null || _a === void 0 ? void 0 : _a.forEach((handler) => handler(entries, observer));\n        };\n        const options = {\n            root: null,\n            rootMargin: '0px',\n            threshold: [...new Array(11)].map((_item, index) => index / 10)\n        };\n        target[observerKey] = new IntersectionObserver(execHandlers, options);\n        (_a = target[observerKey]) === null || _a === void 0 ? void 0 : _a.observe(target);\n    }\n    (_b = target[intersectionHandlers]) === null || _b === void 0 ? void 0 : _b.push(callback);\n    return () => {\n        var _a, _b, _c;\n        target[intersectionHandlers] = (_a = target[intersectionHandlers]) === null || _a === void 0 ? void 0 : _a.filter((handler) => handler !== callback);\n        if (((_b = target[intersectionHandlers]) === null || _b === void 0 ? void 0 : _b.length) === 0) {\n            (_c = target[observerKey]) === null || _c === void 0 ? void 0 : _c.disconnect();\n            delete target[intersectionHandlers];\n            delete target[observerKey];\n        }\n    };\n};\nlet visibilityHandlers = [];\nconst onVisibilityChange = (_target, callback) => {\n    const execHandlers = () => {\n        if (visibilityHandlers) {\n            visibilityHandlers.forEach((handler) => handler());\n        }\n    };\n    visibilityHandlers.push(callback);\n    if (visibilityHandlers.length === 1) {\n        document.addEventListener('visibilitychange', execHandlers);\n    }\n    return () => {\n        visibilityHandlers = visibilityHandlers.filter((handler) => handler !== callback);\n        if (visibilityHandlers.length === 0) {\n            document.removeEventListener('visibilitychange', execHandlers);\n        }\n    };\n};\nlet lastIntersectionEntries = [];\n/**\n * Helper function to know if the visibility of an element has changed.\n *\n * @ignore\n *\n * @param target The element that we want to observe.\n * @param callback The callback that handles the visibility change.\n * @param options Options Map.\n *\n * @returns Unsubscribe function.\n */\nconst onElementVisibilityChange = (target, callback, { threshold = 100, viewabilityOffset = 0.4 } = {}) => {\n    validate(target, callback);\n    if (!IntersectionObserver) {\n        // NOTE: visibility is not determined\n        callback(undefined);\n        return noop;\n    }\n    let lastIsInViewport = false;\n    const checkVisibility = (entries) => {\n        entries.forEach((entry) => {\n            if (entry.target === target) {\n                const isInViewport = !document.hidden && entry.intersectionRatio > viewabilityOffset;\n                if (isInViewport !== lastIsInViewport) {\n                    lastIsInViewport = isInViewport;\n                    callback(isInViewport);\n                }\n            }\n        });\n        lastIntersectionEntries = entries;\n    };\n    const visibilityHandler = debounce(checkVisibility, threshold);\n    const stopObservingIntersection = onIntersection(target, visibilityHandler);\n    const stopListeningToVisibilityChange = onVisibilityChange(target, () => visibilityHandler(lastIntersectionEntries));\n    return () => {\n        stopObservingIntersection();\n        stopListeningToVisibilityChange();\n    };\n};\nexport default onElementVisibilityChange;\n","/**\n * Subset of node's [Emitter class](https://nodejs.org/api/events.html#events_class_eventemitter)\n *\n * @param logger Optional logger instance. Must comply to the [Console interface](https://developer.mozilla.org/es/docs/Web/API/Console).\n */\nclass Emitter {\n    constructor(logger) {\n        this.events = {};\n        this.logger = logger || console;\n    }\n    /**\n     * Adds the listener function to the end of the listeners array for the event named eventName.\n     *\n     * @param eventName The name of the event.\n     * @param listener Listener fn that handles the evt.\n     * @returns The Emitter instance.\n     */\n    on(eventName, listener) {\n        const events = this.events;\n        const eventListeners = events[eventName] || (events[eventName] = []);\n        eventListeners.push(listener);\n        return this;\n    }\n    /**\n     * Removes the specified listener from the listener array for the event named eventName.\n     *\n     * @param eventName The name of the event.\n     * @param listener Listener fn that handles the evt.\n     * @returns The Emitter instance.\n     */\n    removeListener(eventName, listener) {\n        const events = this.events;\n        const eventListeners = events[eventName] || (events[eventName] = []);\n        events[eventName] = eventListeners.filter((eListener) => eListener !== listener && eListener._ !== listener);\n        return this;\n    }\n    /**\n     * Removes all listeners, or those of the specified eventName.\n     *\n     * @param eventName The name of the event. Optional if omitted all listeners will be removed.\n     * @returns The Emitter instance.\n     */\n    removeAllListeners(eventName) {\n        if (eventName) {\n            delete this.events[eventName];\n        }\n        else {\n            this.events = {};\n        }\n        return this;\n    }\n    /**\n     * Adds a one time listener function for the event named eventName. The next time eventName is triggered,\n     * this listener is removed and then invoked.\n     *\n     * @param eventName The name of the event.\n     * @param listener Listener fn that handles the evt.\n     * @returns The Emitter instance.\n     */\n    once(eventName, listener) {\n        const handler = (...args) => {\n            this.removeListener(eventName, handler);\n            listener(...args);\n        };\n        handler._ = listener;\n        return this.on(eventName, handler);\n    }\n    /**\n     * Synchronously calls each of the listeners registered for the event named eventName, in the order they were registered,\n     * passing the supplied arguments to each.\n     *\n     * @param eventName The name of the event.\n     * @returns Returns true if the event had listeners, false otherwise.\n     */\n    emit(eventName, ...args) {\n        const events = this.events;\n        const eventListeners = events[eventName] || (events[eventName] = []);\n        const hasListeners = eventListeners.length > 0;\n        eventListeners.forEach((handler) => {\n            try {\n                handler(...args);\n            }\n            catch (error) {\n                if (error instanceof Error) {\n                    this.logger.error(error, error.stack);\n                }\n            }\n        });\n        return hasListeners;\n    }\n}\nexport default Emitter;\n","const getResource = ({ staticResource, htmlResource, iFrameResource } = {}) => staticResource || htmlResource || iFrameResource || undefined;\nexport default getResource;\n","import { getIcons } from '../../../vastSelectors';\nimport getResource from '../resources/getResource';\nconst UNKNOWN = 'UNKNOWN';\nconst uniqBy = (array, uniqValue) => {\n    const seen = {};\n    return array.filter((item) => {\n        const key = uniqValue(item);\n        if (!key || seen.hasOwnProperty(key)) {\n            return false;\n        }\n        seen[key] = true;\n        return true;\n    });\n};\nconst uniqByResource = (icons) => uniqBy(icons, getResource);\nconst groupIconsByProgram = (icons) => icons.reduce((accumulator, icon) => {\n    var _a, _b;\n    const program = (_a = icon.program) !== null && _a !== void 0 ? _a : UNKNOWN;\n    (_b = accumulator[program]) !== null && _b !== void 0 ? _b : (accumulator[program] = []);\n    accumulator[program].push(icon);\n    return accumulator;\n}, {});\nconst sortIconByBestPxratio = (icons) => {\n    const devicePixelRatio = window.devicePixelRatio || 0;\n    const compareTo = (iconA, iconB) => {\n        const deltaA = Math.abs(devicePixelRatio - (iconA.pxratio || 0));\n        const deltaB = Math.abs(devicePixelRatio - (iconB.pxratio || 0));\n        return deltaA - deltaB;\n    };\n    return icons.slice(0).sort(compareTo);\n};\nconst chooseByPxRatio = (icons) => {\n    if (icons.length === 1) {\n        return icons[0];\n    }\n    return sortIconByBestPxratio(icons)[0];\n};\nconst chooseIcons = (icons) => {\n    const byProgram = groupIconsByProgram(icons);\n    const programs = Object.keys(byProgram);\n    return programs.reduce((accumulator, program) => {\n        if (program === UNKNOWN) {\n            return [...accumulator, ...byProgram[UNKNOWN]];\n        }\n        return [...accumulator, chooseByPxRatio(byProgram[program])];\n    }, []);\n};\nconst retrieveIcons = (vastChain) => {\n    const ads = vastChain.map(({ ad }) => ad).filter(Boolean);\n    const icons = ads.reduce((accumulator, ad) => [...accumulator, ...(getIcons(ad) || [])], []);\n    if (icons.length > 0) {\n        const uniqIcons = uniqByResource(icons);\n        return chooseIcons(uniqIcons);\n    }\n};\nexport default retrieveIcons;\n","import once from './once';\nconst waitFor = (element, event) => {\n    let pending = true;\n    let resolvePromise;\n    let rejectPromise;\n    const promise = new Promise((resolve, reject) => {\n        resolvePromise = resolve;\n        rejectPromise = reject;\n    });\n    const cancelOnce = once(element, event, (...args) => {\n        pending = false;\n        resolvePromise(args);\n    });\n    const cancel = () => {\n        if (pending) {\n            pending = false;\n            cancelOnce();\n            rejectPromise(new Error('waitFor was canceled'));\n        }\n    };\n    return {\n        cancel,\n        promise\n    };\n};\nexport default waitFor;\n","class FetchError extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'FetchError';\n        Object.setPrototypeOf(this, FetchError.prototype);\n    }\n}\nconst isValidContentType = (contentType) => {\n    const normalisedCT = contentType.toLowerCase();\n    return ['text/plain', 'text/html'].some((allowedType) => normalisedCT.includes(allowedType));\n};\nconst fetchHtml = async (endpoint) => {\n    const response = await fetch(endpoint);\n    const contentType = response.headers.get('Content-Type');\n    if (response.status >= 400) {\n        const error = new FetchError(response.statusText);\n        error.response = response;\n        throw error;\n    }\n    if (!contentType || !isValidContentType(contentType)) {\n        const error = new FetchError(`fetchHtml error, invalid Content-Type ${contentType}`);\n        error.response = response;\n        throw error;\n    }\n    return response.text();\n};\nexport default fetchHtml;\n","import fetchHtml from '../fetch/fetchHtml';\nconst createHtmlResource = (src, { document, data }) => {\n    const { height, width } = data;\n    const divElement = document.createElement('div');\n    if (width) {\n        divElement.style.width = `${width}px`;\n    }\n    if (height) {\n        divElement.style.height = `${height}px`;\n    }\n    fetchHtml(src)\n        .then((html) => {\n        divElement.innerHTML = html;\n        divElement.dispatchEvent(new CustomEvent('load'));\n    })\n        .catch(() => {\n        divElement.dispatchEvent(new CustomEvent('error'));\n    });\n    return divElement;\n};\nexport default createHtmlResource;\n","import createHtmlResource from './createHtmlResource';\nimport createIframeResource from './createIframeResource';\nimport createStaticResource from './createStaticResource';\nconst noopResource = document.createElement('div');\nconst createResource = (document, data) => {\n    const { staticResource, htmlResource, iFrameResource } = data;\n    if (staticResource) {\n        return createStaticResource(staticResource, {\n            data,\n            document\n        });\n    }\n    if (htmlResource) {\n        return createHtmlResource(htmlResource, {\n            data,\n            document\n        });\n    }\n    if (iFrameResource) {\n        return createIframeResource(iFrameResource, {\n            data,\n            document\n        });\n    }\n    return noopResource;\n};\nexport default createResource;\n","import waitFor from '../dom/waitFor';\nimport createResource from './createResource';\nconst noop = () => { };\nconst loadResource = (icon, { document, placeholder }) => new Promise((resolve, reject) => {\n    try {\n        const resourceElement = createResource(document, icon);\n        const resourceErrorWait = waitFor(resourceElement, 'error');\n        const resourceLoadWait = waitFor(resourceElement, 'load');\n        const cleanUp = () => {\n            if (placeholder.contains(resourceElement)) {\n                placeholder.removeChild(resourceElement);\n                resourceElement.style.zIndex = '0';\n            }\n        };\n        resourceErrorWait.promise\n            .then(() => {\n            resourceLoadWait.cancel();\n            cleanUp();\n            reject(new Error('Error loading resource'));\n        })\n            .catch(noop);\n        resourceLoadWait.promise\n            .then(() => {\n            resourceErrorWait.cancel();\n            cleanUp();\n            resolve(resourceElement);\n        })\n            .catch(noop);\n        // Some browsers will not load the resource if they are not added to the DOM\n        resourceElement.style.zIndex = '-9999';\n        placeholder.appendChild(resourceElement);\n    }\n    catch (error) {\n        reject(error);\n    }\n});\nexport default loadResource;\n","const createStaticResource = (src, { document, data }) => {\n    const { height, width } = data;\n    const image = document.createElement('img');\n    if (width) {\n        image.width = width;\n    }\n    if (height) {\n        image.height = height;\n    }\n    image.src = src;\n    return image;\n};\nexport default createStaticResource;\n","const createIframeResource = (src, { document, data }) => {\n    const { height, width } = data;\n    const iframeElement = document.createElement('iframe');\n    iframeElement.setAttribute('sandbox', 'allow-forms allow-popups allow-scripts');\n    iframeElement.setAttribute('loading', 'eager');\n    if (width) {\n        iframeElement.width = width.toString();\n    }\n    if (height) {\n        iframeElement.height = height.toString();\n    }\n    iframeElement.src = src;\n    iframeElement.frameBorder = '0';\n    iframeElement.style.border = 'none';\n    return iframeElement;\n};\nexport default createIframeResource;\n","const calculateArea = ({ height, width }) => height * width;\nexport const hasSpace = (newIcon, config) => {\n    const { drawnIcons, placeholder } = config;\n    const placeholderArea = calculateArea(placeholder.getBoundingClientRect());\n    const iconArea = calculateArea(newIcon);\n    const usedIconsArea = drawnIcons.reduce((accumulator, icon) => {\n        const { width, height } = icon;\n        if (!width || !height) {\n            return accumulator;\n        }\n        return accumulator + calculateArea({ width, height });\n    }, 0);\n    return iconArea + usedIconsArea <= placeholderArea * 0.35;\n};\nexport const withinBoundaries = (newIcon, { placeholder }) => {\n    const phRect = placeholder.getBoundingClientRect();\n    return (newIcon.left >= 0 &&\n        newIcon.left + newIcon.width <= phRect.width &&\n        newIcon.top >= 0 &&\n        newIcon.top + newIcon.height <= phRect.height);\n};\nconst right = ({ left, width }) => left + width;\nconst left = ({ left }) => left;\nconst top = ({ top }) => top;\nconst bottom = ({ top, height }) => top + height;\nconst overlap = (newIcon, drawnIcon) => left(newIcon) <= right(drawnIcon) &&\n    right(newIcon) >= left(drawnIcon) &&\n    bottom(newIcon) >= top(drawnIcon) &&\n    top(newIcon) <= bottom(drawnIcon);\nexport const withoutOverlaps = (newIcon, { drawnIcons }) => !drawnIcons.some((drawnIcon) => overlap(newIcon, drawnIcon));\nconst canBeRendered = (newIcon, config) => {\n    const thereIsSpace = hasSpace(newIcon, config);\n    const isWithinTheContentArea = withinBoundaries(newIcon, config);\n    const doesNotOverlap = withoutOverlaps(newIcon, config);\n    return thereIsSpace && isWithinTheContentArea && doesNotOverlap;\n};\nexport default canBeRendered;\n","import loadResource from '../resources/loadResource';\nimport updateIcon from './updateIcon';\nimport canBeRendered from './canBeRendered';\nconst noop = () => { };\nconst wrapWithClickThrough = (iconElement, icon, { onIconClick = noop } = {}) => {\n    const anchor = document.createElement('a');\n    if (icon.iconClickThrough) {\n        anchor.href = icon.iconClickThrough;\n        anchor.target = '_blank';\n    }\n    // NOTE: if iframe icon disable pointer events so that clickThrough and click tracking work\n    if (icon.iFrameResource) {\n        iconElement.style.pointerEvents = 'none';\n    }\n    anchor.onclick = (event) => {\n        if (Event.prototype.stopPropagation !== undefined) {\n            event.stopPropagation();\n        }\n        onIconClick(icon);\n    };\n    anchor.appendChild(iconElement);\n    return anchor;\n};\nconst createIcon = async (icon, options) => {\n    if (!icon.element) {\n        const iconResource = await loadResource(icon, options);\n        if (iconResource instanceof HTMLIFrameElement ||\n            iconResource instanceof HTMLImageElement) {\n            iconResource.width = '100%';\n            iconResource.height = '100%';\n        }\n        iconResource.style.height = '100%';\n        iconResource.style.width = '100%';\n        icon.element = wrapWithClickThrough(iconResource, icon, options);\n    }\n    return icon.element;\n};\nconst updateIconElement = (iconElement, icon) => {\n    const { height, width, left, top, yPosition } = icon;\n    iconElement.style.position = 'absolute';\n    iconElement.style.left = `${left}px`;\n    // NOTE: This if is a bit odd but some browser don't calculate the placeholder height pixel perfect and,\n    //       setting the top of the icon will change the size of the icon's placeholder this if prevents that situation\n    if (yPosition === 'bottom') {\n        iconElement.style.bottom = '0';\n    }\n    else {\n        iconElement.style.top = `${top}px`;\n    }\n    iconElement.style.height = `${height}px`;\n    iconElement.style.width = `${width}px`;\n    return iconElement;\n};\nconst renderIcon = async (icon, config) => {\n    var _a;\n    const { placeholder } = config;\n    const iconElement = await createIcon(icon, config);\n    const updatedIcon = updateIcon(icon, iconElement, config);\n    if (canBeRendered(updatedIcon, config)) {\n        if (!iconElement.parentNode || updatedIcon.updated) {\n            placeholder.appendChild(updateIconElement(iconElement, updatedIcon));\n        }\n    }\n    else {\n        (_a = iconElement.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(iconElement);\n        throw new Error(\"Icon can't be rendered\");\n    }\n    return updatedIcon;\n};\nexport default renderIcon;\n","const isCustomXposition = (xPosition) => !['left', 'right'].includes(String(xPosition).toLowerCase());\nconst isCustomYPosition = (yPosition) => !['top', 'bottom'].includes(String(yPosition).toLowerCase());\nconst calculateIconLeft = (dynamicPos, iconWidth, drawnIcons, phWidth) => {\n    const drawnIconsWidth = drawnIcons.reduce((accumulator, icon) => accumulator + (icon.width ? icon.width + 1 : 0), 0);\n    if (dynamicPos === 'left') {\n        return drawnIconsWidth;\n    }\n    return phWidth - drawnIconsWidth - iconWidth;\n};\nconst calculateIconTop = (dynamicPos, iconHeight, phHeight) => {\n    if (dynamicPos === 'top') {\n        return 0;\n    }\n    return phHeight - iconHeight;\n};\nconst updateIcon = (icon, iconElement, { drawnIcons, placeholder }) => {\n    const oldSignature = icon.signature;\n    const rect = iconElement.getBoundingClientRect();\n    const phRect = placeholder.getBoundingClientRect();\n    const width = icon.width || rect.width;\n    const height = icon.height || rect.height;\n    const xPosition = icon.xPosition || 'right';\n    const yPosition = icon.yPosition || 'top';\n    let left;\n    let top;\n    if (isCustomXposition(xPosition)) {\n        left = xPosition;\n    }\n    else {\n        const icons = drawnIcons.filter((dIcon) => dIcon.xPosition === xPosition && dIcon.yPosition === yPosition);\n        left = calculateIconLeft(xPosition, width, icons, phRect.width);\n    }\n    if (isCustomYPosition(yPosition)) {\n        top = yPosition;\n    }\n    else {\n        top = calculateIconTop(yPosition, height, phRect.height);\n    }\n    const signature = `${left}-${top}_${width}x${height}`;\n    return Object.assign(icon, {\n        height,\n        left,\n        signature,\n        top,\n        updated: oldSignature !== signature,\n        width\n    });\n};\nexport default updateIcon;\n","import renderIcon from './renderIcon';\nimport canBeShown from './canBeShown';\nconst renderIcons = (icons, { onIconClick, videoAdContainer, logger = console }) => {\n    const { element, videoElement } = videoAdContainer;\n    const drawnIcons = [];\n    const { iconsToShow, otherIcons } = icons.reduce((accumulator, icon) => {\n        if (canBeShown(icon, videoElement)) {\n            accumulator.iconsToShow.push(icon);\n        }\n        else {\n            accumulator.otherIcons.push(icon);\n        }\n        return accumulator;\n    }, {\n        iconsToShow: [],\n        otherIcons: []\n    });\n    otherIcons.forEach(({ element: iconElement }) => {\n        var _a;\n        (_a = iconElement === null || iconElement === void 0 ? void 0 : iconElement.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(iconElement);\n    });\n    return iconsToShow\n        .reduce((promise, icon) => promise\n        .then(() => renderIcon(icon, {\n        document,\n        drawnIcons,\n        onIconClick,\n        placeholder: element\n    }))\n        .then((renderedIcon) => {\n        drawnIcons.push(renderedIcon);\n    })\n        .catch((error) => logger.log(error)), Promise.resolve())\n        .then(() => drawnIcons);\n};\nexport default renderIcons;\n","const canBeShown = (icon, videoElement) => {\n    const currentTimeInMs = videoElement.currentTime * 1000;\n    const videoDurationInMs = videoElement.duration * 1000;\n    const offset = typeof icon.offset === 'string'\n        ? parseInt(icon.offset, 10)\n        : icon.offset || 0;\n    const duration = icon.duration || videoDurationInMs;\n    return offset <= currentTimeInMs && currentTimeInMs - offset <= duration;\n};\nexport default canBeShown;\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport renderIcons from './renderIcons';\nconst firstRenderPending = Symbol('firstRenderPending');\nconst noop = () => { };\nconst hasPendingIconRedraws = (icons, videoElement) => {\n    const currentTimeInMs = videoElement.currentTime * 1000;\n    const videoDurationInMs = videoElement.duration * 1000;\n    const iconsPendingToRedraw = icons.filter((icon) => !icon.offset || icon.offset < currentTimeInMs);\n    const iconsPendingToBeRemoved = icons.filter((icon) => icon.duration && icon.duration < videoDurationInMs);\n    return iconsPendingToRedraw.length > 0 || iconsPendingToBeRemoved.length > 0;\n};\nconst removeDrawnIcons = (icons) => icons\n    .filter(({ element }) => Boolean(element === null || element === void 0 ? void 0 : element.parentNode))\n    .forEach(({ element }) => { var _a; return (_a = element === null || element === void 0 ? void 0 : element.parentNode) === null || _a === void 0 ? void 0 : _a.removeChild(element); });\nconst addIcons = (icons, _a) => {\n    var { videoAdContainer, onIconView = noop, onIconClick = noop } = _a, rest = __rest(_a, [\"videoAdContainer\", \"onIconView\", \"onIconClick\"]);\n    const { videoElement, element } = videoAdContainer;\n    const drawIcons = async () => {\n        const drawnIcons = await renderIcons(icons, Object.assign({ onIconClick,\n            videoAdContainer }, rest));\n        element.dispatchEvent(new CustomEvent('iconsDrawn'));\n        drawnIcons.forEach((icon) => {\n            if (icon[firstRenderPending]) {\n                onIconView(icon);\n                icon[firstRenderPending] = false;\n            }\n        });\n    };\n    icons.forEach((icon) => {\n        icon[firstRenderPending] = true;\n    });\n    return {\n        drawIcons,\n        hasPendingIconRedraws: () => hasPendingIconRedraws(icons, videoElement),\n        removeIcons: () => removeDrawnIcons(icons)\n    };\n};\nexport default addIcons;\n","var _a, _b;\nimport { linearEvents } from '../tracker';\nimport { getViewable } from '../vastSelectors';\nimport { finish } from './adUnitEvents';\nimport { onElementVisibilityChange, onElementResize } from './helpers/dom/elementObservers';\nimport preventManualProgress from './helpers/dom/preventManualProgress';\nimport Emitter from './helpers/Emitter';\nimport retrieveIcons from './helpers/icons/retrieveIcons';\nimport addIcons from './helpers/icons/addIcons';\nimport viewmode from './helpers/vpaid/viewmode';\nimport safeCallback from './helpers/safeCallback';\nconst { start, viewable, notViewable, viewUndetermined, iconClick, iconView } = linearEvents;\nconst _private = Symbol('_private');\nexport const _protected = Symbol('_protected');\n/**\n * This class provides shared logic among all the ad units.\n */\nclass VideoAdUnit extends Emitter {\n    /**\n     * Creates a {@link VideoAdUnit}.\n     *\n     * @param vastChain The {@link VastChain} with all the {@link VastResponse}\n     * @param videoAdContainer container instance to place the ad\n     * @param options Options Map. The allowed properties are:\n     */\n    constructor(vastChain, videoAdContainer, { viewability = false, responsive = false, logger = console, pauseOnAdClick = true } = {}) {\n        super(logger);\n        this[_a] = {\n            addIcons: () => {\n                if (!this.icons) {\n                    return;\n                }\n                const { drawIcons, hasPendingIconRedraws, removeIcons } = addIcons(this.icons, {\n                    logger: this.logger,\n                    onIconClick: (icon) => this.emit(iconClick, {\n                        adUnit: this,\n                        data: icon,\n                        type: iconClick\n                    }),\n                    onIconView: (icon) => this.emit(iconView, {\n                        adUnit: this,\n                        data: icon,\n                        type: iconView\n                    }),\n                    videoAdContainer: this.videoAdContainer\n                });\n                this[_protected].drawIcons = drawIcons;\n                this[_protected].removeIcons = removeIcons;\n                this[_protected].hasPendingIconRedraws = hasPendingIconRedraws;\n                this[_protected].onFinishCallbacks.push(removeIcons);\n            },\n            setupViewableImpression: () => {\n                let timeoutId;\n                const unsubscribe = onElementVisibilityChange(this.videoAdContainer.element, (visible) => {\n                    if (this.isFinished() || this[_protected].viewable) {\n                        return;\n                    }\n                    if (typeof visible !== 'boolean') {\n                        this[_private].handleViewableImpression(viewUndetermined);\n                        return;\n                    }\n                    if (visible) {\n                        timeoutId = window.setTimeout(this[_private].handleViewableImpression, 2000, viewable);\n                    }\n                    else {\n                        clearTimeout(timeoutId);\n                    }\n                }, { viewabilityOffset: 0.5 });\n                this[_protected].onFinishCallbacks.push(() => {\n                    unsubscribe();\n                    clearTimeout(timeoutId);\n                    if (!this[_protected].viewable) {\n                        this[_private].handleViewableImpression(notViewable);\n                    }\n                });\n            },\n            handleViewableImpression: (event) => {\n                this[_protected].viewable = Boolean(event);\n                this.emit(event, {\n                    adUnit: this,\n                    type: event\n                });\n            },\n            setupViewability: () => {\n                const unsubscribe = onElementVisibilityChange(this.videoAdContainer.element, (visible) => {\n                    if (this.isFinished()) {\n                        return;\n                    }\n                    if (typeof visible === 'boolean') {\n                        if (visible) {\n                            this.resume();\n                        }\n                        else {\n                            this.pause();\n                        }\n                    }\n                });\n                this[_protected].onFinishCallbacks.push(unsubscribe);\n            },\n            setupResponsive: () => {\n                const { element } = this.videoAdContainer;\n                this[_protected].size = {\n                    height: element.clientHeight,\n                    viewmode: viewmode(element.clientWidth, element.clientHeight),\n                    width: element.clientWidth\n                };\n                const unsubscribe = onElementResize(element, () => {\n                    if (this.isFinished()) {\n                        return;\n                    }\n                    const prevSize = this[_protected].size;\n                    const height = element.clientHeight;\n                    const width = element.clientWidth;\n                    if (height !== (prevSize === null || prevSize === void 0 ? void 0 : prevSize.height) || width !== (prevSize === null || prevSize === void 0 ? void 0 : prevSize.width)) {\n                        this.resize(width, height, viewmode(width, height));\n                    }\n                });\n                this[_protected].onFinishCallbacks.push(unsubscribe);\n            }\n        };\n        this[_b] = {\n            finished: false,\n            started: false,\n            viewable: false,\n            onErrorCallbacks: [],\n            onFinishCallbacks: [],\n            finish: () => {\n                if (!this.isFinished()) {\n                    this[_protected].finished = true;\n                    this[_protected].onFinishCallbacks.forEach((callback) => callback());\n                    this.emit(finish, {\n                        adUnit: this,\n                        type: finish\n                    });\n                }\n            },\n            throwIfCalled: () => {\n                throw new Error('VideoAdUnit method must be implemented on child class');\n            },\n            throwIfFinished: () => {\n                if (this.isFinished()) {\n                    throw new Error('VideoAdUnit is finished');\n                }\n            }\n        };\n        /** Reference to the {@link VastChain} used to load the ad. */\n        this.vastChain = vastChain;\n        /** Reference to the {@link VideoAdContainer} that contains the ad. */\n        this.videoAdContainer = videoAdContainer;\n        /** Array of {@link VastIcon} definitions to display from the passed {@link VastChain} or undefined if there are no icons.*/\n        this.icons = retrieveIcons(vastChain);\n        this.pauseOnAdClick = pauseOnAdClick;\n        this[_protected].onFinishCallbacks.push(preventManualProgress(this.videoAdContainer.videoElement));\n        this[_private].addIcons();\n        const viewableImpression = vastChain.some(({ ad }) => ad && getViewable(ad));\n        if (viewableImpression) {\n            this.once(start, this[_private].setupViewableImpression);\n        }\n        if (viewability) {\n            this.once(start, this[_private].setupViewability);\n        }\n        if (responsive) {\n            this.once(start, this[_private].setupResponsive);\n        }\n    }\n    /*\n     * Starts the ad unit.\n     *\n     * @throws if called twice.\n     * @throws if ad unit is finished.\n     */\n    start() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    resume() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    pause() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Skips the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    skip() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param volume must be a value between 0 and 1;\n     */\n    setVolume(_volume) {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns the volume of the ad unit.\n     */\n    getVolume() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n    cancel() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the duration of the ad unit.\n     */\n    duration() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n    paused() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the current time of the ad unit.\n     */\n    currentTime() {\n        this[_protected].throwIfCalled();\n    }\n    /**\n     * Register a callback function that will be called whenever the ad finishes. No matter if it was finished because de ad ended, or cancelled or there was an error playing the ad.\n     *\n     * @throws if ad unit is finished.\n     *\n     * @param callback will be called once the ad unit finished\n     */\n    onFinish(callback) {\n        if (typeof callback !== 'function') {\n            throw new TypeError('Expected a callback function');\n        }\n        this[_protected].onFinishCallbacks.push(safeCallback(callback, this.logger));\n    }\n    /**\n     * Register a callback function that will be called if there is an error while running the ad.\n     *\n     * @throws if ad unit is finished.\n     *\n     * @param callback will be called on ad unit error passing the Error instance  and an object with the adUnit and the  {@link VastChain}.\n     */\n    onError(callback) {\n        if (typeof callback !== 'function') {\n            throw new TypeError('Expected a callback function');\n        }\n        this[_protected].onErrorCallbacks.push(safeCallback(callback, this.logger));\n    }\n    /**\n     * @returns true if the ad unit is finished and false otherwise\n     */\n    isFinished() {\n        return this[_protected].finished;\n    }\n    /**\n     * @returns true if the ad unit has started and false otherwise\n     */\n    isStarted() {\n        return this[_protected].started;\n    }\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns Promise that resolves once the unit was resized\n     */\n    async resize(width, height, mode) {\n        var _c, _d, _e, _f;\n        this[_protected].size = {\n            height,\n            viewmode: mode,\n            width\n        };\n        if (this.isStarted() && !this.isFinished() && this.icons) {\n            await ((_d = (_c = this[_protected]).removeIcons) === null || _d === void 0 ? void 0 : _d.call(_c));\n            await ((_f = (_e = this[_protected]).drawIcons) === null || _f === void 0 ? void 0 : _f.call(_e));\n        }\n    }\n}\n_a = _private, _b = _protected;\nexport default VideoAdUnit;\n","const viewmode = (width, height) => {\n    const screen = window.screen;\n    const isFullscreen = width + 100 > screen.width && height + 100 > screen.height;\n    if (isFullscreen) {\n        return 'fullscreen';\n    }\n    if (width < 400) {\n        return 'thumbnail';\n    }\n    return 'normal';\n};\nexport default viewmode;\n","var _a;\nimport { linearEvents, ErrorCode, isVastErrorCode } from '../tracker';\nimport { getSkipOffset } from '../vastSelectors';\nimport findBestMedia from './helpers/media/findBestMedia';\nimport once from './helpers/dom/once';\nimport setupMetricHandlers from './helpers/metrics/setupMetricHandlers';\nimport updateMedia from './helpers/media/updateMedia';\nimport AdUnitError from './helpers/adUnitError';\nimport VideoAdUnit, { _protected } from './VideoAdUnit';\nconst { complete, error: errorEvt, skip } = linearEvents;\nconst _private = Symbol('_private');\n/**\n * This class provides everything necessary to run a Vast ad.\n */\nclass VastAdUnit extends VideoAdUnit {\n    /**\n     * Creates a {@link VastAdUnit}.\n     *\n     * @param vastChain The {@link VastChain} with all the {@link VastResponse}\n     * @param videoAdContainer - container instance to place the ad\n     * @param options Options Map\n     */\n    constructor(vastChain, videoAdContainer, options = {}) {\n        super(vastChain, videoAdContainer, options);\n        this[_a] = {\n            handleMetric: (event, data) => {\n                var _b;\n                switch (event) {\n                    case complete: {\n                        this[_protected].finish();\n                        break;\n                    }\n                    case errorEvt: {\n                        if (data instanceof Error) {\n                            this.error = data;\n                            this.errorCode =\n                                ((_b = this.error) === null || _b === void 0 ? void 0 : _b.code) && isVastErrorCode(this.error.code)\n                                    ? this.error.code\n                                    : ErrorCode.VAST_PROBLEM_DISPLAYING_MEDIA_FILE;\n                        }\n                        this[_protected].onErrorCallbacks.forEach((callback) => callback(this.error, {\n                            adUnit: this,\n                            vastChain: this.vastChain\n                        }));\n                        this[_protected].finish();\n                        break;\n                    }\n                    case skip: {\n                        this.cancel();\n                        break;\n                    }\n                }\n                this.emit(event, {\n                    adUnit: this,\n                    data,\n                    type: event\n                });\n            },\n            drawIcons: async () => {\n                var _b, _c, _d, _e;\n                if (this.isFinished()) {\n                    return;\n                }\n                await ((_c = (_b = this[_protected]).drawIcons) === null || _c === void 0 ? void 0 : _c.call(_b));\n                if (((_e = (_d = this[_protected]).hasPendingIconRedraws) === null || _e === void 0 ? void 0 : _e.call(_d)) && !this.isFinished()) {\n                    const { videoElement } = this.videoAdContainer;\n                    once(videoElement, 'timeupdate', this[_private].drawIcons);\n                }\n            }\n        };\n        /** Ad unit type. Will be `VAST` for VastAdUnit */\n        this.type = 'VAST';\n        const { onFinishCallbacks } = this[_protected];\n        const { handleMetric } = this[_private];\n        this.hooks = options.hooks || {};\n        const removeMetricHandlers = setupMetricHandlers({\n            hooks: this.hooks,\n            pauseOnAdClick: this.pauseOnAdClick,\n            vastChain: this.vastChain,\n            videoAdContainer: this.videoAdContainer\n        }, handleMetric);\n        onFinishCallbacks.push(removeMetricHandlers);\n    }\n    /**\n     * Starts the ad unit.\n     *\n     * @throws if called twice.\n     * @throws if ad unit is finished.\n     */\n    async start() {\n        this[_protected].throwIfFinished();\n        if (this.isStarted()) {\n            throw new AdUnitError('VastAdUnit already started');\n        }\n        const inlineAd = this.vastChain[0].ad;\n        const { videoElement, element } = this.videoAdContainer;\n        const media = inlineAd && findBestMedia(inlineAd, videoElement, element, this.hooks);\n        if (media) {\n            if (this.icons) {\n                await this[_private].drawIcons();\n            }\n            if (media === null || media === void 0 ? void 0 : media.src) {\n                videoElement.src = media.src;\n                this.assetUri = media.src;\n            }\n            videoElement.play();\n        }\n        else {\n            const adUnitError = new AdUnitError(\"Can't find a suitable media to play\");\n            adUnitError.code = ErrorCode.VAST_LINEAR_ASSET_MISMATCH;\n            this[_private].handleMetric(errorEvt, adUnitError);\n        }\n        this[_protected].started = true;\n    }\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    resume() {\n        this.videoAdContainer.videoElement.play();\n    }\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    pause() {\n        this.videoAdContainer.videoElement.pause();\n    }\n    /**\n     * Skips the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    skip() {\n        const inlineAd = this.vastChain[0].ad;\n        const skipoffset = inlineAd && getSkipOffset(inlineAd);\n        const currentTimeMs = this.currentTime() * 1000;\n        if (typeof skipoffset === 'number' && currentTimeMs >= skipoffset) {\n            this[_private].handleMetric(skip);\n        }\n    }\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n    paused() {\n        return this.videoAdContainer.videoElement.paused;\n    }\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param volume must be a value between 0 and 1;\n     */\n    setVolume(volume) {\n        this.videoAdContainer.videoElement.volume = volume;\n    }\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns the volume of the ad unit.\n     */\n    getVolume() {\n        return this.videoAdContainer.videoElement.volume;\n    }\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n    cancel() {\n        this[_protected].throwIfFinished();\n        this.videoAdContainer.videoElement.pause();\n        this[_protected].finish();\n    }\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the duration of the ad unit.\n     */\n    duration() {\n        if (!this.isStarted()) {\n            return 0;\n        }\n        return this.videoAdContainer.videoElement.duration;\n    }\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * @returns the current time of the ad unit.\n     */\n    currentTime() {\n        if (!this.isStarted()) {\n            return 0;\n        }\n        return this.videoAdContainer.videoElement.currentTime;\n    }\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @param width the new width of the ad container.\n     * @param height the new height of the ad container.\n     * @param viewmode fullscreen | normal | thumbnail\n     * @returns Promise that resolves once the unit was resized\n     */\n    async resize(width, height, viewmode) {\n        await super.resize(width, height, viewmode);\n        if (this.isStarted() && !this.isFinished()) {\n            const inlineAd = this.vastChain[0].ad;\n            const { videoElement, element } = this.videoAdContainer;\n            const media = inlineAd && findBestMedia(inlineAd, videoElement, element, this.hooks);\n            if (media && videoElement.src !== media.src) {\n                updateMedia(videoElement, media);\n            }\n        }\n    }\n}\n_a = _private;\nexport default VastAdUnit;\n","const preventManualProgress = (videoElement) => {\n    // IOS video clock is very unreliable and we need a 3 seconds threshold to ensure that the user forwarded/rewound the ad\n    const PROGRESS_THRESHOLD = 3;\n    let previousTime = 0;\n    let skipAttempts = 0;\n    const preventAdSkip = () => {\n        // Ignore ended event if the Ad time was not 'near' the end\n        // and revert time to the previous 'valid' time\n        if (videoElement.duration - previousTime > PROGRESS_THRESHOLD) {\n            // this reduces the video jitter if the IOS skip button is pressed\n            videoElement.pause();\n            // we need to trigger the play to put the video element back in a valid state\n            videoElement.play();\n            videoElement.currentTime = previousTime;\n        }\n    };\n    const preventAdSeek = () => {\n        const currentTime = videoElement.currentTime;\n        const progressDelta = Math.abs(currentTime - previousTime);\n        if (progressDelta > PROGRESS_THRESHOLD) {\n            skipAttempts += 1;\n            if (skipAttempts >= 2) {\n                videoElement.pause();\n            }\n            videoElement.currentTime = previousTime;\n        }\n        else {\n            previousTime = currentTime;\n        }\n    };\n    videoElement.addEventListener('timeupdate', preventAdSeek);\n    videoElement.addEventListener('ended', preventAdSkip);\n    return () => {\n        videoElement.removeEventListener('timeupdate', preventAdSeek);\n        videoElement.removeEventListener('ended', preventAdSkip);\n    };\n};\nexport default preventManualProgress;\n","import once from '../dom/once';\nconst updateMedia = (videoElement, mediaFile) => new Promise((resolve) => {\n    const state = {\n        currentTime: videoElement.currentTime,\n        playing: !videoElement.paused\n    };\n    if (state.playing) {\n        videoElement.pause();\n    }\n    if (mediaFile.src) {\n        videoElement.src = mediaFile.src;\n    }\n    videoElement.load();\n    once(videoElement, 'loadeddata', () => {\n        videoElement.currentTime = state.currentTime;\n        if (state.playing) {\n            videoElement.play();\n        }\n        resolve();\n    });\n});\nexport default updateMedia;\n","export const SUPPORTED_MIMETYPES = [\n    'text/javascript',\n    'text/javascript1.0',\n    'text/javascript1.2',\n    'text/javascript1.4',\n    'text/jscript',\n    'application/javascript',\n    'application/x-javascript',\n    'text/ecmascript',\n    'text/ecmascript1.0',\n    'text/ecmascript1.2',\n    'text/ecmascript1.4',\n    'text/livescript',\n    'application/ecmascript',\n    'application/x-ecmascript'\n];\nconst isSupported = ({ type }) => SUPPORTED_MIMETYPES.some((mimetype) => mimetype === type);\nexport default isSupported;\n","export const handshakeVersion = 'handshakeVersion';\nexport const initAd = 'initAd';\nexport const resizeAd = 'resizeAd';\nexport const startAd = 'startAd';\nexport const stopAd = 'stopAd';\nexport const pauseAd = 'pauseAd';\nexport const resumeAd = 'resumeAd';\nexport const expandAd = 'expandAd';\nexport const skipAd = 'skipAd';\nexport const collapseAd = 'collapseAd';\nexport const getAdLinear = 'getAdLinear';\nexport const getAdWidth = 'getAdWidth';\nexport const getAdHeight = 'getAdHeight';\nexport const getAdExpanded = 'getAdExpanded';\nexport const getAdSkippableState = 'getAdSkippableState';\nexport const getAdRemainingTime = 'getAdRemainingTime';\nexport const getAdDuration = 'getAdDuration';\nexport const getAdVolume = 'getAdVolume';\nexport const getAdCompanions = 'getAdCompanions';\nexport const getAdIcons = 'getAdIcons';\nexport const setAdVolume = 'setAdVolume';\nexport const adLoaded = 'AdLoaded';\nexport const adStarted = 'AdStarted';\nexport const adStopped = 'AdStopped';\nexport const adSkipped = 'AdSkipped';\nexport const adSkippableStateChange = 'AdSkippableStateChange';\nexport const adSizeChange = 'AdSizeChange';\nexport const adLinearChange = 'AdLinearChange';\nexport const adDurationChange = 'AdDurationChange';\nexport const adExpandedChange = 'AdExpandedChange';\nexport const adRemainingTimeChange = 'AdRemainingTimeChange';\nexport const adVolumeChange = 'AdVolumeChange';\nexport const adImpression = 'AdImpression';\nexport const adVideoStart = 'AdVideoStart';\nexport const adVideoFirstQuartile = 'AdVideoFirstQuartile';\nexport const adVideoMidpoint = 'AdVideoMidpoint';\nexport const adVideoThirdQuartile = 'AdVideoThirdQuartile';\nexport const adVideoComplete = 'AdVideoComplete';\nexport const adClickThru = 'AdClickThru';\nexport const adInteraction = 'AdInteraction';\nexport const adUserAcceptInvitation = 'AdUserAcceptInvitation';\nexport const adUserMinimize = 'AdUserMinimize';\nexport const adUserClose = 'AdUserClose';\nexport const adPaused = 'AdPaused';\nexport const adPlaying = 'AdPlaying';\nexport const adLog = 'AdLog';\nexport const adError = 'AdError';\nexport const EVENTS = [\n    adLoaded,\n    adStarted,\n    adStopped,\n    adSkipped,\n    adSkippableStateChange,\n    adSizeChange,\n    adLinearChange,\n    adDurationChange,\n    adExpandedChange,\n    adRemainingTimeChange,\n    adVolumeChange,\n    adImpression,\n    adVideoStart,\n    adVideoFirstQuartile,\n    adVideoMidpoint,\n    adVideoThirdQuartile,\n    adVideoComplete,\n    adClickThru,\n    adInteraction,\n    adUserAcceptInvitation,\n    adUserMinimize,\n    adUserClose,\n    adPaused,\n    adPlaying,\n    adLog,\n    adError\n];\nexport const METHODS = [\n    handshakeVersion,\n    initAd,\n    resizeAd,\n    startAd,\n    stopAd,\n    pauseAd,\n    resumeAd,\n    expandAd,\n    collapseAd,\n    // VPAID 2.0 new methods\n    skipAd\n];\nexport const GETTERS = [\n    getAdLinear,\n    getAdExpanded,\n    getAdRemainingTime,\n    getAdVolume,\n    // VPAID 2.0 new getters\n    getAdWidth,\n    getAdHeight,\n    getAdSkippableState,\n    getAdDuration,\n    getAdCompanions,\n    getAdIcons\n];\nexport const SETTERS = [setAdVolume];\n","const waitFor = (creativeAd, event, timeout) => new Promise((resolve, reject) => {\n    let timeoutId;\n    const handler = () => {\n        if (typeof timeout === 'number') {\n            window.clearTimeout(timeoutId);\n        }\n        creativeAd.unsubscribe(handler, event);\n        resolve();\n    };\n    if (typeof timeout === 'number') {\n        timeoutId = window.setTimeout(() => {\n            creativeAd.unsubscribe(handler, event);\n            reject(new Error(`Timeout waiting for event '${event}'`));\n        }, timeout);\n    }\n    creativeAd.subscribe(handler, event);\n});\nexport default waitFor;\n","import waitFor from './waitFor';\nconst callAndWait = (creativeAd, method, event, ...args) => {\n    const waitPromise = waitFor(creativeAd, event, 5000);\n    const creativeMethod = creativeAd[method];\n    creativeMethod === null || creativeMethod === void 0 ? void 0 : creativeMethod.apply(creativeAd, args);\n    return waitPromise;\n};\nexport default callAndWait;\n","import { handshakeVersion } from './api';\nconst major = (version) => {\n    const parts = version.split('.');\n    return parseInt(parts[0], 10);\n};\nconst isSupported = (supportedVersion, creativeVersion) => {\n    const creativeMajorNum = major(creativeVersion);\n    if (creativeMajorNum < 1) {\n        return false;\n    }\n    return creativeMajorNum <= major(supportedVersion);\n};\nconst handshake = (creativeAd, supportedVersion) => {\n    const creativeVersion = creativeAd[handshakeVersion](supportedVersion);\n    if (!isSupported(supportedVersion, creativeVersion)) {\n        throw new Error(`Creative Version '${creativeVersion}' not supported`);\n    }\n    return creativeVersion;\n};\nexport default handshake;\n","var _a;\nimport { linearEvents, ErrorCode, isVastErrorCode } from '../tracker';\nimport { acceptInvitation, adCollapse } from '../tracker/nonLinearEvents';\nimport { getClickThrough } from '../vastSelectors';\nimport { volumeChanged, adProgress } from './adUnitEvents';\nimport loadCreative from './helpers/vpaid/loadCreative';\nimport { adLoaded, adStarted, adStopped, adPlaying, adPaused, startAd, stopAd, resumeAd, pauseAd, skipAd, setAdVolume, getAdVolume, getAdDuration, resizeAd, adSizeChange, adError, adVideoComplete, adSkipped, EVENTS, adVolumeChange, adImpression, adVideoStart, adVideoFirstQuartile, adVideoMidpoint, adVideoThirdQuartile, adUserAcceptInvitation, adUserMinimize, adUserClose, adDurationChange, adRemainingTimeChange, adClickThru, getAdIcons, getAdRemainingTime } from './helpers/vpaid/api';\nimport waitFor from './helpers/vpaid/waitFor';\nimport callAndWait from './helpers/vpaid/callAndWait';\nimport handshake from './helpers/vpaid/handshake';\nimport initAd from './helpers/vpaid/initAd';\nimport AdUnitError from './helpers/adUnitError';\nimport VideoAdUnit, { _protected } from './VideoAdUnit';\nconst { complete, mute, unmute, skip, start, firstQuartile, pause, resume, impression, midpoint, thirdQuartile, clickThrough, error: errorEvt, closeLinear, creativeView } = linearEvents;\n// NOTE some ads only allow one handler per event and we need to subscribe to the adLoaded to know the creative is loaded.\nconst VPAID_EVENTS = EVENTS.filter((event) => event !== adLoaded);\nconst _private = Symbol('_private');\nconst vpaidGeneralError = (payload) => {\n    const error = payload instanceof Error ? payload : new AdUnitError('VPAID general error');\n    if (!error.code || !isVastErrorCode(error.code)) {\n        error.code = ErrorCode.VPAID_ERROR;\n    }\n    return error;\n};\n/**\n * This class provides everything necessary to run a Vpaid ad.\n */\nclass VpaidAdUnit extends VideoAdUnit {\n    /**\n     * Creates a {@link VpaidAdUnit}.\n     *\n     * @param vastChain The {@link VastChain} with all the {@link VastResponse}\n     * @param videoAdContainer container instance to place the ad\n     * @param options Options Map\n     */\n    constructor(vastChain, videoAdContainer, options = {}) {\n        super(vastChain, videoAdContainer, options);\n        this[_a] = {\n            evtHandler: {\n                [adClickThru]: (url, _id, playerHandles) => {\n                    if (playerHandles) {\n                        this[_private].handleClickThrough(url);\n                    }\n                    this.emit(clickThrough, {\n                        adUnit: this,\n                        type: clickThrough\n                    });\n                },\n                [adDurationChange]: () => {\n                    this.emit(adProgress, {\n                        adUnit: this,\n                        type: adProgress\n                    });\n                },\n                [adError]: (payload) => {\n                    this.error = vpaidGeneralError(payload);\n                    this.errorCode = this.error.code;\n                    this[_protected].onErrorCallbacks.forEach((callback) => callback(this.error, {\n                        adUnit: this,\n                        vastChain: this.vastChain\n                    }));\n                    this[_protected].finish();\n                    this.emit(errorEvt, {\n                        adUnit: this,\n                        type: errorEvt\n                    });\n                },\n                [adImpression]: () => {\n                    // NOTE: some ads forget to trigger the adVideoStart event. :(\n                    if (!this[_private].videoStart) {\n                        this[_private].handleVpaidEvent(adVideoStart);\n                    }\n                    this.emit(impression, {\n                        adUnit: this,\n                        type: impression\n                    });\n                },\n                [adPaused]: () => {\n                    this[_private].paused = true;\n                    this.emit(pause, {\n                        adUnit: this,\n                        type: pause\n                    });\n                },\n                [adPlaying]: () => {\n                    this[_private].paused = false;\n                    this.emit(resume, {\n                        adUnit: this,\n                        type: resume\n                    });\n                },\n                [adRemainingTimeChange]: () => {\n                    this.emit(adProgress, {\n                        adUnit: this,\n                        type: adProgress\n                    });\n                },\n                [adSkipped]: () => {\n                    this.cancel();\n                    this.emit(skip, {\n                        adUnit: this,\n                        type: skip\n                    });\n                },\n                [adStarted]: () => {\n                    this.emit(creativeView, {\n                        adUnit: this,\n                        type: creativeView\n                    });\n                },\n                [adStopped]: () => {\n                    this.emit(adStopped, {\n                        adUnit: this,\n                        type: adStopped\n                    });\n                    this[_protected].finish();\n                },\n                [adUserAcceptInvitation]: () => {\n                    this.emit(acceptInvitation, {\n                        adUnit: this,\n                        type: acceptInvitation\n                    });\n                },\n                [adUserClose]: () => {\n                    this.emit(closeLinear, {\n                        adUnit: this,\n                        type: closeLinear\n                    });\n                    this[_protected].finish();\n                },\n                [adUserMinimize]: () => {\n                    this.emit(adCollapse, {\n                        adUnit: this,\n                        type: adCollapse\n                    });\n                },\n                [adVideoComplete]: () => {\n                    this.emit(complete, {\n                        adUnit: this,\n                        type: complete\n                    });\n                },\n                [adVideoFirstQuartile]: () => {\n                    this.emit(firstQuartile, {\n                        adUnit: this,\n                        type: firstQuartile\n                    });\n                },\n                [adVideoMidpoint]: () => {\n                    this.emit(midpoint, {\n                        adUnit: this,\n                        type: midpoint\n                    });\n                },\n                [adVideoStart]: () => {\n                    if (!this[_private].videoStart) {\n                        this[_private].videoStart = true;\n                        this[_private].paused = false;\n                        this.emit(start, {\n                            adUnit: this,\n                            type: start\n                        });\n                    }\n                },\n                [adVideoThirdQuartile]: () => {\n                    this.emit(thirdQuartile, {\n                        adUnit: this,\n                        type: thirdQuartile\n                    });\n                },\n                [adVolumeChange]: () => {\n                    const volume = this.getVolume();\n                    this.emit(volumeChanged, {\n                        adUnit: this,\n                        type: volumeChanged\n                    });\n                    if (volume === 0 && !this[_private].muted) {\n                        this[_private].muted = true;\n                        this.emit(mute, {\n                            adUnit: this,\n                            type: mute\n                        });\n                    }\n                    if (volume > 0 && this[_private].muted) {\n                        this[_private].muted = false;\n                        this.emit(unmute, {\n                            adUnit: this,\n                            type: unmute\n                        });\n                    }\n                }\n            },\n            handleVpaidEvent: (event, ...args) => {\n                const handler = this[_private].evtHandler[event];\n                if (handler) {\n                    handler(...args);\n                }\n                this.emit(event, {\n                    adUnit: this,\n                    type: event\n                });\n            },\n            handleClickThrough: (url) => {\n                if (this.paused() && this.pauseOnAdClick) {\n                    this.resume();\n                    return;\n                }\n                const inlineAd = this.vastChain[0].ad;\n                const clickThroughUrl = typeof url === 'string' && url.length > 0\n                    ? url\n                    : inlineAd && getClickThrough(inlineAd);\n                if (this.pauseOnAdClick) {\n                    this.pause();\n                }\n                if (clickThroughUrl) {\n                    window.open(clickThroughUrl, '_blank');\n                }\n            },\n            getIcons: () => {\n                var _b;\n                if ((_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[getAdIcons]) {\n                    try {\n                        if (!this.creativeAd[getAdIcons]()) {\n                            delete this.icons;\n                        }\n                    }\n                    catch (error) {\n                        delete this.icons;\n                    }\n                }\n            },\n            drawIcons: async () => {\n                var _b, _c, _d, _e;\n                if (this.isFinished()) {\n                    return;\n                }\n                await ((_c = (_b = this[_protected]).drawIcons) === null || _c === void 0 ? void 0 : _c.call(_b));\n                if (((_e = (_d = this[_protected]).hasPendingIconRedraws) === null || _e === void 0 ? void 0 : _e.call(_d)) && !this.isFinished()) {\n                    setTimeout(this[_private].drawIcons, 500);\n                }\n            },\n            muted: false,\n            paused: true\n        };\n        /** Ad unit type. Will be `VPAID` for VpaidAdUnit */\n        this.type = 'VPAID';\n        this[_private].loadCreativePromise = loadCreative(vastChain, videoAdContainer);\n    }\n    /**\n     * Starts the ad unit.\n     *\n     * @throws if called twice.\n     * @throws if ad unit is finished.\n     */\n    async start() {\n        this[_protected].throwIfFinished();\n        if (this.isStarted()) {\n            throw new Error('VpaidAdUnit already started');\n        }\n        try {\n            this.creativeAd = (await this[_private]\n                .loadCreativePromise);\n            const adLoadedPromise = waitFor(this.creativeAd, adLoaded);\n            for (const creativeEvt of VPAID_EVENTS) {\n                this.creativeAd.subscribe(this[_private].handleVpaidEvent.bind(this, creativeEvt), creativeEvt);\n            }\n            this[_private].getIcons();\n            handshake(this.creativeAd, '2.0');\n            initAd(this.creativeAd, this.videoAdContainer, this.vastChain);\n            await adLoadedPromise;\n            // if the ad timed out while trying to load the videoAdContainer will be destroyed\n            if (!this.videoAdContainer.isDestroyed()) {\n                try {\n                    const { videoElement } = this.videoAdContainer;\n                    if (videoElement.muted) {\n                        this[_private].muted = true;\n                        this.setVolume(0);\n                    }\n                    else {\n                        this.setVolume(videoElement.volume);\n                    }\n                    await callAndWait(this.creativeAd, startAd, adStarted);\n                    if (this.icons) {\n                        await this[_private].drawIcons();\n                    }\n                    this[_protected].started = true;\n                }\n                catch (error) {\n                    this.cancel();\n                }\n            }\n        }\n        catch (error) {\n            this[_private].handleVpaidEvent(adError, error);\n            throw error;\n        }\n    }\n    /**\n     * Resumes a previously paused ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    resume() {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[resumeAd]();\n    }\n    /**\n     * Pauses the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    pause() {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[pauseAd]();\n    }\n    /**\n     * Skip the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     */\n    skip() {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[skipAd]();\n    }\n    /**\n     * Returns true if the ad is paused and false otherwise\n     */\n    paused() {\n        return this.isFinished() || this[_private].paused;\n    }\n    /**\n     * Sets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @param volume must be a value between 0 and 1;\n     */\n    setVolume(volume) {\n        var _b;\n        (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[setAdVolume](volume);\n    }\n    /**\n     * Gets the volume of the ad unit.\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns the volume of the ad unit.\n     */\n    getVolume() {\n        if (!this.creativeAd) {\n            return 0;\n        }\n        return this.creativeAd[getAdVolume]();\n    }\n    /**\n     * Cancels the ad unit.\n     *\n     * @throws if ad unit is finished.\n     */\n    async cancel() {\n        var _b;\n        this[_protected].throwIfFinished();\n        try {\n            const adStoppedPromise = this.creativeAd && waitFor(this.creativeAd, adStopped, 3000);\n            (_b = this.creativeAd) === null || _b === void 0 ? void 0 : _b[stopAd]();\n            await adStoppedPromise;\n        }\n        catch (error) {\n            this[_protected].finish();\n        }\n    }\n    /**\n     * Returns the duration of the ad Creative or 0 if there is no creative.\n     *\n     * Note: if the user has engaged with the ad, the duration becomes unknown and it will return 0;\n     *\n     * @returns the duration of the ad unit.\n     */\n    duration() {\n        if (!this.creativeAd) {\n            return 0;\n        }\n        const duration = this.creativeAd[getAdDuration]();\n        if (duration < 0) {\n            return 0;\n        }\n        return duration;\n    }\n    /**\n     * Returns the current time of the ad Creative or 0 if there is no creative.\n     *\n     * Note: if the user has engaged with the ad, the currentTime becomes unknown and it will return 0;\n     *\n     * @returns the current time of the ad unit.\n     */\n    currentTime() {\n        if (!this.creativeAd) {\n            return 0;\n        }\n        const remainingTime = this.creativeAd[getAdRemainingTime]();\n        if (remainingTime < 0) {\n            return 0;\n        }\n        return this.duration() - remainingTime;\n    }\n    /**\n     * This method resizes the ad unit to fit the available space in the passed {@link VideoAdContainer}\n     *\n     * @throws if ad unit is not started.\n     * @throws if ad unit is finished.\n     *\n     * @returns Promise that resolves once the unit was resized\n     */\n    async resize(width, height, viewmode) {\n        await super.resize(width, height, viewmode);\n        if (!this.creativeAd) {\n            return;\n        }\n        if (this.isStarted() && !this.isFinished()) {\n            const slot = this.videoAdContainer.slotElement;\n            if (slot) {\n                slot.style.height = `${height}px`;\n                slot.style.width = `${width}px`;\n            }\n        }\n        return callAndWait(this.creativeAd, resizeAd, adSizeChange, width, height, viewmode);\n    }\n}\n_a = _private;\nexport default VpaidAdUnit;\n","import { getInteractiveFiles } from '../../../vastSelectors';\nimport isSupported from './isSupported';\nconst loadCreative = async (vastChain, videoAdContainer) => {\n    const creative = ((vastChain[0].ad && getInteractiveFiles(vastChain[0].ad)) ||\n        []).filter(isSupported)[0];\n    if (!creative || !creative.src) {\n        throw new TypeError('VastChain does not contain a supported vpaid creative');\n    }\n    const { src, type } = creative;\n    await videoAdContainer.addScript(src, { type });\n    const context = videoAdContainer.executionContext;\n    return context.getVPAIDAd();\n};\nexport default loadCreative;\n","import { getCreativeData } from '../../../vastSelectors';\nimport viewmode from './viewmode';\nconst initAd = (creativeAd, videoAdContainer, vastChain) => {\n    const { width, height } = videoAdContainer.element.getBoundingClientRect();\n    const mode = viewmode(width, height);\n    const desiredBitrate = -1;\n    const creativeData = getCreativeData(vastChain[0].XML);\n    videoAdContainer.addSlot(width, height);\n    const environmentVars = {\n        slot: videoAdContainer.slotElement,\n        videoSlot: videoAdContainer.videoElement,\n        videoSlotCanAutoPlay: videoAdContainer.isOriginalVideoElement\n    };\n    creativeAd.initAd(width, height, mode, desiredBitrate, creativeData, environmentVars);\n};\nexport default initAd;\n","import { linearEvents, nonLinearEvents, trackLinearEvent, trackNonLinearEvent } from '../tracker';\nimport VastAdUnit from './VastAdUnit';\nimport VpaidAdUnit from './VpaidAdUnit';\nfunction createVideoAdUnit(vastChain, videoAdContainer, options) {\n    const { tracker, type } = options;\n    const adUnit = type === 'VPAID'\n        ? new VpaidAdUnit(vastChain, videoAdContainer, options)\n        : new VastAdUnit(vastChain, videoAdContainer, options);\n    Object.values(linearEvents).forEach((linearEvent) => adUnit.on(linearEvent, (event) => {\n        const { type: evtType, data } = event;\n        const payload = {\n            data,\n            errorCode: adUnit.errorCode,\n            tracker\n        };\n        trackLinearEvent(evtType, vastChain, payload);\n    }));\n    Object.values(nonLinearEvents).forEach((nonLinearEvent) => adUnit.on(nonLinearEvent, (event) => {\n        const payload = {\n            data: event.data,\n            tracker\n        };\n        trackNonLinearEvent(event.type, vastChain, payload);\n    }));\n    return adUnit;\n}\nexport default createVideoAdUnit;\n","class VastError extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'VastError';\n        Object.setPrototypeOf(this, VastError.prototype);\n    }\n}\nexport default VastError;\n","import { createVideoAdUnit } from '../../adUnit';\nimport { VideoAdContainer } from '../../adContainer';\nimport { ErrorCode } from '../../tracker';\nimport { getInteractiveFiles, getMediaFiles } from '../../vastSelectors';\nimport canPlay from '../../adUnit/helpers/media/canPlay';\nimport { start, closeLinear } from '../../tracker/linearEvents';\nimport { adStopped, adUserClose } from '../../adUnit/helpers/vpaid/api';\nimport VastError from '../../vastRequest/helpers/vastError';\nconst validate = (vastChain, videoAdContainer) => {\n    if (!Array.isArray(vastChain) || vastChain.length === 0) {\n        throw new TypeError('Invalid vastChain');\n    }\n    if (!(videoAdContainer instanceof VideoAdContainer)) {\n        throw new TypeError('Invalid VideoAdContainer');\n    }\n};\nconst hasVpaidCreative = (ad) => Boolean(getInteractiveFiles(ad));\nconst hasVastCreative = (ad, videoElement) => {\n    const mediaFiles = getMediaFiles(ad);\n    if (mediaFiles) {\n        return mediaFiles.some((mediaFile) => canPlay(videoElement, mediaFile));\n    }\n    return false;\n};\nconst startAdUnit = (adUnit, { onAdReady }) => new Promise((resolve, reject) => {\n    const createRejectHandler = (event) => () => reject(new Error(`Ad unit start rejected due to event '${event}'`));\n    adUnit.onError(reject);\n    adUnit.on(start, () => resolve(adUnit));\n    adUnit.on(adUserClose, createRejectHandler(adUserClose));\n    adUnit.on(closeLinear, createRejectHandler(closeLinear));\n    adUnit.on(adStopped, createRejectHandler(adStopped));\n    onAdReady(adUnit);\n    adUnit.start();\n});\nconst tryToStartVpaidAd = (vastChain, videoAdContainer, options) => {\n    const inlineAd = vastChain[0].ad;\n    if (!inlineAd || !hasVpaidCreative(inlineAd)) {\n        const error = new VastError('No valid creative found in the passed VAST chain');\n        error.code = ErrorCode.VAST_MEDIA_FILE_NOT_FOUND;\n        throw error;\n    }\n    const adUnit = createVideoAdUnit(vastChain, videoAdContainer, Object.assign(Object.assign({}, options), { type: 'VPAID' }));\n    return startAdUnit(adUnit, options);\n};\nconst startVastAd = (vastChain, videoAdContainer, options) => {\n    const adUnit = createVideoAdUnit(vastChain, videoAdContainer, Object.assign(Object.assign({}, options), { type: 'VAST' }));\n    return startAdUnit(adUnit, options);\n};\nconst startVideoAd = async (vastChain, videoAdContainer, options) => {\n    validate(vastChain, videoAdContainer);\n    try {\n        return await tryToStartVpaidAd(vastChain, videoAdContainer, options);\n    }\n    catch (error) {\n        const inlineAd = vastChain[0].ad;\n        if (inlineAd && hasVastCreative(inlineAd, videoAdContainer.videoElement)) {\n            return startVastAd(vastChain, videoAdContainer, options);\n        }\n        throw error;\n    }\n};\nexport default startVideoAd;\n","import { trackError, ErrorCode } from '../tracker';\nimport { createVideoAdContainer } from '../adContainer';\nimport startVideoAd from './helpers/startVideoAd';\n/**\n * Will try to start video ad in the passed {@link VastChain} and return the started VideoAdUnit.\n * If there is an error starting the ad or it times out (by throw I mean that it will reject promise with the error).\n *\n * @param vastChain The {@link VastChain} with all the {@link VastResponse}s.\n * @param placeholder Element that will contain the video ad.\n * @param options - Options Map.\n * @returns The video ad unit.\n */\nconst run = async (vastChain, placeholder, options) => {\n    let videoAdContainer;\n    try {\n        const { timeout } = options;\n        videoAdContainer = createVideoAdContainer(placeholder, options.videoElement);\n        let adUnitPromise = startVideoAd(vastChain, videoAdContainer, options);\n        if (typeof timeout === 'number') {\n            let timedOut = false;\n            let timeoutId;\n            const timeoutPromise = new Promise((_resolve, reject) => {\n                timeoutId = window.setTimeout(() => {\n                    const { tracker } = options;\n                    trackError(vastChain, {\n                        errorCode: ErrorCode.VAST_MEDIA_LOAD_TIMEOUT,\n                        tracker\n                    });\n                    timedOut = true;\n                    reject(new Error('Timeout while starting the ad'));\n                }, options.timeout);\n            });\n            adUnitPromise = Promise.race([\n                adUnitPromise.then((newAdUnit) => {\n                    if (timedOut) {\n                        if (newAdUnit.isStarted()) {\n                            newAdUnit.cancel();\n                        }\n                    }\n                    else {\n                        clearTimeout(timeoutId);\n                    }\n                    return newAdUnit;\n                }),\n                timeoutPromise\n            ]);\n        }\n        const adUnit = await adUnitPromise;\n        adUnit.onFinish(() => {\n            videoAdContainer === null || videoAdContainer === void 0 ? void 0 : videoAdContainer.destroy();\n        });\n        return adUnit;\n    }\n    catch (error) {\n        videoAdContainer === null || videoAdContainer === void 0 ? void 0 : videoAdContainer.destroy();\n        throw error;\n    }\n};\nexport default run;\n","import VideoAdContainer from './VideoAdContainer';\n/**\n * VideoAdContainer factory method. Returns a VideoAdContainer instance that will contain the video ad.\n *\n * @ignore\n * @param placeholder Placeholder element that will contain the video ad.\n * @param videoElement Optional videoElement that will be used to play the ad.\n *\n * @returns Returns a `VideoAdContainer` instance.\n */\nconst createVideoAdContainer = (placeholder, videoElement) => {\n    if (!placeholder) {\n        throw new TypeError('placeholder is required');\n    }\n    return new VideoAdContainer(placeholder, videoElement);\n};\nexport default createVideoAdContainer;\n","class FetchError extends Error {\n    constructor(message) {\n        super(message);\n        this.name = 'FetchError';\n        Object.setPrototypeOf(this, FetchError.prototype);\n    }\n}\nconst fetch = async (endpoint, options = {}) => {\n    const defaults = {\n        credentials: 'include'\n    };\n    const fetchOptions = Object.assign({}, defaults, options);\n    const response = await window.fetch(endpoint, fetchOptions);\n    if (response.status >= 400) {\n        const error = new FetchError(response.statusText);\n        error.response = response;\n        throw error;\n    }\n    return response;\n};\nexport default fetch;\n","const requested = Symbol('requested');\nexport const markAdAsRequested = (ad) => {\n    ad[requested] = true;\n};\nexport const unmarkAdAsRequested = (ad) => {\n    delete ad[requested];\n};\nexport const hasAdBeenRequested = (ad) => Boolean(ad[requested]);\n","import { parseXml } from '../xml';\nimport { isVastErrorCode, ErrorCode } from '../tracker';\nimport { getWrapperOptions, getFirstAd, getVASTAdTagURI, hasAdPod, isInline, isWrapper } from '../vastSelectors';\nimport fetch from './helpers/fetch';\nimport VastError from './helpers/vastError';\nimport { markAdAsRequested } from './helpers/adUtils';\nconst validateChain = (vastChain, { wrapperLimit = 5 }) => {\n    if (vastChain.length > wrapperLimit) {\n        const error = new VastError('Wrapper Limit reached');\n        error.code = ErrorCode.VAST_TOO_MANY_REDIRECTS;\n        throw error;\n    }\n};\nconst fetchAdXML = async (adTag, options) => {\n    var _a;\n    let response;\n    try {\n        response = await fetch(adTag, options);\n        const XML = await response.text();\n        return { response, XML };\n    }\n    catch (error) {\n        error.code = ErrorCode.VAST_NONLINEAR_LOADING_FAILED;\n        (_a = error.response) !== null && _a !== void 0 ? _a : (error.response = response);\n        throw error;\n    }\n};\nconst parseVastXml = (xml) => {\n    try {\n        return parseXml(xml);\n    }\n    catch (error) {\n        error.code = ErrorCode.VAST_XML_PARSING_ERROR;\n        throw error;\n    }\n};\nconst getAd = (parsedXML) => {\n    try {\n        const ad = getFirstAd(parsedXML);\n        if (ad) {\n            markAdAsRequested(ad);\n            return ad;\n        }\n        throw new Error('No Ad');\n    }\n    catch (error) {\n        error.code = ErrorCode.VAST_NO_ADS_AFTER_WRAPPER;\n        throw error;\n    }\n};\nconst validateResponse = ({ ad, parsedXML }, { allowMultipleAds = true, followAdditionalWrappers = true }) => {\n    if (!isWrapper(ad) && !isInline(ad)) {\n        const error = new VastError('Invalid VAST, ad contains neither Wrapper nor Inline');\n        error.code = ErrorCode.VAST_SCHEMA_VALIDATION_ERROR;\n        throw error;\n    }\n    if (hasAdPod(parsedXML) && !allowMultipleAds) {\n        const error = new VastError('Multiple ads are not allowed');\n        error.code = ErrorCode.VAST_UNEXPECTED_MEDIA_FILE;\n        throw error;\n    }\n    if (isWrapper(ad) && !followAdditionalWrappers) {\n        const error = new VastError('To follow additional wrappers is not allowed');\n        error.code = ErrorCode.VAST_UNEXPECTED_AD_TYPE;\n        throw error;\n    }\n};\nconst getOptions = (vastChain, options) => {\n    const parentAd = vastChain[0];\n    const parentAdIsWrapper = Boolean(parentAd) && parentAd.ad && isWrapper(parentAd.ad);\n    const wrapperOptions = parentAdIsWrapper && parentAd.ad ? getWrapperOptions(parentAd.ad) : {};\n    return Object.assign(Object.assign({}, wrapperOptions), options);\n};\n/**\n * Request the ad using the passed ad tag and returns an array with the {@link VastResponse} needed to get an inline ad.\n *\n * @param adTag The VAST ad tag request url.\n * @param options Options Map. The allowed properties are:\n * @param vastChain Optional vastChain with the previous VAST responses.\n * @returns Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nconst requestAd = async (adTag, options, vastChain = []) => {\n    var _a;\n    const vastAdResponse = {\n        requestTag: adTag\n    };\n    let epoch;\n    let timeout;\n    try {\n        const resultOptions = getOptions(vastChain, options);\n        validateChain(vastChain, resultOptions);\n        let fetchPromise = fetchAdXML(adTag, resultOptions);\n        if (typeof resultOptions.timeout === 'number') {\n            timeout = resultOptions.timeout;\n            epoch = Date.now();\n            fetchPromise = Promise.race([\n                fetchPromise,\n                new Promise((_resolve, reject) => {\n                    setTimeout(() => {\n                        const error = new VastError('RequestAd timeout');\n                        error.code = ErrorCode.VAST_LOAD_TIMEOUT;\n                        reject(error);\n                    }, timeout);\n                })\n            ]);\n        }\n        const { response, XML } = await fetchPromise;\n        vastAdResponse.response = response;\n        vastAdResponse.XML = XML;\n        vastAdResponse.parsedXML = parseVastXml(vastAdResponse.XML);\n        vastAdResponse.ad = getAd(vastAdResponse.parsedXML);\n        validateResponse(vastAdResponse, resultOptions);\n        if (isWrapper(vastAdResponse.ad)) {\n            if (epoch && timeout) {\n                timeout -= Date.now() - epoch;\n            }\n            return requestAd(getVASTAdTagURI(vastAdResponse.ad), Object.assign(Object.assign({}, resultOptions), { timeout }), [vastAdResponse, ...vastChain]);\n        }\n        return [vastAdResponse, ...vastChain];\n    }\n    catch (error) {\n        /* istanbul ignore if */\n        if (!isVastErrorCode(error.code)) {\n            error.code = ErrorCode.UNKNOWN_ERROR;\n        }\n        vastAdResponse.errorCode = error.code;\n        vastAdResponse.error = error;\n        (_a = vastAdResponse.response) !== null && _a !== void 0 ? _a : (vastAdResponse.response = error.response);\n        return [vastAdResponse, ...vastChain];\n    }\n};\nexport default requestAd;\n","import saneError from 'sane-domparser-error';\nimport xmlToJson from './xmlToJson';\nconst xml2js = (parser, xmlText) => {\n    const xmlDom = parser.parseFromString(xmlText, 'application/xml');\n    saneError.failOnParseError(xmlDom);\n    return xmlToJson(xmlDom);\n};\nexport default xml2js;\n","import { getVASTAdTagURI, isWrapper } from '../vastSelectors';\nimport requestAd from './requestAd';\nimport getNextAd from './helpers/getNextAd';\nimport { markAdAsRequested } from './helpers/adUtils';\nconst validateChain = (vastChain) => {\n    if (!Array.isArray(vastChain)) {\n        throw new TypeError('Invalid VAST chain');\n    }\n    if (vastChain.length === 0) {\n        throw new Error('No next ad to request');\n    }\n};\n/**\n * Requests the next ad in the VAST Chain.\n *\n * @param vastChain Array of {@link VastResponse}.\n * @param options Options Map. The allowed properties are:\n * @returns Returns a Promise that will resolve with a VastChain with the newest VAST response at the beginning of the array.\n * If the {@link VastChain} had an error. The first VAST response of the array will contain an error and an errorCode entry.\n */\nconst requestNextAd = (vastChain, options) => {\n    validateChain(vastChain);\n    const vastResponse = vastChain[0];\n    const nextAd = getNextAd(vastResponse, options);\n    if (nextAd) {\n        const newVastResponse = Object.assign({}, vastResponse, {\n            ad: nextAd\n        });\n        const newVastChain = [newVastResponse, ...vastChain.slice(1)];\n        markAdAsRequested(nextAd);\n        if (isWrapper(nextAd)) {\n            return requestAd(getVASTAdTagURI(nextAd), options, newVastChain);\n        }\n        return Promise.resolve(newVastChain);\n    }\n    return requestNextAd(vastChain.slice(1), options);\n};\nexport default requestNextAd;\n","import { hasAdPod, getAds, getPodAdSequence, isPodAd } from '../../vastSelectors';\nimport { hasAdBeenRequested } from './adUtils';\nconst getNextPod = (currentPod, ads) => {\n    const nextPodSequence = (getPodAdSequence(currentPod) || 0) + 1;\n    return ads.find((ad) => getPodAdSequence(ad) === nextPodSequence);\n};\nconst getNextAd = ({ ad, parsedXML }, { fallbackOnNoAd = true, useAdBuffet = false }) => {\n    const ads = getAds(parsedXML);\n    const availableAds = ads.filter((adDefinition) => !hasAdBeenRequested(adDefinition));\n    let nextAd;\n    if (hasAdPod(parsedXML)) {\n        if (useAdBuffet) {\n            nextAd = availableAds.filter((adDefinition) => !isPodAd(adDefinition))[0];\n        }\n        if (ad && !nextAd) {\n            nextAd = getNextPod(ad, availableAds);\n        }\n    }\n    else if (availableAds.length > 0 && fallbackOnNoAd) {\n        nextAd = availableAds[0];\n    }\n    return nextAd;\n};\nexport default getNextAd;\n","var __rest = (this && this.__rest) || function (s, e) {\n    var t = {};\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\n        t[p] = s[p];\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\n                t[p[i]] = s[p[i]];\n        }\n    return t;\n};\nimport { trackError, isVastErrorCode, ErrorCode } from '../tracker';\nimport { requestAd, requestNextAd } from '../vastRequest';\nimport VastError from '../vastRequest/helpers/vastError';\nimport { getInteractiveFiles } from '../vastSelectors';\nimport isIOS from '../utils/isIOS';\nimport run from './run';\nconst isVpaid = (vastChain) => Boolean(vastChain[0].ad && getInteractiveFiles(vastChain[0].ad));\nconst validateVastChain = (vastChain, options) => {\n    var _a;\n    if (!vastChain || vastChain.length === 0) {\n        throw new Error('Invalid VastChain');\n    }\n    const lastVastResponse = vastChain[0];\n    if (!options.vpaidEnabled && isVpaid(vastChain)) {\n        const error = new VastError('VPAID ads are not supported by the current player');\n        error.code = ErrorCode.VAST_UNEXPECTED_AD_TYPE;\n        lastVastResponse.errorCode = ErrorCode.VAST_UNEXPECTED_AD_TYPE;\n        lastVastResponse.error = error;\n    }\n    if (lastVastResponse.error) {\n        throw lastVastResponse.error;\n    }\n    if (typeof ((_a = options.hooks) === null || _a === void 0 ? void 0 : _a.validateVastResponse) === 'function') {\n        options.hooks.validateVastResponse(vastChain);\n    }\n};\nconst callbackHandler = (callback) => (...args) => {\n    if (typeof callback === 'function') {\n        callback(...args);\n    }\n};\nconst transformVastResponse = (vastChain, { hooks }) => {\n    if (typeof (hooks === null || hooks === void 0 ? void 0 : hooks.transformVastResponse) === 'function') {\n        return hooks.transformVastResponse(vastChain);\n    }\n    return vastChain;\n};\nconst handleVastError = (error, vastChain, tracker) => {\n    var _a;\n    let errorCode = ((_a = vastChain === null || vastChain === void 0 ? void 0 : vastChain[0]) === null || _a === void 0 ? void 0 : _a.errorCode) || (error === null || error === void 0 ? void 0 : error.code);\n    if (vastChain && errorCode) {\n        if (!isVastErrorCode(errorCode)) {\n            errorCode = ErrorCode.UNKNOWN_ERROR;\n        }\n        trackError(vastChain, {\n            errorCode,\n            tracker\n        });\n    }\n};\nconst waterfall = async (fetchVastChain, placeholder, _a, isCanceled) => {\n    var options = __rest(_a, []);\n    let vastChain;\n    let runEpoch;\n    let adUnit;\n    const { onAdStart, onError, onRunFinish } = options;\n    try {\n        if (typeof options.timeout === 'number') {\n            runEpoch = Date.now();\n        }\n        vastChain = await fetchVastChain();\n        if (isCanceled()) {\n            onRunFinish();\n            return;\n        }\n        if (options.timeout && runEpoch) {\n            const newEpoch = Date.now();\n            options.timeout -= newEpoch - runEpoch;\n            runEpoch = newEpoch;\n        }\n        validateVastChain(vastChain, options);\n        adUnit = await run(transformVastResponse(vastChain, options), placeholder, Object.assign({}, options));\n        if (isCanceled()) {\n            adUnit.cancel();\n            onRunFinish();\n            return;\n        }\n        adUnit.onError(onError);\n        adUnit.onFinish(onRunFinish);\n        onAdStart(adUnit);\n    }\n    catch (error) {\n        handleVastError(error, vastChain, options.tracker);\n        onError(error, {\n            adUnit,\n            vastChain\n        });\n        if (!vastChain || isCanceled()) {\n            onRunFinish();\n            return;\n        }\n        if (options.timeout && runEpoch) {\n            options.timeout -= Date.now() - runEpoch;\n        }\n        if (runEpoch && options.timeout && options.timeout <= 0) {\n            onRunFinish();\n            return;\n        }\n        waterfall(() => requestNextAd(vastChain, options), placeholder, Object.assign({}, options), isCanceled);\n    }\n};\n/**\n * Will try to start one of the ads returned by the `adTag`. It will keep trying until it times out or it runs out of ads.\n *\n * @param adTag The VAST ad tag request url.\n * @param placeholder placeholder element that will contain the video ad.\n * @param options Options Map\n * @returns CancelFunction function. If called it will cancel the ad run. {@link runWaterfall~onRunFinish} will still be called;\n */\nconst runWaterfall = (adTag, placeholder, options) => {\n    let canceled = false;\n    let adUnit;\n    const isCanceled = () => canceled;\n    const onAdStartHandler = callbackHandler(options.onAdStart);\n    const onAdStart = (newAdUnit) => {\n        adUnit = newAdUnit;\n        onAdStartHandler(adUnit);\n    };\n    const resultOptions = Object.assign(Object.assign({ vpaidEnabled: true }, options), { onAdReady: callbackHandler(options.onAdReady), onAdStart, onError: callbackHandler(options.onError), onRunFinish: callbackHandler(options.onRunFinish) });\n    // NOTE: It seems that if the video doesn't load synchronously inside a touchend or click event handler, the user gesture breaks on iOS and it won't allow a play.\n    if (options.videoElement && options.videoElement.paused && isIOS()) {\n        options.videoElement.load();\n    }\n    waterfall(() => requestAd(adTag, resultOptions), placeholder, resultOptions, isCanceled);\n    return () => {\n        canceled = true;\n        if (adUnit && !adUnit.isFinished()) {\n            adUnit.cancel();\n        }\n    };\n};\nexport default runWaterfall;\n","const isIOS = () => /iPad|iPhone|iPod/.test(navigator.userAgent) && !window.MSStream;\nexport default isIOS;\n","import { runWaterfall } from '../src';\nimport './styles.css';\ndocument.addEventListener('DOMContentLoaded', () => {\n    const textArea = document.querySelector('#adTag');\n    const testBtn = document.querySelector('.vast-test-btn');\n    const videoElement = document.querySelector('.vast-media video');\n    const videoAdContainer = document.querySelector('.video-ad-container');\n    let adUnit;\n    const onAdReady = (newAdUnit) => {\n        adUnit = newAdUnit;\n        console.log('### onAdReady', adUnit);\n        const eventHandler = (event) => {\n            console.log(`### ${event.type}`, event.adUnit);\n        };\n        [\n            'pause',\n            'resume',\n            'finish',\n            'impression',\n            'start',\n            'skip',\n            'firstQuartile',\n            'midpoint',\n            'thirdQuartile',\n            'complete'\n        ].forEach((eventType) => {\n            adUnit.on(eventType, eventHandler);\n        });\n    };\n    const requestAdRun = () => {\n        const adTag = textArea.value;\n        const src = videoElement.src;\n        const resumeContent = () => {\n            videoElement.play();\n            videoElement.removeEventListener('contentloadedmetadata', resumeContent);\n            videoElement.removeEventListener('canplay', resumeContent);\n        };\n        const onError = (error) => {\n            console.log('### onError', error);\n        };\n        const onRunFinish = () => {\n            console.log('### onRunFinish');\n            videoAdContainer.classList.remove('active');\n            if (videoElement.src === src) {\n                videoElement.play();\n            }\n            else {\n                videoElement.addEventListener('contentloadedmetadata', resumeContent);\n                videoElement.addEventListener('canplay', resumeContent);\n                videoElement.src = src;\n                videoElement.load();\n            }\n        };\n        videoAdContainer.classList.add('active');\n        videoElement.pause();\n        videoElement.currentTime = 0;\n        console.log('### adTag', adTag);\n        runWaterfall(adTag, videoAdContainer, {\n            onAdReady,\n            onError,\n            onRunFinish,\n            timeout: 15000,\n            videoElement,\n            credentials: 'omit'\n        });\n    };\n    textArea.addEventListener('change', () => {\n        const adTag = textArea.value;\n        if (adTag) {\n            testBtn.classList.add('active');\n            testBtn.addEventListener('click', requestAdRun);\n        }\n        else {\n            testBtn.classList.remove('active');\n            testBtn.removeEventListener('click', requestAdRun);\n        }\n    });\n});\n"],"names":["root","factory","exports","module","define","amd","a","i","self","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","parseInt","freeGlobal","g","Object","freeSelf","Function","objectToString","prototype","toString","nativeMax","Math","max","nativeMin","min","now","Date","isObject","value","type","toNumber","isObjectLike","call","isSymbol","other","valueOf","replace","isBinary","test","slice","func","wait","options","lastArgs","lastThis","maxWait","result","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","TypeError","invokeFunc","time","args","thisArg","undefined","apply","shouldInvoke","timeSinceLastCall","timerExpired","trailingEdge","setTimeout","remainingWait","debounced","isInvoking","arguments","this","leadingEdge","cancel","clearTimeout","flush","errorMessagePatterns","RegExp","failOnParseError","doc","errorMessage","Error","parseError","documentElement","tagName","namespaceURI","childNodes","length","nodeName","getParseError","errorNode","node","s","match","content","XMLSerializer","Array","map","serializeToString","join","exec","extractParseError","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","n","getter","__esModule","d","definition","key","o","defineProperty","enumerable","get","globalThis","e","window","obj","prop","hasOwnProperty","r","Symbol","toStringTag","ErrorCode","isVastErrorCode","code","values","includes","complete","clickThrough","error","firstQuartile","impression","viewable","notViewable","viewUndetermined","midpoint","mute","pause","playerCollapse","exitFullscreen","playerExpand","fullscreen","progress","resume","rewind","skip","start","thirdQuartile","unmute","iconClick","iconView","closeLinear","creativeView","otherAdInteraction","timeSpentViewing","acceptInvitation","adCollapse","NodeType","close","xmlToJson","nodeType","ELEMENT","TEXT","DOCUMENT","getNodeType","element","Element","attributes","fromEntries","from","attribute","_a","nodeValue","getNodeAttributes","name","toLowerCase","Text","CDATASection","text","trim","getNodeText","children","_b","hasChildNodes","filter","childNode","elements","childElement","push","getNodeChildren","getChildren","childName","find","toUpperCase","getAll","childrenName","filterChildrenByName","firstChild","getAttributes","attributeName","parser","DOMParser","durationStr","durationRegex","durationInMs","hourStr","minStr","secStr","isNaN","offset","isPercentage","hasLinear","creative","ad","adTypeElement","creativesElement","getTrackingEvent","trackingEventElement","event","uri","eventName","creativeElement","linearElement","trackingEventsElement","trackingEventElements","trackingEvents","filteredEvents","formatSize","size","formatPosition","position","linearCreativeElement","iconsElement","iconElements","iconElement","assign","duration","height","program","pxratio","width","xPosition","yPosition","getIconAttributes","staticResourceElement","htmlResourceElement","iFrameResourceElement","staticResource","htmlResource","iFrameResource","getIconResource","iconTrackingElements","iconViewTrackingElement","Boolean","iconViewTracking","getIconViewTracking","iconClicksElement","iconClickThroughElement","iconClickTrackingElements","iconClickTrackingElement","iconClickThrough","iconClickTracking","getIconClicks","getBooleanValue","val","compareBySequence","itemA","itemB","itemASequenceString","itemBSequenceString","itemASequence","itemBSequence","getAds","parsedVast","vastElement","ads","getPodAdSequence","sequenceString","sequence","isPodAd","hasAdPod","isArray","getVASTAdTagURI","wrapperElement","vastAdTagURIElement","getViewable","viewableImpression","viewableElements","universalAdIdElement","universalAdId","mediaFilesElement","mediaFileElements","mediaFileElement","src","apiFramework","bitrate","codec","delivery","id","maintainAspectRatio","maxBitrate","minBitrate","scalable","interactiveFiles","interactiveElements","interactiveElement","getInteractiveCreativeFiles","mediaFiles","getVideoClicksElement","videoClicksElement","clickThroughElement","getSkipOffset","skipoffset","urlMacro","data","img","Image","macro","parsedMacro","macroData","upperKeysMap","keys","forEach","toUpperKeys","CACHEBUSTING","round","random","TIMESTAMP","toISOString","encodeURIComponent","vastChain","errorCode","tracker","parsedXML","errorURIs","errors","getAdErrorURI","getVastErrorURI","trackingEventSelector","eventSelector","selectors","trackingURIs","getElements","linearTrackingEventSelector","linearTrackers","clickTrackingElements","customClickElements","_vastChain","trackUrl","impressions","notViewableElements","progressUri","viewUndeterminedElements","nonLinearAdsElement","iframeElement","contentDocument","contentWindow","document","supported","createElement","createBaseIframe","iframe","setAttribute","style","margin","padding","border","placeholder","Promise","resolve","reject","targetOrigin","iframeContent","location","origin","protocol","hostname","port","appendChild","write","removeChild","srcdoc","handleMessage","removeEventListener","addEventListener","nextId","namespace","count","constructor","videoElement","destroyed","readyPromise","adContainer","classList","add","isOriginalVideoElement","video","addScript","isDestroyed","executionContext","body","async","defer","script","scriptPlaceholder","onerror","URIError","onload","currentScript","parentNode","head","addSlot","slotElement","slot","cursor","left","top","destroy","removePromise","zIndex","mimeMap","avi","flv","m3u8","m4v","mov","mp4","mpd","ogv","ts","webm","wmv","mediaFile","canPlayType","ext","getRectParams","rect","Number","aspectRatio","floor","getMediaByDefaultBestFit","screenRect","screenParams","sort","mediaFileA","mediaFileB","mediaFileAParams","mediaFileBParams","widthDeltaA","abs","widthDeltaB","inlineAd","container","getMediaFile","getBoundingClientRect","supportedMediaFiles","listener","handler","callback","logger","createDefaultSkipControl","skipBtn","innerHTML","bottom","right","volumeChanged","finish","adProgress","percentageProgress","currentTime","isCompleted","isMuted","muted","volume","num","digits","formattedNum","String","hours","minutes","seconds","ms","secondsToMilliseconds","isValid","offsetIsValid","parseFloat","uriIsValid","offsetToMs","createDefaultClickControl","anchor","clickThroughUrl","pauseOnAdClick","createClickControl","isVirtual","contains","HTMLAnchorElement","href","target","onclick","stopPropagation","paused","preventDefault","play","errorHandler","mediaError","VAST_PROBLEM_DISPLAYING_MEDIA_FILE","fullscreenEvtNames","fullscreenOn","fullscreenchangeHandler","fullscreenElement","webkitFullscreenElement","mozFullScreenElement","msFullscreenElement","started","impressionHandler","playHandler","pauseHandler","progressEvents","playedMs","previousCurrentTime","pendingEvents","progressHandler","delta","stillPending","toCall","reduce","accumulator","contentplayhead","timeupdateHandler","videoAdContainer","createSkipControl","skipControl","skipHandler","currentTimeMs","passFirstQuartile","passMidPoint","passThirdQuartile","completed","events","isFired","isPassFirstQuartile","isPassMidPoint","isPassThirdQuartile","timeUpdateHandler","endedHandler","wasMuted","volumechangeHandler","hooks","accumulated","stopHandlersFns","disconnect","AdUnitError","message","super","setPrototypeOf","MutationObserver","WebKitMutationObserver","MozMutationObserver","noop","sizeMutationAttrs","mutationHandlers","observerKey","resizeHandlers","resizeElement","threshold","validate","makeSizeId","clientHeight","clientWidth","lastSize","checkElementHandler","currentSize","stopObservingMutations","execHandlers","observer","mutations","index","observe","characterData","childList","createResizeMO","_c","onMutation","stopListeningToResize","createResizeElement","getComputedStyle","onResize","intersectionHandlers","visibilityHandlers","lastIntersectionEntries","viewabilityOffset","IntersectionObserver","lastIsInViewport","visibilityHandler","entries","entry","isInViewport","hidden","intersectionRatio","stopObservingIntersection","rootMargin","_item","onIntersection","stopListeningToVisibilityChange","_target","onVisibilityChange","console","on","removeListener","eventListeners","eListener","_","removeAllListeners","once","emit","hasListeners","stack","UNKNOWN","chooseByPxRatio","icons","devicePixelRatio","iconA","iconB","sortIconByBestPxratio","uniqIcons","array","uniqValue","seen","item","uniqBy","uniqByResource","byProgram","icon","groupIconsByProgram","chooseIcons","resolvePromise","rejectPromise","pending","promise","cancelOnce","FetchError","divElement","endpoint","response","fetch","contentType","headers","status","statusText","normalisedCT","some","allowedType","isValidContentType","then","html","dispatchEvent","CustomEvent","catch","noopResource","resourceElement","image","frameBorder","resourceErrorWait","resourceLoadWait","cleanUp","calculateArea","newIcon","config","thereIsSpace","drawnIcons","placeholderArea","hasSpace","isWithinTheContentArea","phRect","withinBoundaries","doesNotOverlap","drawnIcon","overlap","withoutOverlaps","iconResource","HTMLIFrameElement","HTMLImageElement","onIconClick","pointerEvents","Event","wrapWithClickThrough","createIcon","updatedIcon","oldSignature","signature","isCustomXposition","dIcon","dynamicPos","iconWidth","phWidth","drawnIconsWidth","calculateIconLeft","iconHeight","phHeight","isCustomYPosition","updated","updateIconElement","iconsToShow","otherIcons","currentTimeInMs","videoDurationInMs","renderedIcon","log","firstRenderPending","onIconView","rest","t","p","indexOf","getOwnPropertySymbols","propertyIsEnumerable","__rest","drawIcons","hasPendingIconRedraws","iconsPendingToRedraw","iconsPendingToBeRemoved","removeIcons","removeDrawnIcons","screen","_private","_protected","viewability","responsive","addIcons","adUnit","onFinishCallbacks","setupViewableImpression","timeoutId","unsubscribe","visible","isFinished","handleViewableImpression","setupViewability","setupResponsive","viewmode","prevSize","resize","finished","onErrorCallbacks","throwIfCalled","throwIfFinished","previousTime","skipAttempts","preventAdSkip","preventAdSeek","setVolume","_volume","getVolume","onFinish","onError","isStarted","mode","_d","_e","_f","handleMetric","errorEvt","removeMetricHandlers","media","assetUri","adUnitError","VAST_LINEAR_ASSET_MISMATCH","state","playing","load","SUPPORTED_MIMETYPES","mimetype","getAdIcons","adLoaded","adStarted","adStopped","adSkipped","adSizeChange","adDurationChange","adRemainingTimeChange","adVolumeChange","adImpression","adVideoStart","adVideoFirstQuartile","adVideoMidpoint","adVideoThirdQuartile","adVideoComplete","adClickThru","adUserAcceptInvitation","adUserMinimize","adUserClose","adPaused","adPlaying","adError","EVENTS","creativeAd","timeout","subscribe","method","waitPromise","creativeMethod","major","version","parts","split","VPAID_EVENTS","evtHandler","url","_id","playerHandles","handleClickThrough","payload","VPAID_ERROR","vpaidGeneralError","videoStart","handleVpaidEvent","open","getIcons","loadCreativePromise","getVPAIDAd","adLoadedPromise","creativeEvt","bind","supportedVersion","creativeVersion","creativeMajorNum","creativeData","xml","linearContent","getLinearContent","AdParameters","getAdParametersContent","xmlEncoded","getXmlEncodedValue","XML","environmentVars","videoSlot","videoSlotCanAutoPlay","initAd","adStoppedPromise","remainingTime","linearEvent","evtType","linearTracker","nonLinearEvent","VastError","startAdUnit","onAdReady","createRejectHandler","VAST_MEDIA_FILE_NOT_FOUND","tryToStartVpaidAd","hasVastCreative","startVastAd","adUnitPromise","timedOut","timeoutPromise","_resolve","VAST_MEDIA_LOAD_TIMEOUT","race","newAdUnit","requested","markAdAsRequested","parseVastXml","xmlText","xmlDom","parseFromString","VAST_XML_PARSING_ERROR","requestAd","adTag","vastAdResponse","requestTag","epoch","resultOptions","parentAd","wrapperOptions","allowMultipleAds","fallbackOnNoAd","followAdditionalWrappers","getWrapperOptions","getOptions","wrapperLimit","VAST_TOO_MANY_REDIRECTS","validateChain","fetchPromise","fetchOptions","credentials","VAST_NONLINEAR_LOADING_FAILED","fetchAdXML","VAST_LOAD_TIMEOUT","getFirstAd","VAST_NO_ADS_AFTER_WRAPPER","getAd","VAST_SCHEMA_VALIDATION_ERROR","VAST_UNEXPECTED_MEDIA_FILE","VAST_UNEXPECTED_AD_TYPE","validateResponse","UNKNOWN_ERROR","requestNextAd","vastResponse","nextAd","useAdBuffet","availableAds","adDefinition","hasAdBeenRequested","currentPod","nextPodSequence","getNextPod","newVastChain","callbackHandler","waterfall","fetchVastChain","isCanceled","runEpoch","onAdStart","onRunFinish","newEpoch","lastVastResponse","vpaidEnabled","isVpaid","validateVastResponse","validateVastChain","transformVastResponse","handleVastError","canceled","onAdStartHandler","navigator","userAgent","MSStream","textArea","querySelector","testBtn","eventHandler","eventType","requestAdRun","resumeContent","remove"],"sourceRoot":""}